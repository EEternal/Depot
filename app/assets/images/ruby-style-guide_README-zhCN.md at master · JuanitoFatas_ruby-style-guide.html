



<!DOCTYPE html>
<html lang="en" class=" is-copy-enabled is-u2f-enabled">
  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#">
    <meta charset='utf-8'>

    <link crossorigin="anonymous" href="https://assets-cdn.github.com/assets/frameworks-504cc780bb53241b72465acf5ed2f04a7f976c026278c14d2bf2abcbe478bc67.css" integrity="sha256-UEzHgLtTJBtyRlrPXtLwSn+XbAJieMFNK/Kry+R4vGc=" media="all" rel="stylesheet" />
    <link crossorigin="anonymous" href="https://assets-cdn.github.com/assets/github-190410b848a9b2c115cd20b6c34db870f1ec1e88e4a51863b1e6dec731fa7371.css" integrity="sha256-GQQQuEipssEVzSC2w024cPHsHojkpRhjsebexzH6c3E=" media="all" rel="stylesheet" />
    
    
    
    

    <link as="script" href="https://assets-cdn.github.com/assets/frameworks-21fb64a12f51065265f4841fa5d109725d1b8e7a081b3346c393a5c6c40e4f84.js" rel="preload" />
    
    <link as="script" href="https://assets-cdn.github.com/assets/github-b068027e61a8ae740e7361c036a0a7df24fadf171fd1a92b2fe44c31c94dd62a.js" rel="preload" />

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">
    <meta name="viewport" content="width=1020">
    
    
    <title>ruby-style-guide/README-zhCN.md at master · JuanitoFatas/ruby-style-guide</title>
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">
    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <meta property="fb:app_id" content="1401488693436528">

      <meta content="https://avatars0.githubusercontent.com/u/1000669?v=3&amp;s=400" name="twitter:image:src" /><meta content="@github" name="twitter:site" /><meta content="summary" name="twitter:card" /><meta content="JuanitoFatas/ruby-style-guide" name="twitter:title" /><meta content="ruby-style-guide - :blue_book: Ruby Style Guide in Chinese" name="twitter:description" />
      <meta content="https://avatars0.githubusercontent.com/u/1000669?v=3&amp;s=400" property="og:image" /><meta content="GitHub" property="og:site_name" /><meta content="object" property="og:type" /><meta content="JuanitoFatas/ruby-style-guide" property="og:title" /><meta content="https://github.com/JuanitoFatas/ruby-style-guide" property="og:url" /><meta content="ruby-style-guide - :blue_book: Ruby Style Guide in Chinese" property="og:description" />
      <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">
    <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">
    <link rel="assets" href="https://assets-cdn.github.com/">
    <link rel="web-socket" href="wss://live.github.com/_sockets/MTgwODQ3NDU6MTIxYjA2ZjRlOTc1YTE0ODMzOTQ2NDcwNzkxMzhiMjM6NmRjYzQ1Njg2NTljNWUyNDBkODQ3MmYyYjk2MDNlYmQxN2ZmNGZkODMyYjY3OWJkZjAxYjVmZjczODA5YWE5Yw==--d22688c96baec8faf242a55d3e32002313e94f53">
    <meta name="pjax-timeout" content="1000">
    <link rel="sudo-modal" href="/sessions/sudo_modal">

    <meta name="msapplication-TileImage" content="/windows-tile.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="selected-link" value="repo_source" data-pjax-transient>

    <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
<meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
    <meta name="google-analytics" content="UA-3769691-2">

<meta content="collector.githubapp.com" name="octolytics-host" /><meta content="github" name="octolytics-app-id" /><meta content="3BAC9BD1:392B:6014299:57222C98" name="octolytics-dimension-request_id" /><meta content="18084745" name="octolytics-actor-id" /><meta content="EEternal" name="octolytics-actor-login" /><meta content="f00f2ec0fcb6763e42d7849ab568bc8d3c736284505fd6793b4a249a8e83208c" name="octolytics-actor-hash" />
<meta content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-pjax-transient="true" name="analytics-location" />



  <meta class="js-ga-set" name="dimension1" content="Logged In">



        <meta name="hostname" content="github.com">
    <meta name="user-login" content="EEternal">

        <meta name="expected-hostname" content="github.com">
      <meta name="js-proxy-site-detection-payload" content="Yzc5Zjk4ZWY1ZDM2OGNmZWU5NTUzMDc2MzVhM2NlNjk5Y2MwMTA5YTUwMzVmNWQ3MDRmMDQzN2M1NWFmMTI3OHx7InJlbW90ZV9hZGRyZXNzIjoiNTkuMTcyLjE1NS4yMDkiLCJyZXF1ZXN0X2lkIjoiM0JBQzlCRDE6MzkyQjo2MDE0Mjk5OjU3MjIyQzk4IiwidGltZXN0YW1wIjoxNDYxODU3NDMyfQ==">


      <link rel="mask-icon" href="https://assets-cdn.github.com/pinned-octocat.svg" color="#4078c0">
      <link rel="icon" type="image/x-icon" href="https://assets-cdn.github.com/favicon.ico">

    <meta content="81b5e135719cf47ef27407ff8db895f500670600" name="form-nonce" />

    <meta http-equiv="x-pjax-version" content="00bdca19ebb6a721779794c91cad0e40">
    

      
  <meta name="description" content="ruby-style-guide - :blue_book: Ruby Style Guide in Chinese">
  <meta name="go-import" content="github.com/JuanitoFatas/ruby-style-guide git https://github.com/JuanitoFatas/ruby-style-guide.git">

  <meta content="1000669" name="octolytics-dimension-user_id" /><meta content="JuanitoFatas" name="octolytics-dimension-user_login" /><meta content="3808027" name="octolytics-dimension-repository_id" /><meta content="JuanitoFatas/ruby-style-guide" name="octolytics-dimension-repository_nwo" /><meta content="true" name="octolytics-dimension-repository_public" /><meta content="true" name="octolytics-dimension-repository_is_fork" /><meta content="2371106" name="octolytics-dimension-repository_parent_id" /><meta content="bbatsov/ruby-style-guide" name="octolytics-dimension-repository_parent_nwo" /><meta content="2371106" name="octolytics-dimension-repository_network_root_id" /><meta content="bbatsov/ruby-style-guide" name="octolytics-dimension-repository_network_root_nwo" />
  <link href="https://github.com/JuanitoFatas/ruby-style-guide/commits/master.atom" rel="alternate" title="Recent Commits to ruby-style-guide:master" type="application/atom+xml">


      <link rel="canonical" href="https://github.com/JuanitoFatas/ruby-style-guide/blob/master/README-zhCN.md" data-pjax-transient>
  </head>


  <body class="logged-in   env-production windows vis-public fork page-blob">
    <div id="js-pjax-loader-bar" class="pjax-loader-bar"></div>
    <a href="#start-of-content" tabindex="1" class="accessibility-aid js-skip-to-content">Skip to content</a>

    
    
    



        <div class="header header-logged-in true" role="banner">
  <div class="container clearfix">

    <a class="header-logo-invertocat" href="https://github.com/" data-hotkey="g d" aria-label="Homepage" data-ga-click="Header, go to dashboard, icon:logo">
  <svg aria-hidden="true" class="octicon octicon-mark-github" height="28" version="1.1" viewBox="0 0 16 16" width="28"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59 0.4 0.07 0.55-0.17 0.55-0.38 0-0.19-0.01-0.82-0.01-1.49-2.01 0.37-2.53-0.49-2.69-0.94-0.09-0.23-0.48-0.94-0.82-1.13-0.28-0.15-0.68-0.52-0.01-0.53 0.63-0.01 1.08 0.58 1.23 0.82 0.72 1.21 1.87 0.87 2.33 0.66 0.07-0.52 0.28-0.87 0.51-1.07-1.78-0.2-3.64-0.89-3.64-3.95 0-0.87 0.31-1.59 0.82-2.15-0.08-0.2-0.36-1.02 0.08-2.12 0 0 0.67-0.21 2.2 0.82 0.64-0.18 1.32-0.27 2-0.27 0.68 0 1.36 0.09 2 0.27 1.53-1.04 2.2-0.82 2.2-0.82 0.44 1.1 0.16 1.92 0.08 2.12 0.51 0.56 0.82 1.27 0.82 2.15 0 3.07-1.87 3.75-3.65 3.95 0.29 0.25 0.54 0.73 0.54 1.48 0 1.07-0.01 1.93-0.01 2.2 0 0.21 0.15 0.46 0.55 0.38C13.71 14.53 16 11.53 16 8 16 3.58 12.42 0 8 0z"></path></svg>
</a>


        <div class="header-search scoped-search site-scoped-search js-site-search" role="search">
  <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="/JuanitoFatas/ruby-style-guide/search" class="js-site-search-form" data-scoped-search-url="/JuanitoFatas/ruby-style-guide/search" data-unscoped-search-url="/search" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /></div>
    <label class="form-control header-search-wrapper js-chromeless-input-container">
      <div class="header-search-scope">This repository</div>
      <input type="text"
        class="form-control header-search-input js-site-search-focus js-site-search-field is-clearable"
        data-hotkey="s"
        name="q"
        placeholder="Search"
        aria-label="Search this repository"
        data-unscoped-placeholder="Search GitHub"
        data-scoped-placeholder="Search"
        tabindex="1"
        autocapitalize="off">
    </label>
</form></div>


      <ul class="header-nav left" role="navigation">
        <li class="header-nav-item">
          <a href="/pulls" class="js-selected-navigation-item header-nav-link" data-ga-click="Header, click, Nav menu - item:pulls context:user" data-hotkey="g p" data-selected-links="/pulls /pulls/assigned /pulls/mentioned /pulls">
            Pull requests
</a>        </li>
        <li class="header-nav-item">
          <a href="/issues" class="js-selected-navigation-item header-nav-link" data-ga-click="Header, click, Nav menu - item:issues context:user" data-hotkey="g i" data-selected-links="/issues /issues/assigned /issues/mentioned /issues">
            Issues
</a>        </li>
          <li class="header-nav-item">
            <a class="header-nav-link" href="https://gist.github.com/" data-ga-click="Header, go to gist, text:gist">Gist</a>
          </li>
      </ul>

    
<ul class="header-nav user-nav right" id="user-links">
  <li class="header-nav-item">
    

  </li>

  <li class="header-nav-item dropdown js-menu-container">
    <a class="header-nav-link tooltipped tooltipped-s js-menu-target" href="/new"
       aria-label="Create new…"
       data-ga-click="Header, create new, icon:add">
      <svg aria-hidden="true" class="octicon octicon-plus left" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M12 9H7v5H5V9H0V7h5V2h2v5h5v2z"></path></svg>
      <span class="dropdown-caret"></span>
    </a>

    <div class="dropdown-menu-content js-menu-content">
      <ul class="dropdown-menu dropdown-menu-sw">
        
<a class="dropdown-item" href="/new" data-ga-click="Header, create new repository">
  New repository
</a>


  <a class="dropdown-item" href="/organizations/new" data-ga-click="Header, create new organization">
    New organization
  </a>



  <div class="dropdown-divider"></div>
  <div class="dropdown-header">
    <span title="JuanitoFatas/ruby-style-guide">This repository</span>
  </div>
    <a class="dropdown-item" href="/JuanitoFatas/ruby-style-guide/issues/new" data-ga-click="Header, create new issue">
      New issue
    </a>

      </ul>
    </div>
  </li>

  <li class="header-nav-item dropdown js-menu-container">
    <a class="header-nav-link name tooltipped tooltipped-sw js-menu-target" href="/EEternal"
       aria-label="View profile and more"
       data-ga-click="Header, show menu, icon:avatar">
      <img alt="@EEternal" class="avatar" height="20" src="https://avatars3.githubusercontent.com/u/18084745?v=3&amp;s=40" width="20" />
      <span class="dropdown-caret"></span>
    </a>

    <div class="dropdown-menu-content js-menu-content">
      <div class="dropdown-menu  dropdown-menu-sw">
        <div class=" dropdown-header header-nav-current-user css-truncate">
            Signed in as <strong class="css-truncate-target">EEternal</strong>

        </div>


        <div class="dropdown-divider"></div>

          <a class="dropdown-item" href="/EEternal" data-ga-click="Header, go to profile, text:your profile">
            Your profile
          </a>
        <a class="dropdown-item" href="/stars" data-ga-click="Header, go to starred repos, text:your stars">
          Your stars
        </a>
          <a class="dropdown-item" href="/explore" data-ga-click="Header, go to explore, text:explore">
            Explore
          </a>
          <a class="dropdown-item" href="/integrations" data-ga-click="Header, go to integrations, text:integrations">
            Integrations
          </a>
        <a class="dropdown-item" href="https://help.github.com" data-ga-click="Header, go to help, text:help">
          Help
        </a>


          <div class="dropdown-divider"></div>

          <a class="dropdown-item" href="/settings/profile" data-ga-click="Header, go to settings, icon:settings">
            Settings
          </a>

          <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="/logout" class="logout-form" data-form-nonce="81b5e135719cf47ef27407ff8db895f500670600" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="uRpLWFyJXrjjrN/YZVlWSTQUJ6Yl2gYfsHNAZFUFhzW8XnrwbcaKDsgsIX6VheEDeD9UqgcR39jGhOn9QHhBiA==" /></div>
            <button class="dropdown-item dropdown-signout" data-ga-click="Header, sign out, icon:logout">
              Sign out
            </button>
</form>
      </div>
    </div>
  </li>
</ul>


    
  </div>
</div>


      


    <div id="start-of-content" class="accessibility-aid"></div>

      <div id="js-flash-container">
</div>


    <div role="main" class="main-content">
        <div itemscope itemtype="http://schema.org/SoftwareSourceCode">
    <div id="js-repo-pjax-container" data-pjax-container>
      
<div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav">
  <div class="container repohead-details-container">

    

<ul class="pagehead-actions">

  <li>
        <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="/notifications/subscribe" class="js-social-container" data-autosubmit="true" data-form-nonce="81b5e135719cf47ef27407ff8db895f500670600" data-remote="true" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="xX1sZU0IG0ZXjJY7BN2ULngnix1OSbMOApK7UdHRXs4tC/hEWlKSKw2G14XNU4HZAfDfuTY8xv0AG1Em/fMJKA==" /></div>      <input class="form-control" id="repository_id" name="repository_id" type="hidden" value="3808027" />

        <div class="select-menu js-menu-container js-select-menu">
          <a href="/JuanitoFatas/ruby-style-guide/subscription"
            class="btn btn-sm btn-with-count select-menu-button js-menu-target" role="button" tabindex="0" aria-haspopup="true"
            data-ga-click="Repository, click Watch settings, action:blob#show">
            <span class="js-select-button">
              <svg aria-hidden="true" class="octicon octicon-eye" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6c4.94 0 7.94-6 7.94-6S13 2 8.06 2z m-0.06 10c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4z m2-4c0 1.11-0.89 2-2 2s-2-0.89-2-2 0.89-2 2-2 2 0.89 2 2z"></path></svg>
              Watch
            </span>
          </a>
          <a class="social-count js-social-count" href="/JuanitoFatas/ruby-style-guide/watchers">
            43
          </a>

        <div class="select-menu-modal-holder">
          <div class="select-menu-modal subscription-menu-modal js-menu-content" aria-hidden="true">
            <div class="select-menu-header js-navigation-enable" tabindex="-1">
              <svg aria-label="Close" class="octicon octicon-x js-menu-close" height="16" role="img" version="1.1" viewBox="0 0 12 16" width="12"><path d="M7.48 8l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75-1.48-1.48 3.75-3.75L0.77 4.25l1.48-1.48 3.75 3.75 3.75-3.75 1.48 1.48-3.75 3.75z"></path></svg>
              <span class="select-menu-title">Notifications</span>
            </div>

              <div class="select-menu-list js-navigation-container" role="menu">

                <div class="select-menu-item js-navigation-item selected" role="menuitem" tabindex="0">
                  <svg aria-hidden="true" class="octicon octicon-check select-menu-item-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M12 5L4 13 0 9l1.5-1.5 2.5 2.5 6.5-6.5 1.5 1.5z"></path></svg>
                  <div class="select-menu-item-text">
                    <input checked="checked" id="do_included" name="do" type="radio" value="included" />
                    <span class="select-menu-item-heading">Not watching</span>
                    <span class="description">Be notified when participating or @mentioned.</span>
                    <span class="js-select-button-text hidden-select-button-text">
                      <svg aria-hidden="true" class="octicon octicon-eye" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6c4.94 0 7.94-6 7.94-6S13 2 8.06 2z m-0.06 10c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4z m2-4c0 1.11-0.89 2-2 2s-2-0.89-2-2 0.89-2 2-2 2 0.89 2 2z"></path></svg>
                      Watch
                    </span>
                  </div>
                </div>

                <div class="select-menu-item js-navigation-item " role="menuitem" tabindex="0">
                  <svg aria-hidden="true" class="octicon octicon-check select-menu-item-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M12 5L4 13 0 9l1.5-1.5 2.5 2.5 6.5-6.5 1.5 1.5z"></path></svg>
                  <div class="select-menu-item-text">
                    <input id="do_subscribed" name="do" type="radio" value="subscribed" />
                    <span class="select-menu-item-heading">Watching</span>
                    <span class="description">Be notified of all conversations.</span>
                    <span class="js-select-button-text hidden-select-button-text">
                      <svg aria-hidden="true" class="octicon octicon-eye" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6c4.94 0 7.94-6 7.94-6S13 2 8.06 2z m-0.06 10c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4z m2-4c0 1.11-0.89 2-2 2s-2-0.89-2-2 0.89-2 2-2 2 0.89 2 2z"></path></svg>
                      Unwatch
                    </span>
                  </div>
                </div>

                <div class="select-menu-item js-navigation-item " role="menuitem" tabindex="0">
                  <svg aria-hidden="true" class="octicon octicon-check select-menu-item-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M12 5L4 13 0 9l1.5-1.5 2.5 2.5 6.5-6.5 1.5 1.5z"></path></svg>
                  <div class="select-menu-item-text">
                    <input id="do_ignore" name="do" type="radio" value="ignore" />
                    <span class="select-menu-item-heading">Ignoring</span>
                    <span class="description">Never be notified.</span>
                    <span class="js-select-button-text hidden-select-button-text">
                      <svg aria-hidden="true" class="octicon octicon-mute" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M8 2.81v10.38c0 0.67-0.81 1-1.28 0.53L3 10H1c-0.55 0-1-0.45-1-1V7c0-0.55 0.45-1 1-1h2l3.72-3.72c0.47-0.47 1.28-0.14 1.28 0.53z m7.53 3.22l-1.06-1.06-1.97 1.97-1.97-1.97-1.06 1.06 1.97 1.97-1.97 1.97 1.06 1.06 1.97-1.97 1.97 1.97 1.06-1.06-1.97-1.97 1.97-1.97z"></path></svg>
                      Stop ignoring
                    </span>
                  </div>
                </div>

              </div>

            </div>
          </div>
        </div>
</form>
  </li>

  <li>
    
  <div class="js-toggler-container js-social-container starring-container ">

    <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="/JuanitoFatas/ruby-style-guide/unstar" class="js-toggler-form starred" data-form-nonce="81b5e135719cf47ef27407ff8db895f500670600" data-remote="true" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="ba8rrSRZWTztKvdH0AGxDq4VxdWBPIIH8gE2S7XbhQ0OK8h7U48S24DVZS1QsdZMadYSA426oc2SwNpm9BkoFQ==" /></div>
      <button
        class="btn btn-sm btn-with-count js-toggler-target"
        aria-label="Unstar this repository" title="Unstar JuanitoFatas/ruby-style-guide"
        data-ga-click="Repository, click unstar button, action:blob#show; text:Unstar">
        <svg aria-hidden="true" class="octicon octicon-star" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M14 6l-4.9-0.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14l4.33-2.33 4.33 2.33L10.4 9.26 14 6z"></path></svg>
        Unstar
      </button>
        <a class="social-count js-social-count" href="/JuanitoFatas/ruby-style-guide/stargazers">
          466
        </a>
</form>
    <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="/JuanitoFatas/ruby-style-guide/star" class="js-toggler-form unstarred" data-form-nonce="81b5e135719cf47ef27407ff8db895f500670600" data-remote="true" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="RA4ldZQ01D0iTnEVrJDn2o5C4M6zeJFUyYfiRS2nlBR87yKoEfmbxZerwudWdXXbF1Eugsrn32UQXzNtPoaXrw==" /></div>
      <button
        class="btn btn-sm btn-with-count js-toggler-target"
        aria-label="Star this repository" title="Star JuanitoFatas/ruby-style-guide"
        data-ga-click="Repository, click star button, action:blob#show; text:Star">
        <svg aria-hidden="true" class="octicon octicon-star" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M14 6l-4.9-0.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14l4.33-2.33 4.33 2.33L10.4 9.26 14 6z"></path></svg>
        Star
      </button>
        <a class="social-count js-social-count" href="/JuanitoFatas/ruby-style-guide/stargazers">
          466
        </a>
</form>  </div>

  </li>

  <li>
          <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="/JuanitoFatas/ruby-style-guide/fork" class="btn-with-count" data-form-nonce="81b5e135719cf47ef27407ff8db895f500670600" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="ep0CTGQfZJQrT0RXMfbI+l83YWeQ7/0MOroAdKcDQGfBAppBz8GezZ+Y8dAWwHZ8GcBiRjYQA26kJCzJlW25VA==" /></div>
            <button
                type="submit"
                class="btn btn-sm btn-with-count"
                data-ga-click="Repository, show fork modal, action:blob#show; text:Fork"
                title="Fork your own copy of JuanitoFatas/ruby-style-guide to your account"
                aria-label="Fork your own copy of JuanitoFatas/ruby-style-guide to your account">
              <svg aria-hidden="true" class="octicon octicon-repo-forked" height="16" version="1.1" viewBox="0 0 10 16" width="10"><path d="M8 1c-1.11 0-2 0.89-2 2 0 0.73 0.41 1.38 1 1.72v1.28L5 8 3 6v-1.28c0.59-0.34 1-0.98 1-1.72 0-1.11-0.89-2-2-2S0 1.89 0 3c0 0.73 0.41 1.38 1 1.72v1.78l3 3v1.78c-0.59 0.34-1 0.98-1 1.72 0 1.11 0.89 2 2 2s2-0.89 2-2c0-0.73-0.41-1.38-1-1.72V9.5l3-3V4.72c0.59-0.34 1-0.98 1-1.72 0-1.11-0.89-2-2-2zM2 4.2c-0.66 0-1.2-0.55-1.2-1.2s0.55-1.2 1.2-1.2 1.2 0.55 1.2 1.2-0.55 1.2-1.2 1.2z m3 10c-0.66 0-1.2-0.55-1.2-1.2s0.55-1.2 1.2-1.2 1.2 0.55 1.2 1.2-0.55 1.2-1.2 1.2z m3-10c-0.66 0-1.2-0.55-1.2-1.2s0.55-1.2 1.2-1.2 1.2 0.55 1.2 1.2-0.55 1.2-1.2 1.2z"></path></svg>
              Fork
            </button>
</form>
    <a href="/JuanitoFatas/ruby-style-guide/network" class="social-count">
      2,450
    </a>
  </li>
</ul>

    <h1 class="entry-title public ">
  <svg aria-hidden="true" class="octicon octicon-repo-forked" height="16" version="1.1" viewBox="0 0 10 16" width="10"><path d="M8 1c-1.11 0-2 0.89-2 2 0 0.73 0.41 1.38 1 1.72v1.28L5 8 3 6v-1.28c0.59-0.34 1-0.98 1-1.72 0-1.11-0.89-2-2-2S0 1.89 0 3c0 0.73 0.41 1.38 1 1.72v1.78l3 3v1.78c-0.59 0.34-1 0.98-1 1.72 0 1.11 0.89 2 2 2s2-0.89 2-2c0-0.73-0.41-1.38-1-1.72V9.5l3-3V4.72c0.59-0.34 1-0.98 1-1.72 0-1.11-0.89-2-2-2zM2 4.2c-0.66 0-1.2-0.55-1.2-1.2s0.55-1.2 1.2-1.2 1.2 0.55 1.2 1.2-0.55 1.2-1.2 1.2z m3 10c-0.66 0-1.2-0.55-1.2-1.2s0.55-1.2 1.2-1.2 1.2 0.55 1.2 1.2-0.55 1.2-1.2 1.2z m3-10c-0.66 0-1.2-0.55-1.2-1.2s0.55-1.2 1.2-1.2 1.2 0.55 1.2 1.2-0.55 1.2-1.2 1.2z"></path></svg>
  <span class="author" itemprop="author"><a href="/JuanitoFatas" class="url fn" rel="author">JuanitoFatas</a></span><!--
--><span class="path-divider">/</span><!--
--><strong itemprop="name"><a href="/JuanitoFatas/ruby-style-guide" data-pjax="#js-repo-pjax-container">ruby-style-guide</a></strong>

    <span class="fork-flag">
      <span class="text">forked from <a href="/bbatsov/ruby-style-guide">bbatsov/ruby-style-guide</a></span>
    </span>
</h1>

  </div>
  <div class="container">
    
<nav class="reponav js-repo-nav js-sidenav-container-pjax"
     itemscope
     itemtype="http://schema.org/BreadcrumbList"
     role="navigation"
     data-pjax="#js-repo-pjax-container">

  <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a href="/JuanitoFatas/ruby-style-guide" aria-selected="true" class="js-selected-navigation-item selected reponav-item" data-hotkey="g c" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches /JuanitoFatas/ruby-style-guide" itemprop="url">
      <svg aria-hidden="true" class="octicon octicon-code" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M9.5 3l-1.5 1.5 3.5 3.5L8 11.5l1.5 1.5 4.5-5L9.5 3zM4.5 3L0 8l4.5 5 1.5-1.5L2.5 8l3.5-3.5L4.5 3z"></path></svg>
      <span itemprop="name">Code</span>
      <meta itemprop="position" content="1">
</a>  </span>

    <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a href="/JuanitoFatas/ruby-style-guide/issues" class="js-selected-navigation-item reponav-item" data-hotkey="g i" data-selected-links="repo_issues repo_labels repo_milestones /JuanitoFatas/ruby-style-guide/issues" itemprop="url">
        <svg aria-hidden="true" class="octicon octicon-issue-opened" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7S10.14 13.7 7 13.7 1.3 11.14 1.3 8s2.56-5.7 5.7-5.7m0-1.3C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7S10.86 1 7 1z m1 3H6v5h2V4z m0 6H6v2h2V10z"></path></svg>
        <span itemprop="name">Issues</span>
        <span class="counter">0</span>
        <meta itemprop="position" content="2">
</a>    </span>

  <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a href="/JuanitoFatas/ruby-style-guide/pulls" class="js-selected-navigation-item reponav-item" data-hotkey="g p" data-selected-links="repo_pulls /JuanitoFatas/ruby-style-guide/pulls" itemprop="url">
      <svg aria-hidden="true" class="octicon octicon-git-pull-request" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M11 11.28c0-1.73 0-6.28 0-6.28-0.03-0.78-0.34-1.47-0.94-2.06s-1.28-0.91-2.06-0.94c0 0-1.02 0-1 0V0L4 3l3 3V4h1c0.27 0.02 0.48 0.11 0.69 0.31s0.3 0.42 0.31 0.69v6.28c-0.59 0.34-1 0.98-1 1.72 0 1.11 0.89 2 2 2s2-0.89 2-2c0-0.73-0.41-1.38-1-1.72z m-1 2.92c-0.66 0-1.2-0.55-1.2-1.2s0.55-1.2 1.2-1.2 1.2 0.55 1.2 1.2-0.55 1.2-1.2 1.2zM4 3c0-1.11-0.89-2-2-2S0 1.89 0 3c0 0.73 0.41 1.38 1 1.72 0 1.55 0 5.56 0 6.56-0.59 0.34-1 0.98-1 1.72 0 1.11 0.89 2 2 2s2-0.89 2-2c0-0.73-0.41-1.38-1-1.72V4.72c0.59-0.34 1-0.98 1-1.72z m-0.8 10c0 0.66-0.55 1.2-1.2 1.2s-1.2-0.55-1.2-1.2 0.55-1.2 1.2-1.2 1.2 0.55 1.2 1.2z m-1.2-8.8c-0.66 0-1.2-0.55-1.2-1.2s0.55-1.2 1.2-1.2 1.2 0.55 1.2 1.2-0.55 1.2-1.2 1.2z"></path></svg>
      <span itemprop="name">Pull requests</span>
      <span class="counter">0</span>
      <meta itemprop="position" content="3">
</a>  </span>

    <a href="/JuanitoFatas/ruby-style-guide/wiki" class="js-selected-navigation-item reponav-item" data-hotkey="g w" data-selected-links="repo_wiki /JuanitoFatas/ruby-style-guide/wiki">
      <svg aria-hidden="true" class="octicon octicon-book" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M2 5h4v1H2v-1z m0 3h4v-1H2v1z m0 2h4v-1H2v1z m11-5H9v1h4v-1z m0 2H9v1h4v-1z m0 2H9v1h4v-1z m2-6v9c0 0.55-0.45 1-1 1H8.5l-1 1-1-1H1c-0.55 0-1-0.45-1-1V3c0-0.55 0.45-1 1-1h5.5l1 1 1-1h5.5c0.55 0 1 0.45 1 1z m-8 0.5l-0.5-0.5H1v9h6V3.5z m7-0.5H8.5l-0.5 0.5v8.5h6V3z"></path></svg>
      Wiki
</a>

  <a href="/JuanitoFatas/ruby-style-guide/pulse" class="js-selected-navigation-item reponav-item" data-selected-links="pulse /JuanitoFatas/ruby-style-guide/pulse">
    <svg aria-hidden="true" class="octicon octicon-pulse" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M11.5 8L8.8 5.4 6.6 8.5 5.5 1.6 2.38 8H0V10h3.6L4.5 8.2l0.9 5.4L9 8.5l1.6 1.5H14V8H11.5z"></path></svg>
    Pulse
</a>
  <a href="/JuanitoFatas/ruby-style-guide/graphs" class="js-selected-navigation-item reponav-item" data-selected-links="repo_graphs repo_contributors /JuanitoFatas/ruby-style-guide/graphs">
    <svg aria-hidden="true" class="octicon octicon-graph" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M16 14v1H0V0h1v14h15z m-11-1H3V8h2v5z m4 0H7V3h2v10z m4 0H11V6h2v7z"></path></svg>
    Graphs
</a>

</nav>

  </div>
</div>

<div class="container new-discussion-timeline experiment-repo-nav">
  <div class="repository-content">

    

<a href="/JuanitoFatas/ruby-style-guide/blob/3dde778e4942f20bc102d718ef07193010f4681f/README-zhCN.md" class="hidden js-permalink-shortcut" data-hotkey="y">Permalink</a>

<!-- blob contrib key: blob_contributors:v21:0915666402db22977c012736f5da7219 -->

<div class="file-navigation js-zeroclipboard-container">
  
<div class="select-menu branch-select-menu js-menu-container js-select-menu left">
  <button class="btn btn-sm select-menu-button js-menu-target css-truncate" data-hotkey="w"
    title="master"
    type="button" aria-label="Switch branches or tags" tabindex="0" aria-haspopup="true">
    <i>Branch:</i>
    <span class="js-select-button css-truncate-target">master</span>
  </button>

  <div class="select-menu-modal-holder js-menu-content js-navigation-container" data-pjax aria-hidden="true">

    <div class="select-menu-modal">
      <div class="select-menu-header">
        <svg aria-label="Close" class="octicon octicon-x js-menu-close" height="16" role="img" version="1.1" viewBox="0 0 12 16" width="12"><path d="M7.48 8l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75-1.48-1.48 3.75-3.75L0.77 4.25l1.48-1.48 3.75 3.75 3.75-3.75 1.48 1.48-3.75 3.75z"></path></svg>
        <span class="select-menu-title">Switch branches/tags</span>
      </div>

      <div class="select-menu-filters">
        <div class="select-menu-text-filter">
          <input type="text" aria-label="Filter branches/tags" id="context-commitish-filter-field" class="form-control js-filterable-field js-navigation-enable" placeholder="Filter branches/tags">
        </div>
        <div class="select-menu-tabs">
          <ul>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="branches" data-filter-placeholder="Filter branches/tags" class="js-select-menu-tab" role="tab">Branches</a>
            </li>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="tags" data-filter-placeholder="Find a tag…" class="js-select-menu-tab" role="tab">Tags</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="branches" role="menu">

        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


            <a class="select-menu-item js-navigation-item js-navigation-open selected"
               href="/JuanitoFatas/ruby-style-guide/blob/master/README-zhCN.md"
               data-name="master"
               data-skip-pjax="true"
               rel="nofollow">
              <svg aria-hidden="true" class="octicon octicon-check select-menu-item-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M12 5L4 13 0 9l1.5-1.5 2.5 2.5 6.5-6.5 1.5 1.5z"></path></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text" title="master">
                master
              </span>
            </a>
        </div>

          <div class="select-menu-no-results">Nothing to show</div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="tags">
        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


        </div>

        <div class="select-menu-no-results">Nothing to show</div>
      </div>

    </div>
  </div>
</div>

  <div class="btn-group right">
    <a href="/JuanitoFatas/ruby-style-guide/find/master"
          class="js-pjax-capture-input btn btn-sm"
          data-pjax
          data-hotkey="t">
      Find file
    </a>
    <button aria-label="Copy file path to clipboard" class="js-zeroclipboard btn btn-sm zeroclipboard-button tooltipped tooltipped-s" data-copied-hint="Copied!" type="button">Copy path</button>
  </div>
  <div class="breadcrumb js-zeroclipboard-target">
    <span class="repo-root js-repo-root"><span class="js-path-segment"><a href="/JuanitoFatas/ruby-style-guide"><span>ruby-style-guide</span></a></span></span><span class="separator">/</span><strong class="final-path">README-zhCN.md</strong>
  </div>
</div>


  <div class="commit-tease">
      <span class="right">
        <a class="commit-tease-sha" href="/JuanitoFatas/ruby-style-guide/commit/929994bc0a56fea4e77c78c2248cba53e3239e59" data-pjax>
          929994b
        </a>
        <time datetime="2016-04-03T14:16:03Z" is="relative-time">Apr 3, 2016</time>
      </span>
      <div>
        <img alt="@0x01f7" class="avatar" height="20" src="https://avatars0.githubusercontent.com/u/11257791?v=3&amp;s=40" width="20" />
        <a href="/0x01f7" class="user-mention" rel="contributor">0x01f7</a>
          <a href="/JuanitoFatas/ruby-style-guide/commit/929994bc0a56fea4e77c78c2248cba53e3239e59" class="message" data-pjax="true" title="同步更新中文版本">同步更新中文版本</a>
      </div>

    <div class="commit-tease-contributors">
      <button type="button" class="btn-link muted-link contributors-toggle" data-facebox="#blob_contributors_box">
        <strong>25</strong>
         contributors
      </button>
          <a class="avatar-link tooltipped tooltipped-s" aria-label="JuanitoFatas" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=JuanitoFatas"><img alt="@JuanitoFatas" class="avatar" height="20" src="https://avatars3.githubusercontent.com/u/1000669?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="hsinhuang" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=hsinhuang"><img alt="@hsinhuang" class="avatar" height="20" src="https://avatars0.githubusercontent.com/u/2618283?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="0x01f7" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=0x01f7"><img alt="@0x01f7" class="avatar" height="20" src="https://avatars0.githubusercontent.com/u/11257791?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="johnnywjy" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=johnnywjy"><img alt="@johnnywjy" class="avatar" height="20" src="https://avatars3.githubusercontent.com/u/631368?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="yumminhuang" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=yumminhuang"><img alt="@yumminhuang" class="avatar" height="20" src="https://avatars1.githubusercontent.com/u/1998064?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="jerryw" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=jerryw"><img alt="@jerryw" class="avatar" height="20" src="https://avatars3.githubusercontent.com/u/719324?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="teddy-ma" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=teddy-ma"><img alt="@teddy-ma" class="avatar" height="20" src="https://avatars0.githubusercontent.com/u/788486?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="wansongying" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=wansongying"><img alt="@wansongying" class="avatar" height="20" src="https://avatars0.githubusercontent.com/u/1285526?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="samuelnian" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=samuelnian"><img alt="@samuelnian" class="avatar" height="20" src="https://avatars2.githubusercontent.com/u/11553377?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="pihao" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=pihao"><img alt="@pihao" class="avatar" height="20" src="https://avatars2.githubusercontent.com/u/3308394?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="diguage" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=diguage"><img alt="@diguage" class="avatar" height="20" src="https://avatars1.githubusercontent.com/u/2121467?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="lafwind" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=lafwind"><img alt="@lafwind" class="avatar" height="20" src="https://avatars3.githubusercontent.com/u/2379730?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="fsword" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=fsword"><img alt="@fsword" class="avatar" height="20" src="https://avatars0.githubusercontent.com/u/18908?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="riahtire" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=riahtire"><img alt="@riahtire" class="avatar" height="20" src="https://avatars0.githubusercontent.com/u/7746989?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="southerncross" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=southerncross"><img alt="@southerncross" class="avatar" height="20" src="https://avatars1.githubusercontent.com/u/3861465?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="CrazyApi" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=CrazyApi"><img alt="@CrazyApi" class="avatar" height="20" src="https://avatars3.githubusercontent.com/u/1161818?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="dorentus" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=dorentus"><img alt="@dorentus" class="avatar" height="20" src="https://avatars0.githubusercontent.com/u/60363?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="nightire" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=nightire"><img alt="@nightire" class="avatar" height="20" src="https://avatars0.githubusercontent.com/u/1104018?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="dannvix" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=dannvix"><img alt="@dannvix" class="avatar" height="20" src="https://avatars0.githubusercontent.com/u/80781?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="orzFly" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=orzFly"><img alt="@orzFly" class="avatar" height="20" src="https://avatars1.githubusercontent.com/u/158528?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="xhh" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=xhh"><img alt="@xhh" class="avatar" height="20" src="https://avatars0.githubusercontent.com/u/159740?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="Charlie-Hua" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=Charlie-Hua"><img alt="@Charlie-Hua" class="avatar" height="20" src="https://avatars3.githubusercontent.com/u/361098?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="404pnf" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=404pnf"><img alt="@404pnf" class="avatar" height="20" src="https://avatars1.githubusercontent.com/u/310443?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="agate" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=agate"><img alt="@agate" class="avatar" height="20" src="https://avatars2.githubusercontent.com/u/21731?v=3&amp;s=40" width="20" /> </a>
    <a class="avatar-link tooltipped tooltipped-s" aria-label="fighterleslie" href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md?author=fighterleslie"><img alt="@fighterleslie" class="avatar" height="20" src="https://avatars3.githubusercontent.com/u/8318937?v=3&amp;s=40" width="20" /> </a>


    </div>

    <div id="blob_contributors_box" style="display:none">
      <h2 class="facebox-header" data-facebox-id="facebox-header">Users who have contributed to this file</h2>
      <ul class="facebox-user-list" data-facebox-id="facebox-description">
          <li class="facebox-user-list-item">
            <img alt="@JuanitoFatas" height="24" src="https://avatars1.githubusercontent.com/u/1000669?v=3&amp;s=48" width="24" />
            <a href="/JuanitoFatas">JuanitoFatas</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@hsinhuang" height="24" src="https://avatars2.githubusercontent.com/u/2618283?v=3&amp;s=48" width="24" />
            <a href="/hsinhuang">hsinhuang</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@0x01f7" height="24" src="https://avatars2.githubusercontent.com/u/11257791?v=3&amp;s=48" width="24" />
            <a href="/0x01f7">0x01f7</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@johnnywjy" height="24" src="https://avatars1.githubusercontent.com/u/631368?v=3&amp;s=48" width="24" />
            <a href="/johnnywjy">johnnywjy</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@yumminhuang" height="24" src="https://avatars3.githubusercontent.com/u/1998064?v=3&amp;s=48" width="24" />
            <a href="/yumminhuang">yumminhuang</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@jerryw" height="24" src="https://avatars1.githubusercontent.com/u/719324?v=3&amp;s=48" width="24" />
            <a href="/jerryw">jerryw</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@teddy-ma" height="24" src="https://avatars2.githubusercontent.com/u/788486?v=3&amp;s=48" width="24" />
            <a href="/teddy-ma">teddy-ma</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@wansongying" height="24" src="https://avatars2.githubusercontent.com/u/1285526?v=3&amp;s=48" width="24" />
            <a href="/wansongying">wansongying</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@samuelnian" height="24" src="https://avatars0.githubusercontent.com/u/11553377?v=3&amp;s=48" width="24" />
            <a href="/samuelnian">samuelnian</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@pihao" height="24" src="https://avatars0.githubusercontent.com/u/3308394?v=3&amp;s=48" width="24" />
            <a href="/pihao">pihao</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@diguage" height="24" src="https://avatars3.githubusercontent.com/u/2121467?v=3&amp;s=48" width="24" />
            <a href="/diguage">diguage</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@lafwind" height="24" src="https://avatars1.githubusercontent.com/u/2379730?v=3&amp;s=48" width="24" />
            <a href="/lafwind">lafwind</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@fsword" height="24" src="https://avatars2.githubusercontent.com/u/18908?v=3&amp;s=48" width="24" />
            <a href="/fsword">fsword</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@riahtire" height="24" src="https://avatars2.githubusercontent.com/u/7746989?v=3&amp;s=48" width="24" />
            <a href="/riahtire">riahtire</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@southerncross" height="24" src="https://avatars3.githubusercontent.com/u/3861465?v=3&amp;s=48" width="24" />
            <a href="/southerncross">southerncross</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@CrazyApi" height="24" src="https://avatars1.githubusercontent.com/u/1161818?v=3&amp;s=48" width="24" />
            <a href="/CrazyApi">CrazyApi</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@dorentus" height="24" src="https://avatars2.githubusercontent.com/u/60363?v=3&amp;s=48" width="24" />
            <a href="/dorentus">dorentus</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@nightire" height="24" src="https://avatars2.githubusercontent.com/u/1104018?v=3&amp;s=48" width="24" />
            <a href="/nightire">nightire</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@dannvix" height="24" src="https://avatars2.githubusercontent.com/u/80781?v=3&amp;s=48" width="24" />
            <a href="/dannvix">dannvix</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@orzFly" height="24" src="https://avatars3.githubusercontent.com/u/158528?v=3&amp;s=48" width="24" />
            <a href="/orzFly">orzFly</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@xhh" height="24" src="https://avatars2.githubusercontent.com/u/159740?v=3&amp;s=48" width="24" />
            <a href="/xhh">xhh</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@Charlie-Hua" height="24" src="https://avatars1.githubusercontent.com/u/361098?v=3&amp;s=48" width="24" />
            <a href="/Charlie-Hua">Charlie-Hua</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@404pnf" height="24" src="https://avatars3.githubusercontent.com/u/310443?v=3&amp;s=48" width="24" />
            <a href="/404pnf">404pnf</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@agate" height="24" src="https://avatars0.githubusercontent.com/u/21731?v=3&amp;s=48" width="24" />
            <a href="/agate">agate</a>
          </li>
          <li class="facebox-user-list-item">
            <img alt="@fighterleslie" height="24" src="https://avatars1.githubusercontent.com/u/8318937?v=3&amp;s=48" width="24" />
            <a href="/fighterleslie">fighterleslie</a>
          </li>
      </ul>
    </div>
  </div>

<div class="file">
  <div class="file-header">
  <div class="file-actions">

    <div class="btn-group">
      <a href="/JuanitoFatas/ruby-style-guide/raw/master/README-zhCN.md" class="btn btn-sm " id="raw-url">Raw</a>
        <a href="/JuanitoFatas/ruby-style-guide/blame/master/README-zhCN.md" class="btn btn-sm js-update-url-with-hash">Blame</a>
      <a href="/JuanitoFatas/ruby-style-guide/commits/master/README-zhCN.md" class="btn btn-sm " rel="nofollow">History</a>
    </div>

        <a class="btn-octicon tooltipped tooltipped-nw"
           href="https://windows.github.com"
           aria-label="Open this file in GitHub Desktop"
           data-ga-click="Repository, open with desktop, type:windows">
            <svg aria-hidden="true" class="octicon octicon-device-desktop" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M15 2H1c-0.55 0-1 0.45-1 1v9c0 0.55 0.45 1 1 1h5.34c-0.25 0.61-0.86 1.39-2.34 2h8c-1.48-0.61-2.09-1.39-2.34-2h5.34c0.55 0 1-0.45 1-1V3c0-0.55-0.45-1-1-1z m0 9H1V3h14v8z"></path></svg>
        </a>

        <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="/JuanitoFatas/ruby-style-guide/edit/master/README-zhCN.md" class="inline-form js-update-url-with-hash" data-form-nonce="81b5e135719cf47ef27407ff8db895f500670600" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="LXhgVfq3tjYYGwJyIZ2IOXWxgX/97i9lnjhEaRS2IRTe8Un3pMX/yIPp8fGrB4GSIOC0e6qBuXCgc6WHh2tBlA==" /></div>
          <button class="btn-octicon tooltipped tooltipped-nw" type="submit"
            aria-label="Fork this project and edit the file" data-hotkey="e" data-disable-with>
            <svg aria-hidden="true" class="octicon octicon-pencil" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M0 12v3h3l8-8-3-3L0 12z m3 2H1V12h1v1h1v1z m10.3-9.3l-1.3 1.3-3-3 1.3-1.3c0.39-0.39 1.02-0.39 1.41 0l1.59 1.59c0.39 0.39 0.39 1.02 0 1.41z"></path></svg>
          </button>
</form>        <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="/JuanitoFatas/ruby-style-guide/delete/master/README-zhCN.md" class="inline-form" data-form-nonce="81b5e135719cf47ef27407ff8db895f500670600" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="qxppCTKOewepqQ89rIoZyV8yUXeoKM3jmy7mrzRlfVysQSz+uvyPaenAt0x+nYyfMrGnKv2PhxDinGqUqWdEQA==" /></div>
          <button class="btn-octicon btn-octicon-danger tooltipped tooltipped-nw" type="submit"
            aria-label="Fork this project and delete the file" data-disable-with>
            <svg aria-hidden="true" class="octicon octicon-trashcan" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M10 2H8c0-0.55-0.45-1-1-1H4c-0.55 0-1 0.45-1 1H1c-0.55 0-1 0.45-1 1v1c0 0.55 0.45 1 1 1v9c0 0.55 0.45 1 1 1h7c0.55 0 1-0.45 1-1V5c0.55 0 1-0.45 1-1v-1c0-0.55-0.45-1-1-1z m-1 12H2V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9z m1-10H1v-1h9v1z"></path></svg>
          </button>
</form>  </div>

  <div class="file-info">
      3599 lines (2796 sloc)
      <span class="file-info-divider"></span>
    89.3 KB
  </div>
</div>

  
  <div id="readme" class="readme blob instapaper_body">
    <article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-序幕" class="anchor" href="#序幕" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>序幕</h1>

<blockquote>
<p>榜样很重要。<br>
——墨菲警官《机器战警》</p>
</blockquote>

<p>身为 Ruby 开发者，有件总是令我烦心的事——Python 开发者有一份好的编程风格参考指南（<a href="https://www.python.org/dev/peps/pep-0008/">PEP-8</a>）而我们永远没有一份官方指南，一份记录 Ruby 编程风格及最佳实践的指南。我确信风格很重要。我也相信像 Ruby 这样的黑客社区应该可以自己编写这梦寐以求的文档。</p>

<p>这份指南开始是作为我们公司内部的 Ruby 编程指南（由我所写的）。后来，我决定把成果贡献给广大的 Ruby 社区，况且这个世界再多一份公司内部文档又有何意义。然而由社区制定及策动的一系列 Ruby 编程实践、惯例及风格确能让世界受益。</p>

<p>从编写这份指南开始，我收到了来自世界各地优秀 Ruby 社区的很多用户反馈。衷心感谢所有建议及帮助！同心协力，我们能创造出让每一个 Ruby 开发者受益的资源。</p>

<p>顺道一提，如果你对 Rails 感兴趣，你可以看看这份 <a href="https://github.com/bbatsov/rails-style-guide">Ruby on Rails 风格指南</a>。</p>

<h1><a id="user-content-ruby-风格指南" class="anchor" href="#ruby-风格指南" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>Ruby 风格指南</h1>

<p>这份 Ruby 风格指南推荐的是 Ruby 的最佳实践，现实世界中的 Ruby 程序员据此可以写出可维护的高质量代码。我们只说实际使用中的用法。指南再好，但里面说的过于理想化结果大家拒绝使用或者可能根本没人用，又有何意义。</p>

<p>本指南分为几个小节，每一小节由几条相关的规则构成。我尽力在每条规则后面说明理由（如果省略了说明，那是因为其理由显而易见）。</p>

<p>这些规则不是我凭空想象出来的——它们中的绝大部分来自我多年以来作为职业软件工程师的经验，来自 Ruby 社区成员的反馈和建议，以及几个评价甚高的 Ruby 编程资源，像<a href="https://pragprog.com/book/ruby4/programming-ruby-1-9-2-0">《Programming Ruby》</a>以及<a href="http://www.amazon.com/Ruby-Programming-Language-David-Flanagan/dp/0596516177">《The Ruby Programming Language》</a>。</p>

<p>Ruby 社区尚未就某些规则达成明显的共识，比如字符串字面量的引号、哈希字面量两端是否应该添加空格、多行链式方法调用中 <code>.</code> 操作符的位置。对于这种情况，本指南列出了所有可选的流行风格，你可以任选其一并坚持使用。</p>

<p>本指南会一直更新，随着 Ruby 本身的发展，新的规则会添加进来，过时的规则会被剔除。</p>

<p>许多项目有其自己的编程风格指南（往往是源于本指南而创建）。当项目的风格指南与本指南发生冲突时，应以项目级的指南为准。</p>

<p>你可以使用 <a href="http://pandoc.org/">Pandoc</a> 生成本指南的 PDF 或 HTML 版本。</p>

<p><a href="https://github.com/bbatsov/rubocop">RuboCop</a> 工具会自动检查你的 Ruby 代码是否符合这份 Ruby 风格指南。</p>

<p>本指南有以下翻译版本：</p>

<ul>
<li><a href="https://github.com/JuanitoFatas/ruby-style-guide/blob/master/README-zhCN.md">简体中文</a></li>
<li><a href="https://github.com/JuanitoFatas/ruby-style-guide/blob/master/README-zhTW.md">繁体中文</a></li>
<li><a href="https://github.com/gauthier-delacroix/ruby-style-guide/blob/master/README-frFR.md">法文</a></li>
<li><a href="https://github.com/arbox/de-ruby-style-guide/blob/master/README-deDE.md">德文</a></li>
<li><a href="https://github.com/fortissimo1997/ruby-style-guide/blob/japanese/README.ja.md">日文</a></li>
<li><a href="https://github.com/dalzony/ruby-style-guide/blob/master/README-koKR.md">韩文</a></li>
<li><a href="https://github.com/rubensmabueno/ruby-style-guide/blob/master/README-PT-BR.md">葡萄牙文</a></li>
<li><a href="https://github.com/arbox/ruby-style-guide/blob/master/README-ruRU.md">俄文</a></li>
<li><a href="https://github.com/alemohamad/ruby-style-guide/blob/master/README-esLA.md">西班牙文</a></li>
<li><a href="https://github.com/scrum2b/ruby-style-guide/blob/master/README-viVN.md">越南文</a></li>
</ul>

<h2><a id="user-content-目录" class="anchor" href="#目录" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>目录</h2>

<ul>
<li><a href="#%E6%BA%90%E4%BB%A3%E7%A0%81%E6%8E%92%E7%89%88">源代码排版</a></li>
<li><a href="#%E8%AF%AD%E6%B3%95">语法</a></li>
<li><a href="#%E5%91%BD%E5%90%8D">命名</a></li>
<li><a href="#%E6%B3%A8%E9%87%8A">注释</a>

<ul>
<li><a href="#%E6%B3%A8%E8%A7%A3">注解</a></li>
</ul></li>
<li><a href="#%E7%B1%BB%E4%B8%8E%E6%A8%A1%E5%9D%97">类与模块</a></li>
<li><a href="#%E5%BC%82%E5%B8%B8">异常</a></li>
<li><a href="#%E9%9B%86%E5%90%88">集合</a></li>
<li><a href="#%E5%AD%97%E7%AC%A6%E4%B8%B2">字符串</a></li>
<li><a href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">正则表达式</a></li>
<li><a href="#%E7%99%BE%E5%88%86%E5%8F%B7%E5%AD%97%E9%9D%A2%E9%87%8F">百分号字面量</a></li>
<li><a href="#%E5%85%83%E7%BC%96%E7%A8%8B">元编程</a></li>
<li><a href="#%E5%85%B6%E4%BB%96">其他</a></li>
<li><a href="#%E5%B7%A5%E5%85%B7">工具</a></li>
</ul>

<h2><a id="user-content-源代码排版" class="anchor" href="#源代码排版" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>源代码排版</h2>

<blockquote>
<p>所有风格都又丑又难读，自己的除外。几乎人人都这样想。把“自己的除外”拿掉，他们或许是对的...<br>
——Jerry Coffin（论缩排）</p>
</blockquote>

<ul>
<li><p><a name="user-content-utf-8"></a>
使用 <code>UTF-8</code> 作为源文件的编码。
<sup>[<a href="#utf-8">link</a>]</sup></p></li>
<li><p><a name="user-content-spaces-indentation"></a>
每个缩排层级使用两个<strong>空格</strong>。不要使用制表符。
<sup>[<a href="#spaces-indentation">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 四个空格</span>
<span class="pl-k">def</span> <span class="pl-en">some_method</span>
    do_something
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">some_method</span>
  do_something
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-crlf"></a>
使用 Unix 风格的换行符。（*BSD/Solaris/Linux/OS X 系统的用户不需担心，Windows 用户则要格外小心。）
<sup>[<a href="#crlf">link</a>]</sup></p>

<ul>
<li><p>如果你使用 Git，可用下面这个配置来保护你的项目不被 Windows 的换行符干扰：</p>

<div class="highlight highlight-source-shell"><pre>$ git config --global core.autocrlf <span class="pl-c1">true</span></pre></div></li>
</ul></li>
<li><p><a name="user-content-no-semicolon"></a>
不要使用 <code>;</code> 隔开语句与表达式。推论：一行一条语句。
<sup>[<a href="#no-semicolon">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
puts <span class="pl-s"><span class="pl-pds">'</span>foobar<span class="pl-pds">'</span></span>; <span class="pl-c"># 不必要的分号</span>

puts <span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>; puts <span class="pl-s"><span class="pl-pds">'</span>bar<span class="pl-pds">'</span></span> <span class="pl-c"># 一行里有两个表达式</span>

<span class="pl-c"># 好</span>
puts <span class="pl-s"><span class="pl-pds">'</span>foobar<span class="pl-pds">'</span></span>

puts <span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>
puts <span class="pl-s"><span class="pl-pds">'</span>bar<span class="pl-pds">'</span></span>

puts <span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>bar<span class="pl-pds">'</span></span> <span class="pl-c"># 仅对 puts 适用</span></pre></div></li>
<li><p><a name="user-content-single-line-classes"></a>
对于没有主体的类，倾向使用单行定义。
<sup>[<a href="#single-line-classes">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">class</span> <span class="pl-en">FooError<span class="pl-e"> &lt; StandardError</span></span>
<span class="pl-k">end</span>

<span class="pl-c"># 勉强可以</span>
<span class="pl-k">class</span> <span class="pl-en">FooError<span class="pl-e"> &lt; StandardError</span></span>; <span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-c1">FooError</span> <span class="pl-k">=</span> <span class="pl-c1">Class</span>.<span class="pl-k">new</span>(<span class="pl-c1">StandardError</span>)</pre></div></li>
<li><p><a name="user-content-no-single-line-methods"></a>
定义方法时，避免单行写法。尽管这种写法有时颇为普遍，但其略显古怪的定义语法容易使人犯错。无论如何，至少保证单行写法的方法不应该拥有一个以上的表达式。
<sup>[<a href="#no-single-line-methods">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">too_much</span>; something; something_else; <span class="pl-k">end</span>

<span class="pl-c"># 勉强可以 - 注意第一个 ; 是必选的</span>
<span class="pl-k">def</span> <span class="pl-en">no_braces_method</span>; body <span class="pl-k">end</span>

<span class="pl-c"># 勉强可以 - 注意第二个 ; 是可选的</span>
<span class="pl-k">def</span> <span class="pl-en">no_braces_method</span>; body; <span class="pl-k">end</span>

<span class="pl-c"># 勉强可以 - 语法正确，但没有 ; 使得可读性欠佳</span>
<span class="pl-k">def</span> <span class="pl-en">some_method</span>() body <span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">some_method</span>
  body
<span class="pl-k">end</span></pre></div>

<p>这个规则的一个例外是空方法。</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">no_op</span>; <span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-spaces-operators"></a>
操作符前后适当地添加空格，在逗号 <code>,</code>、冒号 <code>:</code> 及分号 <code>;</code> 之后，在 <code>{</code> 前后，在 <code>}</code> 之前。尽管 Ruby 解释器（大部分情况下）会忽略空格，但适量的空格可以增强代码的可读性。
<sup>[<a href="#spaces-operators">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>sum <span class="pl-k">=</span> <span class="pl-c1">1</span> <span class="pl-k">+</span> <span class="pl-c1">2</span>
a, b <span class="pl-k">=</span> <span class="pl-c1">1</span>, <span class="pl-c1">2</span>
[<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>].each { |<span class="pl-smi">e</span>| puts e }
<span class="pl-k">class</span> <span class="pl-en">FooError<span class="pl-e"> &lt; StandardError</span></span>; <span class="pl-k">end</span></pre></div>

<p>（对于操作符）唯一的例外是当使用指数操作符时：</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
e <span class="pl-k">=</span> <span class="pl-c1">M</span> <span class="pl-k">*</span> c <span class="pl-k">**</span> <span class="pl-c1">2</span>

<span class="pl-c"># 好</span>
e <span class="pl-k">=</span> <span class="pl-c1">M</span> <span class="pl-k">*</span> c<span class="pl-k">**</span><span class="pl-c1">2</span></pre></div>

<p><code>{</code> 与 <code>}</code> 需要额外说明，因为它们可以同时用在区块、哈希字面量及字符串插值中。对于哈希字面量，有两种可被接受的风格：</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 好 - { 之后 与 } 之前有空格</span>
{ <span class="pl-c1">one:</span> <span class="pl-c1">1</span>, <span class="pl-c1">two:</span> <span class="pl-c1">2</span> }

<span class="pl-c"># 好 - { 之后 与 } 之前无空格</span>
{<span class="pl-c1">one:</span> <span class="pl-c1">1</span>, <span class="pl-c1">two:</span> <span class="pl-c1">2</span>}</pre></div>

<p>第一种风格更具可读性（在 Ruby 社区里似乎更为流行）。第二种风格的优点是，在视觉上使得区块与哈希字面量有所区分。无论你选择何种风格，务必在使用时保持连贯性。</p></li>
<li><p><a name="user-content-no-spaces-braces"></a>
<code>(</code>、<code>[</code> 之后，<code>]</code>、<code>)</code> 之前，不要添加任何空格。
<sup>[<a href="#no-spaces-braces">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
some( arg ).other
[ <span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span> ].size

<span class="pl-c"># 好</span>
some(arg).other
[<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>].size</pre></div></li>
<li><p><a name="user-content-no-space-bang"></a>
<code>!</code> 之后，不要添加任何空格。
<sup>[<a href="#no-space-bang">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
! something

<span class="pl-c"># 好</span>
!something</pre></div></li>
<li><p><a name="user-content-no-space-inside-range-literals"></a>
范围的字面量语法中，不要添加任何空格。
<sup>[<a href="#no-space-inside-range-literals">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-c1">1</span> .. <span class="pl-c1">3</span>
<span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span> ... <span class="pl-s"><span class="pl-pds">'</span>z<span class="pl-pds">'</span></span>

<span class="pl-c"># 好</span>
<span class="pl-c1">1</span>..<span class="pl-c1">3</span>
<span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>...<span class="pl-s"><span class="pl-pds">'</span>z<span class="pl-pds">'</span></span></pre></div></li>
<li><p><a name="user-content-indent-when-to-case"></a>
把 <code>when</code> 与 <code>case</code> 缩排在同一层级。这是《Programming Ruby》与《The Ruby Programming Language》中早已确立的风格。
<sup>[<a href="#indent-when-to-case">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">case</span>
  <span class="pl-k">when</span> song.name <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">'</span>Misty<span class="pl-pds">'</span></span>
    puts <span class="pl-s"><span class="pl-pds">'</span>Not again!<span class="pl-pds">'</span></span>
  <span class="pl-k">when</span> song.duration <span class="pl-k">&gt;</span> <span class="pl-c1">120</span>
    puts <span class="pl-s"><span class="pl-pds">'</span>Too long!<span class="pl-pds">'</span></span>
  <span class="pl-k">when</span> <span class="pl-c1">Time</span>.now.hour <span class="pl-k">&gt;</span> <span class="pl-c1">21</span>
    puts <span class="pl-s"><span class="pl-pds">"</span>It's too late<span class="pl-pds">"</span></span>
  <span class="pl-k">else</span>
    song.play
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">case</span>
<span class="pl-k">when</span> song.name <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">'</span>Misty<span class="pl-pds">'</span></span>
  puts <span class="pl-s"><span class="pl-pds">'</span>Not again!<span class="pl-pds">'</span></span>
<span class="pl-k">when</span> song.duration <span class="pl-k">&gt;</span> <span class="pl-c1">120</span>
  puts <span class="pl-s"><span class="pl-pds">'</span>Too long!<span class="pl-pds">'</span></span>
<span class="pl-k">when</span> <span class="pl-c1">Time</span>.now.hour <span class="pl-k">&gt;</span> <span class="pl-c1">21</span>
  puts <span class="pl-s"><span class="pl-pds">"</span>It's too late<span class="pl-pds">"</span></span>
<span class="pl-k">else</span>
  song.play
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-indent-conditional-assignment"></a>
当将一个条件表达式的结果赋值给一个变量时，保持分支缩排在同一层级。
<sup>[<a href="#indent-conditional-assignment">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 非常费解</span>
kind <span class="pl-k">=</span> <span class="pl-k">case</span> year
<span class="pl-k">when</span> <span class="pl-c1">1850</span>..<span class="pl-c1">1889</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>Blues<span class="pl-pds">'</span></span>
<span class="pl-k">when</span> <span class="pl-c1">1890</span>..<span class="pl-c1">1909</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>Ragtime<span class="pl-pds">'</span></span>
<span class="pl-k">when</span> <span class="pl-c1">1910</span>..<span class="pl-c1">1929</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>New Orleans Jazz<span class="pl-pds">'</span></span>
<span class="pl-k">when</span> <span class="pl-c1">1930</span>..<span class="pl-c1">1939</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>Swing<span class="pl-pds">'</span></span>
<span class="pl-k">when</span> <span class="pl-c1">1940</span>..<span class="pl-c1">1950</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>Bebop<span class="pl-pds">'</span></span>
<span class="pl-k">else</span> <span class="pl-s"><span class="pl-pds">'</span>Jazz<span class="pl-pds">'</span></span>
<span class="pl-k">end</span>

result <span class="pl-k">=</span> <span class="pl-k">if</span> some_cond
  calc_something
<span class="pl-k">else</span>
  calc_something_else
<span class="pl-k">end</span>

<span class="pl-c"># 好 - 结构清晰</span>
kind <span class="pl-k">=</span> <span class="pl-k">case</span> year
       <span class="pl-k">when</span> <span class="pl-c1">1850</span>..<span class="pl-c1">1889</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>Blues<span class="pl-pds">'</span></span>
       <span class="pl-k">when</span> <span class="pl-c1">1890</span>..<span class="pl-c1">1909</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>Ragtime<span class="pl-pds">'</span></span>
       <span class="pl-k">when</span> <span class="pl-c1">1910</span>..<span class="pl-c1">1929</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>New Orleans Jazz<span class="pl-pds">'</span></span>
       <span class="pl-k">when</span> <span class="pl-c1">1930</span>..<span class="pl-c1">1939</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>Swing<span class="pl-pds">'</span></span>
       <span class="pl-k">when</span> <span class="pl-c1">1940</span>..<span class="pl-c1">1950</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>Bebop<span class="pl-pds">'</span></span>
       <span class="pl-k">else</span> <span class="pl-s"><span class="pl-pds">'</span>Jazz<span class="pl-pds">'</span></span>
       <span class="pl-k">end</span>

result <span class="pl-k">=</span> <span class="pl-k">if</span> some_cond
           calc_something
         <span class="pl-k">else</span>
           calc_something_else
         <span class="pl-k">end</span>

<span class="pl-c"># 好 - 并且更好地利用行宽</span>
kind <span class="pl-k">=</span>
  <span class="pl-k">case</span> year
  <span class="pl-k">when</span> <span class="pl-c1">1850</span>..<span class="pl-c1">1889</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>Blues<span class="pl-pds">'</span></span>
  <span class="pl-k">when</span> <span class="pl-c1">1890</span>..<span class="pl-c1">1909</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>Ragtime<span class="pl-pds">'</span></span>
  <span class="pl-k">when</span> <span class="pl-c1">1910</span>..<span class="pl-c1">1929</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>New Orleans Jazz<span class="pl-pds">'</span></span>
  <span class="pl-k">when</span> <span class="pl-c1">1930</span>..<span class="pl-c1">1939</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>Swing<span class="pl-pds">'</span></span>
  <span class="pl-k">when</span> <span class="pl-c1">1940</span>..<span class="pl-c1">1950</span> <span class="pl-k">then</span> <span class="pl-s"><span class="pl-pds">'</span>Bebop<span class="pl-pds">'</span></span>
  <span class="pl-k">else</span> <span class="pl-s"><span class="pl-pds">'</span>Jazz<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>

result <span class="pl-k">=</span>
  <span class="pl-k">if</span> some_cond
    calc_something
  <span class="pl-k">else</span>
    calc_something_else
  <span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-empty-lines-between-methods"></a>
在各个方法定义之间添加空行，并且将方法分成若干合乎逻辑的段落。
<sup>[<a href="#empty-lines-between-methods">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">def</span> <span class="pl-en">some_method</span>
  data <span class="pl-k">=</span> <span class="pl-k">initialize</span>(options)

  data.manipulate!

  data.result
<span class="pl-k">end</span>

<span class="pl-k">def</span> <span class="pl-en">some_method</span>
  result
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-trailing-params-comma"></a>
避免在方法调用的最后一个参数之后添加逗号，尤其当参数没有分布在同一行时。
<sup>[<a href="#no-trailing-params-comma">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 尽管移动、新增、删除参数颇为方便，但仍不推荐这种写法</span>
some_method(
             size,
             count,
             color,
           )

<span class="pl-c"># 差</span>
some_method(size, count, color, )

<span class="pl-c"># 好</span>
some_method(size, count, color)</pre></div></li>
<li><p><a name="user-content-spaces-around-equals"></a>
当给方法的参数赋予默认值时，在 <code>=</code> 前后添加空格。
<sup>[<a href="#spaces-around-equals">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">some_method</span>(<span class="pl-smi">arg1</span><span class="pl-k">=</span><span class="pl-c1">:default</span>, <span class="pl-smi">arg2</span><span class="pl-k">=</span><span class="pl-c1">nil</span>, <span class="pl-smi">arg3</span><span class="pl-k">=</span>[])
  <span class="pl-c"># 做一些事情</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">some_method</span>(<span class="pl-smi">arg1</span> <span class="pl-k">=</span> <span class="pl-c1">:default</span>, <span class="pl-smi">arg2</span> <span class="pl-k">=</span> <span class="pl-c1">nil</span>, <span class="pl-smi">arg3</span> <span class="pl-k">=</span> [])
  <span class="pl-c"># 做一些事情</span>
<span class="pl-k">end</span></pre></div>

<p>尽管有几本 Ruby 书籍推荐使用第一种风格，但第二种在实践中更为常见（而且似乎更具可读性）。</p></li>
<li><p><a name="user-content-no-trailing-backslash"></a>
避免在非必要的情形下使用续行符 <code>\</code>。在实践中，除了字符串拼接，避免在其他任何地方使用续行。
<sup>[<a href="#no-trailing-backslash">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
result <span class="pl-k">=</span> <span class="pl-c1">1</span> <span class="pl-k">-</span> \
         <span class="pl-c1">2</span>

<span class="pl-c"># 好 - 但仍然丑到爆</span>
result <span class="pl-k">=</span> <span class="pl-c1">1</span> \
         <span class="pl-k">-</span> <span class="pl-c1">2</span>

long_string <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>First part of the long string<span class="pl-pds">'</span></span> \
              <span class="pl-s"><span class="pl-pds">'</span> and second part of the long string<span class="pl-pds">'</span></span></pre></div></li>
<li><p><a name="user-content-consistent-multi-line-chains"></a>
使用统一的风格进行多行链式方法调用。在 Ruby 社区中存在两种流行的风格：前置 <code>.</code>（风格 A）与后置 <code>.</code>（风格 B）。
<sup>[<a href="#consistent-multi-line-chains">link</a>]</sup></p>

<ul>
<li><p><strong>（风格 A）</strong> 当多行链式方法调用需要另起一行继续时，将 <code>.</code> 放在第二行开头。</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 需要查看第一行才能理解第二行在做什么</span>
one.two.three.
  four

<span class="pl-c"># 好 - 立刻能够明白第二行在做什么</span>
one.two.three
  .four</pre></div></li>
<li><p><strong>（风格 B）</strong> 将 <code>.</code> 放在第一行末尾，以表示当前表达式尚未结束。</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 需要查看第二行才能知道链式方法调用是否结束</span>
one.two.three
  .four

<span class="pl-c"># 好 - 立刻能够明白第二行还有其他方法调用</span>
one.two.three.
  four</pre></div></li>
</ul>

<p>两种风格各自优点查阅<a href="https://github.com/bbatsov/ruby-style-guide/pull/176">这里</a>。</p></li>
<li><p><a name="user-content-no-double-indent"></a>
当方法调用参数过长时，将它们排列在多行并对齐。若对齐后长度超过行宽限制，将首个参数位置挪到下一行进行缩排也是可以接受的。
<sup>[<a href="#no-double-indent">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 初始（行太长了）</span>
<span class="pl-k">def</span> <span class="pl-en">send_mail</span>(<span class="pl-smi">source</span>)
  <span class="pl-c1">Mailer</span>.deliver(<span class="pl-c1">to:</span> <span class="pl-s"><span class="pl-pds">'</span>bob@example.com<span class="pl-pds">'</span></span>, <span class="pl-c1">from:</span> <span class="pl-s"><span class="pl-pds">'</span>us@example.com<span class="pl-pds">'</span></span>, <span class="pl-c1">subject:</span> <span class="pl-s"><span class="pl-pds">'</span>Important message<span class="pl-pds">'</span></span>, <span class="pl-c1">body:</span> source.text)
<span class="pl-k">end</span>

<span class="pl-c"># 差 - 双倍缩排</span>
<span class="pl-k">def</span> <span class="pl-en">send_mail</span>(<span class="pl-smi">source</span>)
  <span class="pl-c1">Mailer</span>.deliver(
      <span class="pl-c1">to:</span> <span class="pl-s"><span class="pl-pds">'</span>bob@example.com<span class="pl-pds">'</span></span>,
      <span class="pl-c1">from:</span> <span class="pl-s"><span class="pl-pds">'</span>us@example.com<span class="pl-pds">'</span></span>,
      <span class="pl-c1">subject:</span> <span class="pl-s"><span class="pl-pds">'</span>Important message<span class="pl-pds">'</span></span>,
      <span class="pl-c1">body:</span> source.text)
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">send_mail</span>(<span class="pl-smi">source</span>)
  <span class="pl-c1">Mailer</span>.deliver(<span class="pl-c1">to:</span> <span class="pl-s"><span class="pl-pds">'</span>bob@example.com<span class="pl-pds">'</span></span>,
                 <span class="pl-c1">from:</span> <span class="pl-s"><span class="pl-pds">'</span>us@example.com<span class="pl-pds">'</span></span>,
                 <span class="pl-c1">subject:</span> <span class="pl-s"><span class="pl-pds">'</span>Important message<span class="pl-pds">'</span></span>,
                 <span class="pl-c1">body:</span> source.text)
<span class="pl-k">end</span>

<span class="pl-c"># 好 - 普通缩排</span>
<span class="pl-k">def</span> <span class="pl-en">send_mail</span>(<span class="pl-smi">source</span>)
  <span class="pl-c1">Mailer</span>.deliver(
    <span class="pl-c1">to:</span> <span class="pl-s"><span class="pl-pds">'</span>bob@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-c1">from:</span> <span class="pl-s"><span class="pl-pds">'</span>us@example.com<span class="pl-pds">'</span></span>,
    <span class="pl-c1">subject:</span> <span class="pl-s"><span class="pl-pds">'</span>Important message<span class="pl-pds">'</span></span>,
    <span class="pl-c1">body:</span> source.text
  )
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-align-multiline-arrays"></a>
当构建数组时，若元素跨行，应当保持对齐。
<sup>[<a href="#align-multiline-arrays">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 没有对齐</span>
menu_item <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>,
  <span class="pl-s"><span class="pl-pds">'</span>Baked beans<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>]

<span class="pl-c"># 好</span>
menu_item <span class="pl-k">=</span> [
  <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>,
  <span class="pl-s"><span class="pl-pds">'</span>Baked beans<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>
]

<span class="pl-c"># 好</span>
menu_item <span class="pl-k">=</span>
  [<span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>,
   <span class="pl-s"><span class="pl-pds">'</span>Baked beans<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Spam<span class="pl-pds">'</span></span>]</pre></div></li>
<li><p><a name="user-content-underscores-in-numerics"></a>
使用 <code>_</code> 语法改善大数的数值字面量的可读性。
<sup>[<a href="#underscores-in-numerics">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 有几个零？</span>
num <span class="pl-k">=</span> <span class="pl-c1">1000000</span>

<span class="pl-c"># 好 - 方便人脑理解</span>
num <span class="pl-k">=</span> <span class="pl-c1">1_000_000</span></pre></div></li>
<li><p><a name="user-content-rdoc-conventions"></a>
使用 <a href="http://rdoc.sourceforge.net/doc/">RDoc</a> 及其惯例来编写 API 文档。注意，不要在注释与 <code>def</code> 之间添加空行。
<sup>[<a href="#rdoc-conventions">link</a>]</sup></p></li>
<li><p><a name="user-content-80-character-limits"></a>
将单行长度控制在 80 个字符内。
<sup>[<a href="#80-character-limits">link</a>]</sup></p></li>
<li><p><a name="user-content-no-trailing-whitespace"></a>
避免行尾空格。
<sup>[<a href="#no-trailing-whitespace">link</a>]</sup></p></li>
<li><p><a name="user-content-newline-eof"></a>
文件以空白行结束。
<sup>[<a href="#newline-eof">link</a>]</sup></p></li>
<li><p><a name="user-content-no-block-comments"></a>
不要使用区块注释。它们不能被空白字符引导，且不如常规注释容易辨认。
<sup>[<a href="#no-block-comments">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-c">=begin</span>
<span class="pl-c">comment line</span>
<span class="pl-c">another comment line</span>
<span class="pl-c">=end</span>

<span class="pl-c"># 好</span>
<span class="pl-c"># comment line</span>
<span class="pl-c"># another comment line</span></pre></div></li>
</ul>

<h2><a id="user-content-语法" class="anchor" href="#语法" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>语法</h2>

<ul>
<li><p><a name="user-content-double-colons"></a>
使用 <code>::</code> 引用常量（包括类与模块）与构造器（比如 <code>Array()</code>、<code>Nokogiri::HTML()</code>）。不要使用 <code>::</code> 调用常规方法。
<sup>[<a href="#double-colons">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-c1">SomeClass</span>::some_method
some_object::some_method

<span class="pl-c"># 好</span>
<span class="pl-c1">SomeClass</span>.some_method
some_object.some_method
<span class="pl-c1">SomeModule</span>::<span class="pl-c1">SomeClass</span>::<span class="pl-c1">SOME_CONST</span>
<span class="pl-c1">SomeModule</span>::<span class="pl-c1">SomeClass</span>()</pre></div></li>
<li><p><a name="user-content-method-parens"></a>
使用 <code>def</code> 定义方法时，如果有参数则使用括号，如果无参数则省略括号。
<sup>[<a href="#method-parens">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">some_method</span>()
 <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">some_method</span>
 <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span>

<span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">some_method_with_parameters</span> <span class="pl-smi">param1</span>, <span class="pl-smi">param2</span>
 <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">some_method_with_parameters</span>(<span class="pl-smi">param1</span>, <span class="pl-smi">param2</span>)
 <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-optional-arguments"></a>
定义可选参数时，将可选参数放置在参数列表尾部。如果可选参数出现在列表头部，则此方法在调用时可能会产生预期之外的结果。
<sup>[<a href="#optional-arguments">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">some_method</span>(<span class="pl-smi">a</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>, <span class="pl-smi">b</span> <span class="pl-k">=</span> <span class="pl-c1">2</span>, <span class="pl-smi">c</span>, <span class="pl-smi">d</span>)
  puts <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pse">#{</span><span class="pl-s1">a</span><span class="pl-pse"><span class="pl-s1">}</span></span>, <span class="pl-pse">#{</span><span class="pl-s1">b</span><span class="pl-pse"><span class="pl-s1">}</span></span>, <span class="pl-pse">#{</span><span class="pl-s1">c</span><span class="pl-pse"><span class="pl-s1">}</span></span>, <span class="pl-pse">#{</span><span class="pl-s1">d</span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>
<span class="pl-k">end</span>

some_method(<span class="pl-s"><span class="pl-pds">'</span>w<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>x<span class="pl-pds">'</span></span>) <span class="pl-c"># =&gt; '1, 2, w, x'</span>
some_method(<span class="pl-s"><span class="pl-pds">'</span>w<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>x<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>y<span class="pl-pds">'</span></span>) <span class="pl-c"># =&gt; 'w, 2, x, y'</span>
some_method(<span class="pl-s"><span class="pl-pds">'</span>w<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>x<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>y<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>z<span class="pl-pds">'</span></span>) <span class="pl-c"># =&gt; 'w, x, y, z'</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">some_method</span>(<span class="pl-smi">c</span>, <span class="pl-smi">d</span>, <span class="pl-smi">a</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>, <span class="pl-smi">b</span> <span class="pl-k">=</span> <span class="pl-c1">2</span>)
  puts <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pse">#{</span><span class="pl-s1">a</span><span class="pl-pse"><span class="pl-s1">}</span></span>, <span class="pl-pse">#{</span><span class="pl-s1">b</span><span class="pl-pse"><span class="pl-s1">}</span></span>, <span class="pl-pse">#{</span><span class="pl-s1">c</span><span class="pl-pse"><span class="pl-s1">}</span></span>, <span class="pl-pse">#{</span><span class="pl-s1">d</span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>
<span class="pl-k">end</span>

some_method(<span class="pl-s"><span class="pl-pds">'</span>w<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>x<span class="pl-pds">'</span></span>) <span class="pl-c"># =&gt; '1, 2, w, x'</span>
some_method(<span class="pl-s"><span class="pl-pds">'</span>w<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>x<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>y<span class="pl-pds">'</span></span>) <span class="pl-c"># =&gt; 'y, 2, w, x'</span>
some_method(<span class="pl-s"><span class="pl-pds">'</span>w<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>x<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>y<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>z<span class="pl-pds">'</span></span>) <span class="pl-c"># =&gt; 'y, z, w, x'</span></pre></div></li>
<li><p><a name="user-content-parallel-assignment"></a>
定义变量时，避免并行赋值。但当右值为方法调用返回值，或是与 <code>*</code> 操作符配合使用，或是交换两个变量的值，并行赋值也是可以接受的。并行赋值的可读性通常不如分开赋值。
<sup>[<a href="#parallel-assignment">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
a, b, c, d <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>bar<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>baz<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>foobar<span class="pl-pds">'</span></span>

<span class="pl-c"># 好</span>
a <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>
b <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>bar<span class="pl-pds">'</span></span>
c <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>baz<span class="pl-pds">'</span></span>
d <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>foobar<span class="pl-pds">'</span></span>

<span class="pl-c"># 好 - 交换两个变量的值</span>
a <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>
b <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>bar<span class="pl-pds">'</span></span>

a, b <span class="pl-k">=</span> b, a
puts a <span class="pl-c"># =&gt; 'bar'</span>
puts b <span class="pl-c"># =&gt; 'foo'</span>

<span class="pl-c"># 好 - 右值为方法调用返回值</span>
<span class="pl-k">def</span> <span class="pl-en">multi_return</span>
  [<span class="pl-c1">1</span>, <span class="pl-c1">2</span>]
<span class="pl-k">end</span>

first, second <span class="pl-k">=</span> multi_return

<span class="pl-c"># 好 - 与 * 操作符配合使用</span>
first, <span class="pl-k">*</span>list <span class="pl-k">=</span> [<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>, <span class="pl-c1">4</span>]

hello_array <span class="pl-k">=</span> <span class="pl-k">*</span><span class="pl-s"><span class="pl-pds">'</span>Hello<span class="pl-pds">'</span></span>

a <span class="pl-k">=</span> <span class="pl-k">*</span>(<span class="pl-c1">1</span>..<span class="pl-c1">3</span>)</pre></div></li>
<li><p><a name="user-content-trailing-underscore-variables"></a>
除非必要，否则避免在并行赋值时使用单字符的 <code>_</code> 变量。优先考虑前缀形式的下划线变量，而不是直接使用 <code>_</code>，因为前者可以提供一定的语义信息。但当赋值语句左侧出现带 <code>*</code> 操作符的变量时，使用 <code>_</code> 也是可以接受的。
<sup><a href="#trailing-underscore-variables">[link]</a></sup></p>

<div class="highlight highlight-source-ruby"><pre>foo <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>one,two,three,four,five<span class="pl-pds">'</span></span>

<span class="pl-c"># 差 - 可有可无，且无任何有用信息</span>
first, second, _ <span class="pl-k">=</span> foo.split(<span class="pl-s"><span class="pl-pds">'</span>,<span class="pl-pds">'</span></span>)
first, _, _ <span class="pl-k">=</span> foo.split(<span class="pl-s"><span class="pl-pds">'</span>,<span class="pl-pds">'</span></span>)
first, <span class="pl-k">*</span>_ <span class="pl-k">=</span> foo.split(<span class="pl-s"><span class="pl-pds">'</span>,<span class="pl-pds">'</span></span>)

<span class="pl-c"># 好</span>
a, <span class="pl-k">=</span> foo.split(<span class="pl-s"><span class="pl-pds">'</span>,<span class="pl-pds">'</span></span>)
a, b, <span class="pl-k">=</span> foo.split(<span class="pl-s"><span class="pl-pds">'</span>,<span class="pl-pds">'</span></span>)

<span class="pl-c"># 好 - 可有可无，但提供了额外信息</span>
first, _second <span class="pl-k">=</span> foo.split(<span class="pl-s"><span class="pl-pds">'</span>,<span class="pl-pds">'</span></span>)
first, _second, <span class="pl-k">=</span> foo.split(<span class="pl-s"><span class="pl-pds">'</span>,<span class="pl-pds">'</span></span>)
first, <span class="pl-k">*</span>_ending <span class="pl-k">=</span> foo.split(<span class="pl-s"><span class="pl-pds">'</span>,<span class="pl-pds">'</span></span>)

<span class="pl-c"># 好 - 占位符，_ 担当最后一个元素</span>
<span class="pl-k">*</span>beginning, _ <span class="pl-k">=</span> foo.split(<span class="pl-s"><span class="pl-pds">'</span>,<span class="pl-pds">'</span></span>)
<span class="pl-k">*</span>beginning, something, _ <span class="pl-k">=</span> foo.split(<span class="pl-s"><span class="pl-pds">'</span>,<span class="pl-pds">'</span></span>)</pre></div></li>
<li><p><a name="user-content-no-for-loops"></a>
永远不要使用 <code>for</code>， 除非你很清楚为什么。大部分情况下，你应该使用迭代器。<code>for</code> 是由 <code>each</code> 实现的，所以你绕弯了。另外，<code>for</code> 没有引入一个新的作用域 (<code>each</code> 有），因此在它内部定义的变量在外部仍是可见的。
<sup>[<a href="#no-for-loops">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>arr <span class="pl-k">=</span> [<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>]

<span class="pl-c"># 差</span>
<span class="pl-k">for</span> elem <span class="pl-k">in</span> arr <span class="pl-k">do</span>
  puts elem
<span class="pl-k">end</span>

<span class="pl-c"># 注意，elem 可在 for 循环外部被访问</span>
elem <span class="pl-c"># =&gt; 3</span>

<span class="pl-c"># 好</span>
arr.each { |<span class="pl-smi">elem</span>| puts elem }

<span class="pl-c"># 注意，elem 不可在 each 块外部被访问</span>
elem <span class="pl-c"># =&gt; NameError: undefined local variable or method `elem'</span></pre></div></li>
<li><p><a name="user-content-no-then"></a>
永远不要在多行 <code>if/unless</code> 中使用 <code>then</code>。
<sup>[<a href="#no-then">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">if</span> some_condition <span class="pl-k">then</span>
  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">if</span> some_condition
  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-same-line-condition"></a>
在多行 <code>if/unless</code> 中，总是把条件表达式与 <code>if/unless</code> 放置在同一行。
<sup>[<a href="#same-line-condition">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">if</span>
  some_condition
  do_something
  do_something_else
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">if</span> some_condition
  do_something
  do_something_else
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-ternary-operator"></a>
倾向使用三元操作符（<code>?:</code>）而不是 <code>if/then/else/end</code> 结构。前者更为常见且简练。
<sup>[<a href="#ternary-operator">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
result <span class="pl-k">=</span> <span class="pl-k">if</span> some_condition <span class="pl-k">then</span> something <span class="pl-k">else</span> something_else <span class="pl-k">end</span>

<span class="pl-c"># 好</span>
result <span class="pl-k">=</span> some_condition <span class="pl-k">?</span> something : something_else</pre></div></li>
<li><p><a name="user-content-no-nested-ternary"></a>
三元操作符的每个分支只写一个表达式。即不要嵌套三元操作符。嵌套情况请使用 <code>if/else</code> 结构。
<sup>[<a href="#no-nested-ternary">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
some_condition <span class="pl-k">?</span> (nested_condition <span class="pl-k">?</span> nested_something : nested_something_else) : something_else

<span class="pl-c"># 好</span>
<span class="pl-k">if</span> some_condition
  nested_condition <span class="pl-k">?</span> nested_something : nested_something_else
<span class="pl-k">else</span>
  something_else
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-semicolon-ifs"></a>
永远不要使用 <code>if x; ...</code>。使用三元操作符来替代。
<sup>[<a href="#no-semicolon-ifs">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
result <span class="pl-k">=</span> <span class="pl-k">if</span> some_condition; something <span class="pl-k">else</span> something_else <span class="pl-k">end</span>

<span class="pl-c"># 好</span>
result <span class="pl-k">=</span> some_condition <span class="pl-k">?</span> something : something_else</pre></div></li>
<li><p><a name="user-content-use-if-case-returns"></a>
利用“<code>if</code> 与 <code>case</code> 是表达式”的这个特性。
<sup>[<a href="#use-if-case-returns">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">if</span> condition
  result <span class="pl-k">=</span> x
<span class="pl-k">else</span>
  result <span class="pl-k">=</span> y
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
result <span class="pl-k">=</span>
  <span class="pl-k">if</span> condition
    x
  <span class="pl-k">else</span>
    y
  <span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-one-line-cases"></a>
在 <code>case</code> 表达式中，单行情况使用 <code>when x then ...</code> 语法。另一种语法 <code>when x: ...</code> 在 Ruby 1.9 之后被移除了。
<sup>[<a href="#one-line-cases">link</a>]</sup></p></li>
<li><p><a name="user-content-no-when-semicolons"></a>
不要使用 <code>when x; ...</code> 语法。参考前一条规则。
<sup>[<a href="#no-when-semicolons">link</a>]</sup></p></li>
<li><p><a name="user-content-bang-not-not"></a>
使用 <code>!</code> 而不是 <code>not</code>。
<sup>[<a href="#bang-not-not">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 因为操作符的优先级，这里必须使用括号</span>
x <span class="pl-k">=</span> (<span class="pl-k">not</span> something)

<span class="pl-c"># 好</span>
x <span class="pl-k">=</span> <span class="pl-k">!</span>something</pre></div></li>
<li><p><a name="user-content-no-bang-bang"></a>
避免使用 <code>!!</code>。
<sup>[<a href="#no-bang-bang">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
x <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>test<span class="pl-pds">'</span></span>
<span class="pl-c"># 令人费解的 nil 检查</span>
<span class="pl-k">if</span> <span class="pl-k">!!</span>x
  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span>

x <span class="pl-k">=</span> <span class="pl-c1">false</span>
<span class="pl-c"># 对于布尔变量，双重否定是多余的</span>
!!x <span class="pl-c"># =&gt; false</span>

<span class="pl-c"># 好</span>
x <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>test<span class="pl-pds">'</span></span>
<span class="pl-k">unless</span> x.nil?
  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-and-or-or"></a>
永远不要使用 <code>and</code> 与 <code>or</code> 关键字。使用 <code>&amp;&amp;</code> 与 <code>||</code> 来替代。
<sup>[<a href="#no-and-or-or">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-c"># 布尔表达式</span>
<span class="pl-k">if</span> some_condition <span class="pl-k">and</span> some_other_condition
  do_something
<span class="pl-k">end</span>

<span class="pl-c"># 流程控制</span>
document.saved? <span class="pl-k">or</span> document.save!

<span class="pl-c"># 好</span>
<span class="pl-c"># 布尔表达式</span>
<span class="pl-k">if</span> some_condition <span class="pl-k">&amp;&amp;</span> some_other_condition
  do_something
<span class="pl-k">end</span>

<span class="pl-c"># 流程控制</span>
document.saved? <span class="pl-k">||</span> document.save!</pre></div></li>
<li><p><a name="user-content-no-multiline-ternary"></a>
避免使用多行三元操作符（<code>?:</code>）。使用 <code>if/unless</code> 来替代。
<sup>[<a href="#no-multiline-ternary">link</a>]</sup></p></li>
<li><p><a name="user-content-if-as-a-modifier"></a>
对于单行主体，倾向使用 <code>if/unless</code> 修饰语法。另一种方法是使用流程控制 <code>&amp;&amp;/||</code>。
<sup>[<a href="#if-as-a-modifier">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">if</span> some_condition
  do_something
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
do_something <span class="pl-k">if</span> some_condition

<span class="pl-c"># 好 - 使用流程控制</span>
some_condition <span class="pl-k">&amp;&amp;</span> do_something</pre></div></li>
<li><p><a name="user-content-no-multiline-if-modifiers"></a>
避免在多行区块后使用 <code>if/unless</code> 修饰语法。
<sup>[<a href="#no-multiline-if-modifiers">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-c1">10</span>.times <span class="pl-k">do</span>
  <span class="pl-c"># 省略多行主体</span>
<span class="pl-k">end</span> <span class="pl-k">if</span> some_condition

<span class="pl-c"># 好</span>
<span class="pl-k">if</span> some_condition
  <span class="pl-c1">10</span>.times <span class="pl-k">do</span>
    <span class="pl-c"># 省略多行主体</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-nested-modifiers"></a>
避免使用嵌套 <code>if/unless/while/until</code> 修饰语法。适当情况下，使用 <code>&amp;&amp;/||</code> 来替代。
<sup>[<a href="#no-nested-modifiers">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
do_something <span class="pl-k">if</span> other_condition <span class="pl-k">if</span> some_condition

<span class="pl-c"># 好</span>
do_something <span class="pl-k">if</span> some_condition <span class="pl-k">&amp;&amp;</span> other_condition</pre></div></li>
<li><p><a name="user-content-unless-for-negatives"></a>
对于否定条件，倾向使用 <code>unless</code> 而不是 <code>if</code>（或是使用流程控制 <code>||</code>）。
<sup>[<a href="#unless-for-negatives">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
do_something <span class="pl-k">if</span> <span class="pl-k">!</span>some_condition

<span class="pl-c"># 差</span>
do_something <span class="pl-k">if</span> <span class="pl-k">not</span> some_condition

<span class="pl-c"># 好</span>
do_something <span class="pl-k">unless</span> some_condition

<span class="pl-c"># 好</span>
some_condition <span class="pl-k">||</span> do_something</pre></div></li>
<li><p><a name="user-content-no-else-with-unless"></a>
不要使用 <code>unless</code> 与 <code>else</code> 的组合。将它们改写成肯定条件。
<sup>[<a href="#no-else-with-unless">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">unless</span> success?
  puts <span class="pl-s"><span class="pl-pds">'</span>failure<span class="pl-pds">'</span></span>
<span class="pl-k">else</span>
  puts <span class="pl-s"><span class="pl-pds">'</span>success<span class="pl-pds">'</span></span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">if</span> success?
  puts <span class="pl-s"><span class="pl-pds">'</span>success<span class="pl-pds">'</span></span>
<span class="pl-k">else</span>
  puts <span class="pl-s"><span class="pl-pds">'</span>failure<span class="pl-pds">'</span></span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-parens-if"></a>
不要使用括号包裹 <code>if/unless/while/until</code> 的条件表达式。
<sup>[<a href="#no-parens-if">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">if</span> (x <span class="pl-k">&gt;</span> <span class="pl-c1">10</span>)
  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">if</span> x <span class="pl-k">&gt;</span> <span class="pl-c1">10</span>
  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span></pre></div>

<p>这个规则的一个例外是<a href="#safe-assignment-in-condition">条件表达式中的安全赋值</a>。</p></li>
<li><p><a name="user-content-no-multiline-while-do"></a>
在多行 <code>while/until</code> 中，不要使用 <code>while/until condition do</code>。
<sup>[<a href="#no-multiline-while-do">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">while</span> x <span class="pl-k">&gt;</span> <span class="pl-c1">5</span> <span class="pl-k">do</span>
  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span>

<span class="pl-k">until</span> x <span class="pl-k">&gt;</span> <span class="pl-c1">5</span> <span class="pl-k">do</span>
  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">while</span> x <span class="pl-k">&gt;</span> <span class="pl-c1">5</span>
  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span>

<span class="pl-k">until</span> x <span class="pl-k">&gt;</span> <span class="pl-c1">5</span>
  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-while-as-a-modifier"></a>
对于单行主体，倾向使用 <code>while/until</code> 修饰语法。
<sup>[<a href="#while-as-a-modifier">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">while</span> some_condition
  do_something
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
do_something <span class="pl-k">while</span> some_condition</pre></div></li>
<li><p><a name="user-content-until-for-negatives"></a>
对于否定条件，倾向使用 <code>until</code> 而不是 <code>while</code>。
<sup>[<a href="#until-for-negatives">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
do_something <span class="pl-k">while</span> <span class="pl-k">!</span>some_condition

<span class="pl-c"># 好</span>
do_something <span class="pl-k">until</span> some_condition</pre></div></li>
<li><p><a name="user-content-infinite-loop"></a>
对于无限循环，使用 <code>Kernel#loop</code> 而不是 <code>while/until</code>。
<sup>[<a href="#infinite-loop">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">while</span> <span class="pl-c1">true</span>
  do_something
<span class="pl-k">end</span>

<span class="pl-k">until</span> <span class="pl-c1">false</span>
  do_something
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">loop</span> <span class="pl-k">do</span>
  do_something
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-loop-with-break"></a>
对于后置条件循环语句，倾向使用 <code>Kernel#loop</code> 与 <code>break</code> 的组合，而不是 <code>begin/end/until</code> 或 <code>begin/end/while</code>。
<sup>[<a href="#loop-with-break">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">begin</span>
  puts val
  val <span class="pl-k">+=</span> <span class="pl-c1">1</span>
<span class="pl-k">end</span> <span class="pl-k">while</span> val <span class="pl-k">&lt;</span> <span class="pl-c1">0</span>

<span class="pl-c"># 好</span>
<span class="pl-k">loop</span> <span class="pl-k">do</span>
  puts val
  val <span class="pl-k">+=</span> <span class="pl-c1">1</span>
  <span class="pl-k">break</span> <span class="pl-k">unless</span> val <span class="pl-k">&lt;</span> <span class="pl-c1">0</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-dsl-parens"></a>
对于 DSL 的内部方法（比如 Rake、Rails、RSpec）、具有“关键字”特性的内部方法（比如 <code>attr_reader</code>、<code>puts</code>）、以及属性存取方法，省略这些方法外围的括号。所有其他的方法调用则使用括号。
<sup>[<a href="#no-dsl-parens">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Person</span>
  <span class="pl-k">attr_reader</span>(<span class="pl-c1">:name</span>, <span class="pl-c1">:age</span>)  <span class="pl-c"># 差</span>
  <span class="pl-k">attr_reader</span> <span class="pl-c1">:name</span>, <span class="pl-c1">:age</span>   <span class="pl-c"># 好</span>

  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span>

temperance <span class="pl-k">=</span> <span class="pl-c1">Person</span>.<span class="pl-k">new</span> <span class="pl-s"><span class="pl-pds">'</span>Temperance<span class="pl-pds">'</span></span>, <span class="pl-c1">30</span>  <span class="pl-c"># 差</span>
temperance <span class="pl-k">=</span> <span class="pl-c1">Person</span>.<span class="pl-k">new</span>(<span class="pl-s"><span class="pl-pds">'</span>Temperance<span class="pl-pds">'</span></span>, <span class="pl-c1">30</span>) <span class="pl-c"># 好</span>

puts(temperance.age)  <span class="pl-c"># 差</span>
puts temperance.age   <span class="pl-c"># 好</span>

x <span class="pl-k">=</span> <span class="pl-c1">Math</span>.sin y  <span class="pl-c"># 差</span>
x <span class="pl-k">=</span> <span class="pl-c1">Math</span>.sin(y) <span class="pl-c"># 好</span>

array.delete e  <span class="pl-c"># 差</span>
array.delete(e) <span class="pl-c"># 好</span>

expect(bowling.score).to eq <span class="pl-c1">0</span>   <span class="pl-c"># 差</span>
expect(bowling.score).to eq(<span class="pl-c1">0</span>)  <span class="pl-c"># 好</span></pre></div></li>
<li><p><a name="user-content-no-braces-opts-hash"></a>
对于可选参数的哈希，省略其外围的花括号。
<sup>[<a href="#no-braces-opts-hash">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
user.set({ <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>John<span class="pl-pds">'</span></span>, <span class="pl-c1">age:</span> <span class="pl-c1">45</span>, <span class="pl-c1">permissions:</span> { <span class="pl-c1">read:</span> <span class="pl-c1">true</span> } })

<span class="pl-c"># 好</span>
user.set(<span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>John<span class="pl-pds">'</span></span>, <span class="pl-c1">age:</span> <span class="pl-c1">45</span>, <span class="pl-c1">permissions:</span> { <span class="pl-c1">read:</span> <span class="pl-c1">true</span> })</pre></div></li>
<li><p><a name="user-content-no-dsl-decorating"></a>
对于 DSL 的内部方法调用，同时省略其外围的圆括号与花括号。
<sup>[<a href="#no-dsl-decorating">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Person<span class="pl-e"> &lt; ActiveRecord::Base</span></span>
  <span class="pl-c"># 差</span>
  validates(<span class="pl-c1">:name</span>, { <span class="pl-c1">presence:</span> <span class="pl-c1">true</span>, <span class="pl-c1">length:</span> { <span class="pl-c1">within:</span> <span class="pl-c1">1</span>..<span class="pl-c1">10</span> } })

  <span class="pl-c"># 好</span>
  validates <span class="pl-c1">:name</span>, <span class="pl-c1">presence:</span> <span class="pl-c1">true</span>, <span class="pl-c1">length:</span> { <span class="pl-c1">within:</span> <span class="pl-c1">1</span>..<span class="pl-c1">10</span> }
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-args-no-parens"></a>
无参调用方法时，省略括号。
<sup>[<a href="#no-args-no-parens">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-c1">Kernel</span>.exit!()
<span class="pl-c1">2</span>.even?()
fork()
<span class="pl-s"><span class="pl-pds">'</span>test<span class="pl-pds">'</span></span>.upcase()

<span class="pl-c"># 好</span>
<span class="pl-c1">Kernel</span>.exit!
<span class="pl-c1">2</span>.even?
fork
<span class="pl-s"><span class="pl-pds">'</span>test<span class="pl-pds">'</span></span>.upcase</pre></div></li>
<li><p><a name="user-content-single-action-blocks"></a>
当被调用方法是当前区块中唯一操作时，倾向使用简短的传参语法。
<sup>[<a href="#single-action-blocks">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
names.map { |<span class="pl-smi">name</span>| name.upcase }

<span class="pl-c"># 好</span>
names.map(<span class="pl-k">&amp;</span><span class="pl-c1">:upcase</span>)</pre></div></li>
<li><p><a name="user-content-single-line-blocks"></a>
对于单行主体，倾向使用 <code>{...}</code> 而不是 <code>do...end</code>。对于多行主体，避免使用 <code>{...}</code>。对于“流程控制”或“方法定义”（比如 Rakefile、其他 DSL 构成片段），总是使用 <code>do...end</code>。避免在链式方法调用中使用 <code>do...end</code>。
<sup>[<a href="#single-line-blocks">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>names <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">%w(</span>Bozhidar Steve Sarah<span class="pl-pds">)</span></span>

<span class="pl-c"># 差</span>
names.each <span class="pl-k">do </span>|<span class="pl-smi">name</span>|
  puts name
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
names.each { |<span class="pl-smi">name</span>| puts name }

<span class="pl-c"># 差</span>
names.select <span class="pl-k">do </span>|<span class="pl-smi">name</span>|
  name.start_with?(<span class="pl-s"><span class="pl-pds">'</span>S<span class="pl-pds">'</span></span>)
<span class="pl-k">end</span>.map { |<span class="pl-smi">name</span>| name.upcase }

<span class="pl-c"># 好</span>
names.select { |<span class="pl-smi">name</span>| name.start_with?(<span class="pl-s"><span class="pl-pds">'</span>S<span class="pl-pds">'</span></span>) }.map(<span class="pl-k">&amp;</span><span class="pl-c1">:upcase</span>)</pre></div>

<p>某些人可能会争论在多行链式方法调用时使用 <code>{...}</code> 看起来还可以。但他们应该扪心自问——这样的代码真的可读吗？难道不能把区块内容提取出来放到小巧的方法里吗？</p></li>
<li><p><a name="user-content-block-argument"></a>
优先考虑使用显式区块参数，以避免某些情况下通过创建区块的手法来传递参数给其他区块。此规则对性能有所影响，因为区块会被转换为 <code>Proc</code> 对象。
<sup>[<a href="#block-argument">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>tempfile<span class="pl-pds">'</span></span>

<span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">with_tmp_dir</span>
  <span class="pl-c1">Dir</span>.mktmpdir <span class="pl-k">do </span>|<span class="pl-smi">tmp_dir</span>|
    <span class="pl-c1">Dir</span>.chdir(tmp_dir) { |<span class="pl-smi">dir</span>| <span class="pl-k">yield</span> dir }  <span class="pl-c"># 通过创建区块的手法来传递参数</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">with_tmp_dir</span>(<span class="pl-k">&amp;</span><span class="pl-smi">block</span>)
  <span class="pl-c1">Dir</span>.mktmpdir <span class="pl-k">do </span>|<span class="pl-smi">tmp_dir</span>|
    <span class="pl-c1">Dir</span>.chdir(tmp_dir, <span class="pl-k">&amp;</span>block)
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

with_tmp_dir <span class="pl-k">do </span>|<span class="pl-smi">dir</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>dir is accessible as a parameter and pwd is set: <span class="pl-pse">#{</span><span class="pl-s1">dir</span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-explicit-return"></a>
避免在不需要流程控制的情况下使用 <code>return</code>。
<sup>[<a href="#no-explicit-return">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">some_method</span>(<span class="pl-smi">some_arr</span>)
  <span class="pl-k">return</span> some_arr.size
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">some_method</span>(<span class="pl-smi">some_arr</span>)
  some_arr.size
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-self-unless-required"></a>
避免在不需要的情况下使用 <code>self</code>。（只有在调用 <code>self</code> 的修改器时才需要）
<sup>[<a href="#no-self-unless-required">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">ready?</span>
  <span class="pl-k">if</span> <span class="pl-v">self</span>.last_reviewed_at <span class="pl-k">&gt;</span> <span class="pl-v">self</span>.last_updated_at
    <span class="pl-v">self</span>.worker.update(<span class="pl-v">self</span>.content, <span class="pl-v">self</span>.options)
    <span class="pl-v">self</span>.status <span class="pl-k">=</span> <span class="pl-c1">:in_progress</span>
  <span class="pl-k">end</span>
  <span class="pl-v">self</span>.status <span class="pl-k">==</span> <span class="pl-c1">:verified</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">ready?</span>
  <span class="pl-k">if</span> last_reviewed_at <span class="pl-k">&gt;</span> last_updated_at
    worker.update(content, options)
    <span class="pl-v">self</span>.status <span class="pl-k">=</span> <span class="pl-c1">:in_progress</span>
  <span class="pl-k">end</span>
  status <span class="pl-k">==</span> <span class="pl-c1">:verified</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-shadowing"></a>
避免局部变量遮蔽方法调用，除非它们具有相同效果。
<sup>[<a href="#no-shadowing">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Foo</span>
  <span class="pl-k">attr_accessor</span> <span class="pl-c1">:options</span>

  <span class="pl-c"># 勉强可以</span>
  <span class="pl-k">def</span> <span class="pl-en">initialize</span>(<span class="pl-smi">options</span>)
    <span class="pl-v">self</span>.options <span class="pl-k">=</span> options
    <span class="pl-c"># 此处 self.options 与 options 具有相同效果</span>
  <span class="pl-k">end</span>

  <span class="pl-c"># 差</span>
  <span class="pl-k">def</span> <span class="pl-en">do_something</span>(<span class="pl-smi">options</span> <span class="pl-k">=</span> {})
    <span class="pl-k">unless</span> options[<span class="pl-c1">:when</span>] <span class="pl-k">==</span> <span class="pl-c1">:later</span>
      output(<span class="pl-v">self</span>.options[<span class="pl-c1">:message</span>])
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>

  <span class="pl-c"># 好</span>
  <span class="pl-k">def</span> <span class="pl-en">do_something</span>(<span class="pl-smi">params</span> <span class="pl-k">=</span> {})
    <span class="pl-k">unless</span> params[<span class="pl-c1">:when</span>] <span class="pl-k">==</span> <span class="pl-c1">:later</span>
      output(options[<span class="pl-c1">:message</span>])
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-safe-assignment-in-condition"></a>
不要在条件表达式中使用 <code>=</code>（赋值语句）的返回值，除非赋值语句包裹在括号之中。这种惯用法被称作<strong>条件表达式中的安全赋值</strong>。
<sup>[<a href="#safe-assignment-in-condition">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 会出现警告</span>
<span class="pl-k">if</span> v <span class="pl-k">=</span> array.grep(<span class="pl-sr"><span class="pl-pds">/</span>foo<span class="pl-pds">/</span></span>)
  do_something(v)
  ...
<span class="pl-k">end</span>

<span class="pl-c"># 好 - 尽管 Ruby 解释器仍会出现警告，但 RuboCop 不会</span>
<span class="pl-k">if</span> (v <span class="pl-k">=</span> array.grep(<span class="pl-sr"><span class="pl-pds">/</span>foo<span class="pl-pds">/</span></span>))
  do_something(v)
  ...
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
v <span class="pl-k">=</span> array.grep(<span class="pl-sr"><span class="pl-pds">/</span>foo<span class="pl-pds">/</span></span>)
<span class="pl-k">if</span> v
  do_something(v)
  ...
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-self-assignment"></a>
优先考虑简短的自我赋值语法。
<sup>[<a href="#self-assignment">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
x <span class="pl-k">=</span> x <span class="pl-k">+</span> y
x <span class="pl-k">=</span> x <span class="pl-k">*</span> y
x <span class="pl-k">=</span> x<span class="pl-k">**</span>y
x <span class="pl-k">=</span> x <span class="pl-k">/</span> y
x <span class="pl-k">=</span> x <span class="pl-k">||</span> y
x <span class="pl-k">=</span> x <span class="pl-k">&amp;&amp;</span> y

<span class="pl-c"># 好</span>
x <span class="pl-k">+=</span> y
x <span class="pl-k">*=</span> y
x <span class="pl-k">**=</span> y
x <span class="pl-k">/=</span> y
x <span class="pl-k">||=</span> y
x <span class="pl-k">&amp;&amp;</span><span class="pl-k">=</span> y</pre></div></li>
<li><p><a name="user-content-double-pipe-for-uninit"></a>
当变量尚未初始化时，使用 <code>||=</code> 对其进行初始化。
<sup>[<a href="#double-pipe-for-uninit">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
name <span class="pl-k">=</span> name <span class="pl-k">?</span> name : <span class="pl-s"><span class="pl-pds">'</span>Bozhidar<span class="pl-pds">'</span></span>

<span class="pl-c"># 差</span>
name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Bozhidar<span class="pl-pds">'</span></span> <span class="pl-k">unless</span> name

<span class="pl-c"># 好 - 当且仅当 name 为 nil 或 false 时，设置 name 的值为 'Bozhidar'</span>
name <span class="pl-k">||=</span> <span class="pl-s"><span class="pl-pds">'</span>Bozhidar<span class="pl-pds">'</span></span></pre></div></li>
<li><p><a name="user-content-no-double-pipes-for-bools"></a>
不要使用 <code>||=</code> 对布尔变量进行初始化。
<sup>[<a href="#no-double-pipes-for-bools">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 设置 enabled 的值为 true，即使其原本的值是 false</span>
enabled <span class="pl-k">||=</span> <span class="pl-c1">true</span>

<span class="pl-c"># 好</span>
enabled <span class="pl-k">=</span> <span class="pl-c1">true</span> <span class="pl-k">if</span> enabled.nil?</pre></div></li>
<li><p><a name="user-content-double-amper-preprocess"></a>
使用 <code>&amp;&amp;=</code> 预先检查变量是否存在，如果存在，则做相应动作。使用 <code>&amp;&amp;=</code> 语法可以省去 <code>if</code> 检查。
<sup>[<a href="#double-amper-preprocess">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">if</span> something
  something <span class="pl-k">=</span> something.downcase
<span class="pl-k">end</span>

<span class="pl-c"># 差</span>
something <span class="pl-k">=</span> something <span class="pl-k">?</span> something.downcase : <span class="pl-c1">nil</span>

<span class="pl-c"># 勉强可以</span>
something <span class="pl-k">=</span> something.downcase <span class="pl-k">if</span> something

<span class="pl-c"># 好</span>
something <span class="pl-k">=</span> something <span class="pl-k">&amp;&amp;</span> something.downcase

<span class="pl-c"># 更好</span>
something <span class="pl-k">&amp;&amp;</span><span class="pl-k">=</span> something.downcase</pre></div></li>
<li><p><a name="user-content-no-case-equality"></a>
避免使用 <code>case</code> 语句等价操作符 <code>===</code>。从名称可知，这是 <code>case</code> 语句隐式使用的操作符，在 <code>case</code> 语句外的场合中使用，会产生难以理解的代码。
<sup>[<a href="#no-case-equality">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-c1">Array</span> <span class="pl-k">===</span> something
(<span class="pl-c1">1</span>..<span class="pl-c1">100</span>) <span class="pl-k">===</span> <span class="pl-c1">7</span>
<span class="pl-sr"><span class="pl-pds">/</span>something<span class="pl-pds">/</span></span> <span class="pl-k">===</span> some_string

<span class="pl-c"># 好</span>
something.is_a?(<span class="pl-c1">Array</span>)
(<span class="pl-c1">1</span>..<span class="pl-c1">100</span>).include?(<span class="pl-c1">7</span>)
some_string <span class="pl-k">=~</span> <span class="pl-sr"><span class="pl-pds">/</span>something<span class="pl-pds">/</span></span></pre></div></li>
<li><p><a name="user-content-eql"></a>
能使用 <code>==</code> 就不要使用 <code>eql?</code>。提供更加严格比较的 <code>eql?</code> 在实践中极少使用。
<sup>[<a href="#eql">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 对于字符串，eql? 与 == 具有相同效果</span>
<span class="pl-s"><span class="pl-pds">'</span>ruby<span class="pl-pds">'</span></span>.eql? some_str

<span class="pl-c"># 好</span>
<span class="pl-s"><span class="pl-pds">'</span>ruby<span class="pl-pds">'</span></span> <span class="pl-k">==</span> some_str
<span class="pl-c1">1.0</span>.eql? x <span class="pl-c"># 当需要区别 Fixnum 1 与 Float 1.0 时，eql? 是具有意义的</span></pre></div></li>
<li><p><a name="user-content-no-cryptic-perlisms"></a>
避免使用 Perl 风格的特殊变量（比如 <code>$:</code>、<code>$;</code> 等）。它们看起来非常神秘，但除了单行脚本，其他情况并不鼓励使用。建议使用 <code>English</code> 程序库提供的友好别名。
<sup>[<a href="#no-cryptic-perlisms">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-smi">$:</span>.unshift <span class="pl-c1">File</span>.dirname(<span class="pl-v">__FILE__</span>)

<span class="pl-c"># 好</span>
<span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>English<span class="pl-pds">'</span></span>
<span class="pl-smi">$LOAD_PATH</span>.unshift <span class="pl-c1">File</span>.dirname(<span class="pl-v">__FILE__</span>)</pre></div></li>
<li><p><a name="user-content-parens-no-spaces"></a>
永远不要在方法名与左括号之间添加空格。
<sup>[<a href="#parens-no-spaces">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
f (<span class="pl-c1">3</span> <span class="pl-k">+</span> <span class="pl-c1">2</span>) <span class="pl-k">+</span> <span class="pl-c1">1</span>

<span class="pl-c"># 好</span>
f(<span class="pl-c1">3</span> <span class="pl-k">+</span> <span class="pl-c1">2</span>) <span class="pl-k">+</span> <span class="pl-c1">1</span></pre></div></li>
<li><p><a name="user-content-parens-as-args"></a>
如果方法调用的第一个参数以左括号开头，则此方法调用应该使用括号，比如 <code>f((3 + 2) + 1)</code>。
<sup>[<a href="#parens-as-args">link</a>]</sup></p></li>
<li><p><a name="user-content-always-warn-at-runtime"></a>
运行 Ruby 解释器时，总是开启 <code>-w</code> 选项来。如果你忘了某个上述某个规则，它就会警告你！
<sup>[<a href="#always-warn-at-runtime">link</a>]</sup></p></li>
<li><p><a name="user-content-no-nested-methods"></a>
不要在方法中嵌套定义方法，使用 lambda 方法来替代。 嵌套定义产生的方法，事实上和外围方法处于同一作用域（比如类作用域）。此外，“嵌套方法”会在定义它的外围方法每次调用时被重新定义。
<sup>[<a href="#no-nested-methods">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">foo</span>(<span class="pl-smi">x</span>)
  <span class="pl-k">def</span> <span class="pl-en">bar</span>(<span class="pl-smi">y</span>)
    <span class="pl-c"># 省略主体</span>
  <span class="pl-k">end</span>

  bar(x)
<span class="pl-k">end</span>

<span class="pl-c"># 好 - 作用同前，但 bar 不会在 foo 每次调用时被重新定义</span>
<span class="pl-k">def</span> <span class="pl-en">bar</span>(<span class="pl-smi">y</span>)
  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span>

<span class="pl-k">def</span> <span class="pl-en">foo</span>(<span class="pl-smi">x</span>)
  bar(x)
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">foo</span>(<span class="pl-smi">x</span>)
  bar <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span>(y) { ... }
  bar.call(x)
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-lambda-multi-line"></a>
对于单行区块，使用新的 lambda 字面量定义语法。对于多行区块，使用 <code>lambda</code> 定义语法。
<sup>[<a href="#lambda-multi-line">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
l <span class="pl-k">=</span> lambda { |<span class="pl-smi">a</span>, <span class="pl-smi">b</span>| a <span class="pl-k">+</span> b }
l.call(<span class="pl-c1">1</span>, <span class="pl-c1">2</span>)

<span class="pl-c"># 好 - 但看起来怪怪的</span>
l <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span>(a, b) <span class="pl-k">do</span>
  tmp <span class="pl-k">=</span> a <span class="pl-k">*</span> <span class="pl-c1">7</span>
  tmp <span class="pl-k">*</span> b <span class="pl-k">/</span> <span class="pl-c1">50</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
l <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span>(a, b) { a <span class="pl-k">+</span> b }
l.call(<span class="pl-c1">1</span>, <span class="pl-c1">2</span>)

l <span class="pl-k">=</span> lambda <span class="pl-k">do </span>|<span class="pl-smi">a</span>, <span class="pl-smi">b</span>|
  tmp <span class="pl-k">=</span> a <span class="pl-k">*</span> <span class="pl-c1">7</span>
  tmp <span class="pl-k">*</span> b <span class="pl-k">/</span> <span class="pl-c1">50</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-stabby-lambda-with-args"></a>
定义 lambda 方法时，如果有参数则使用括号。
<sup>[<a href="#stabby-lambda-with-args">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
l <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span>x, y { something(x, y) }

<span class="pl-c"># 好</span>
l <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span>(x, y) { something(x, y) }</pre></div></li>
<li><p><a name="user-content-stabby-lambda-no-args"></a>
定义 lambda 方法时，如果无参数则省略括号。
<sup>[<a href="#stabby-lambda-no-args">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
l <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span>() { something }

<span class="pl-c"># 好</span>
l <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> { something }</pre></div></li>
<li><p><a name="user-content-proc"></a>
倾向使用 <code>proc</code> 而不是 <code>Proc.new</code>。
<sup>[<a href="#proc">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
p <span class="pl-k">=</span> <span class="pl-c1">Proc</span>.<span class="pl-k">new</span> { |<span class="pl-smi">n</span>| puts n }

<span class="pl-c"># 好</span>
p <span class="pl-k">=</span> proc { |<span class="pl-smi">n</span>| puts n }</pre></div></li>
<li><p><a name="user-content-proc-call"></a>
对于 lambda 方法或代码块，倾向使用 <code>proc.call()</code> 而不是 <code>proc[]</code> 或 <code>proc.()</code>。
<sup>[<a href="#proc-call">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 看上去像是枚举器的存取操作</span>
l <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span>(v) { puts v }
l[<span class="pl-c1">1</span>]

<span class="pl-c"># 差 - 极少见的调用语法</span>
l <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span>(v) { puts v }
l.(<span class="pl-c1">1</span>)

<span class="pl-c"># 好</span>
l <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span>(v) { puts v }
l.call(<span class="pl-c1">1</span>)</pre></div></li>
<li><p><a name="user-content-underscore-unused-vars"></a>
未被使用的区块参数或局部变量，添加 <code>_</code> 前缀或直接使用 <code>_</code>（尽管表意性略差）。这种做法可以抑制 Ruby 解释器或 RuboCop 等工具发出“变量尚未使用”的警告。
<sup>[<a href="#underscore-unused-vars">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
result <span class="pl-k">=</span> hash.map { |<span class="pl-smi">k</span>, <span class="pl-smi">v</span>| v <span class="pl-k">+</span> <span class="pl-c1">1</span> }

<span class="pl-k">def</span> <span class="pl-en">something</span>(<span class="pl-smi">x</span>)
  unused_var, used_var <span class="pl-k">=</span> something_else(x)
  <span class="pl-c"># ...</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
result <span class="pl-k">=</span> hash.map { |<span class="pl-smi">_k</span>, <span class="pl-smi">v</span>| v <span class="pl-k">+</span> <span class="pl-c1">1</span> }

<span class="pl-k">def</span> <span class="pl-en">something</span>(<span class="pl-smi">x</span>)
  _unused_var, used_var <span class="pl-k">=</span> something_else(x)
  <span class="pl-c"># ...</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
result <span class="pl-k">=</span> hash.map { |<span class="pl-smi">_</span>, <span class="pl-smi">v</span>| v <span class="pl-k">+</span> <span class="pl-c1">1</span> }

<span class="pl-k">def</span> <span class="pl-en">something</span>(<span class="pl-smi">x</span>)
  _, used_var <span class="pl-k">=</span> something_else(x)
  <span class="pl-c"># ...</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-global-stdout"></a>
使用 <code>$stdout/$stderr/$stdin</code> 而不是 <code>STDOUT/STDERR/STDIN</code>。<code>STDOUT/STDERR/STDIN</code> 是常量，尽管在 Ruby 中允许给常量重新赋值（可能是重定向某些流），但解释器会发出警告。
<sup>[<a href="#global-stdout">link</a>]</sup></p></li>
<li><p><a name="user-content-warn"></a>
使用 <code>warn</code> 而不是 <code>$stderr.puts</code>。除了更加简练清晰外，<code>warn</code> 允许你在需要时通过设置解释器选项（使用 <code>-W0</code> 将警告级别设置为 0）来抑制警告。
<sup>[<a href="#warn">link</a>]</sup></p></li>
<li><p><a name="user-content-sprintf"></a>
倾向使用 <code>sprintf</code> 或其别名 <code>format</code> 而不是相当晦涩的 <code>String#%</code> 方法。
<sup>[<a href="#sprintf">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-s"><span class="pl-pds">'</span>%d %d<span class="pl-pds">'</span></span> <span class="pl-k">%</span> [<span class="pl-c1">20</span>, <span class="pl-c1">10</span>]
<span class="pl-c"># =&gt; '20 10'</span>

<span class="pl-c"># 好</span>
sprintf(<span class="pl-s"><span class="pl-pds">'</span>%d %d<span class="pl-pds">'</span></span>, <span class="pl-c1">20</span>, <span class="pl-c1">10</span>)
<span class="pl-c"># =&gt; '20 10'</span>

<span class="pl-c"># 好</span>
sprintf(<span class="pl-s"><span class="pl-pds">'</span>%{first} %{second}<span class="pl-pds">'</span></span>, <span class="pl-c1">first:</span> <span class="pl-c1">20</span>, <span class="pl-c1">second:</span> <span class="pl-c1">10</span>)
<span class="pl-c"># =&gt; '20 10'</span>

format(<span class="pl-s"><span class="pl-pds">'</span>%d %d<span class="pl-pds">'</span></span>, <span class="pl-c1">20</span>, <span class="pl-c1">10</span>)
<span class="pl-c"># =&gt; '20 10'</span>

<span class="pl-c"># 好</span>
format(<span class="pl-s"><span class="pl-pds">'</span>%{first} %{second}<span class="pl-pds">'</span></span>, <span class="pl-c1">first:</span> <span class="pl-c1">20</span>, <span class="pl-c1">second:</span> <span class="pl-c1">10</span>)
<span class="pl-c"># =&gt; '20 10'</span></pre></div></li>
<li><p><a name="user-content-array-join"></a>
倾向使用 <code>Array#join</code> 而不是相当晦涩的带字符参数的 <code>Array#*</code> 方法。
<sup>[<a href="#array-join">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-s"><span class="pl-pds">%w(</span>one two three<span class="pl-pds">)</span></span> <span class="pl-k">*</span> <span class="pl-s"><span class="pl-pds">'</span>, <span class="pl-pds">'</span></span>
<span class="pl-c"># =&gt; 'one, two, three'</span>

<span class="pl-c"># 好</span>
<span class="pl-s"><span class="pl-pds">%w(</span>one two three<span class="pl-pds">)</span></span>.join(<span class="pl-s"><span class="pl-pds">'</span>, <span class="pl-pds">'</span></span>)
<span class="pl-c"># =&gt; 'one, two, three'</span></pre></div></li>
<li><p><a name="user-content-splat-arrays"></a>
当你希望处理的变量类型是数组，但不太确定其是否真的是数组时，通过使用 <code>[*var]</code> 或 <code>Array()</code> 来替代显式的数组类型检查与转换。
<sup>[<a href="#splat-arrays">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
paths <span class="pl-k">=</span> [paths] <span class="pl-k">unless</span> paths.is_a? <span class="pl-c1">Array</span>
paths.each { |<span class="pl-smi">path</span>| do_something(path) }

<span class="pl-c"># 好</span>
[<span class="pl-k">*</span>paths].each { |<span class="pl-smi">path</span>| do_something(path) }

<span class="pl-c"># 好 - 并且更具可读性</span>
<span class="pl-c1">Array</span>(paths).each { |<span class="pl-smi">path</span>| do_something(path) }</pre></div></li>
<li><p><a name="user-content-ranges-or-between"></a>
通过使用范围或 <code>Comparable#between?</code> 来替代复杂的比较逻辑。
<sup>[<a href="#ranges-or-between">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
do_something <span class="pl-k">if</span> x <span class="pl-k">&gt;=</span> <span class="pl-c1">1000</span> <span class="pl-k">&amp;&amp;</span> x <span class="pl-k">&lt;=</span> <span class="pl-c1">2000</span>

<span class="pl-c"># 好</span>
do_something <span class="pl-k">if</span> (<span class="pl-c1">1000</span>..<span class="pl-c1">2000</span>).include?(x)

<span class="pl-c"># 好</span>
do_something <span class="pl-k">if</span> x.between?(<span class="pl-c1">1000</span>, <span class="pl-c1">2000</span>)</pre></div></li>
<li><p><a name="user-content-predicate-methods"></a>
倾向使用谓词方法而不是 <code>==</code> 操作符。但数值比较除外。
<sup>[<a href="#predicate-methods">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">if</span> x <span class="pl-k">%</span> <span class="pl-c1">2</span> <span class="pl-k">==</span> <span class="pl-c1">0</span>
<span class="pl-k">end</span>

<span class="pl-k">if</span> x <span class="pl-k">%</span> <span class="pl-c1">2</span> <span class="pl-k">==</span> <span class="pl-c1">1</span>
<span class="pl-k">end</span>

<span class="pl-k">if</span> x <span class="pl-k">==</span> <span class="pl-c1">nil</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">if</span> x.even?
<span class="pl-k">end</span>

<span class="pl-k">if</span> x.odd?
<span class="pl-k">end</span>

<span class="pl-k">if</span> x.nil?
<span class="pl-k">end</span>

<span class="pl-k">if</span> x.zero?
<span class="pl-k">end</span>

<span class="pl-k">if</span> x <span class="pl-k">==</span> <span class="pl-c1">0</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-non-nil-checks"></a>
不做显式的 <code>non-nil</code> 检查，除非检查对象是布尔变量。
<sup>[<a href="#no-non-nil-checks">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
do_something <span class="pl-k">if</span> <span class="pl-k">!</span>something.nil?
do_something <span class="pl-k">if</span> something <span class="pl-k">!=</span> <span class="pl-c1">nil</span>

<span class="pl-c"># 好</span>
do_something <span class="pl-k">if</span> something

<span class="pl-c"># 好 - 检查对象是布尔变量</span>
<span class="pl-k">def</span> <span class="pl-en">value_set?</span>
  <span class="pl-k">!</span><span class="pl-smi">@some_boolean</span>.nil?
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-BEGIN-blocks"></a>
避免使用 <code>BEGIN</code> 区块。
<sup>[<a href="#no-BEGIN-blocks">link</a>]</sup></p></li>
<li><p><a name="user-content-no-END-blocks"></a>
永远不要使用 <code>END</code> 区块。使用 <code>Kernel#at_exit</code> 来替代。
<sup>[<a href="#no-END-blocks">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">END</span> { puts <span class="pl-s"><span class="pl-pds">'</span>Goodbye!<span class="pl-pds">'</span></span> }

<span class="pl-c"># 好</span>
at_exit { puts <span class="pl-s"><span class="pl-pds">'</span>Goodbye!<span class="pl-pds">'</span></span> }</pre></div></li>
<li><p><a name="user-content-no-flip-flops"></a>
避免使用 flip-flops 操作符。
<sup>[<a href="#no-flip-flops">link</a>]</sup></p></li>
<li><p><a name="user-content-no-nested-conditionals"></a>
流程控制中，避免使用嵌套条件。
<sup>[<a href="#no-nested-conditionals">link</a>]</sup></p>

<p>倾向使用防御从句进行非法数据断言。防御从句是指处于方法顶部的条件语句，其能尽早地退出方法。</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">compute_thing</span>(<span class="pl-smi">thing</span>)
  <span class="pl-k">if</span> thing[<span class="pl-c1">:foo</span>]
    update_with_bar(thing)
    <span class="pl-k">if</span> thing[<span class="pl-c1">:foo</span>][<span class="pl-c1">:bar</span>]
      partial_compute(thing)
    <span class="pl-k">else</span>
      re_compute(thing)
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">compute_thing</span>(<span class="pl-smi">thing</span>)
  <span class="pl-k">return</span> <span class="pl-k">unless</span> thing[<span class="pl-c1">:foo</span>]
  update_with_bar(thing[<span class="pl-c1">:foo</span>])
  <span class="pl-k">return</span> re_compute(thing) <span class="pl-k">unless</span> thing[<span class="pl-c1">:foo</span>][<span class="pl-c1">:bar</span>]
  partial_compute(thing)
<span class="pl-k">end</span></pre></div>

<p>循环中，倾向使用 <code>next</code> 而不是条件区块。</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
[<span class="pl-c1">0</span>, <span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>].each <span class="pl-k">do </span>|<span class="pl-smi">item</span>|
  <span class="pl-k">if</span> item <span class="pl-k">&gt;</span> <span class="pl-c1">1</span>
    puts item
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
[<span class="pl-c1">0</span>, <span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>].each <span class="pl-k">do </span>|<span class="pl-smi">item</span>|
  <span class="pl-k">next</span> <span class="pl-k">unless</span> item <span class="pl-k">&gt;</span> <span class="pl-c1">1</span>
  puts item
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-map-find-select-reduce-size"></a>
倾向使用 <code>map</code> 而不是 <code>collect</code>，<code>find</code> 而不是 <code>detect</code>，<code>select</code> 而不是 <code>find_all</code>，<code>reduce</code> 而不是 <code>inject</code> 以及 <code>size</code> 而不是 <code>length</code>。这不是一个硬性要求，如果使用别名可以增强可读性，使用它也没关系。这些别名方法继承自 Smalltalk 语言，但在别的语言并不通用。鼓励使用 <code>select</code> 而不是 <code>find_all</code> 的理由是前者与 <code>reject</code> 搭配起来一目了然。
<sup>[<a href="#map-find-select-reduce-size">link</a>]</sup></p></li>
<li><p><a name="user-content-count-vs-size"></a>
不要使用 <code>count</code> 作为 <code>size</code> 的替代方案。除了 <code>Array</code> 外，其他 <code>Enumerable</code> 对象都需要通过枚举整个集合才可以确定数目。
<sup>[<a href="#count-vs-size">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
some_hash.count

<span class="pl-c"># 好</span>
some_hash.size</pre></div></li>
<li><p><a name="user-content-flat-map"></a>
倾向使用 <code>flat_map</code> 而不是 <code>map + flatten</code> 的组合。此规则并不适用于深度超过 2 层的数组。举例来说，如果 <code>users.first.songs == ['a', ['b','c']]</code> 成立，则使用 <code>map + flatten</code> 的组合而不是 <code>flat_map</code>。<code>flat_map</code> 只能平坦化一个层级，而 <code>flatten</code> 能够平坦化任意多个层级。
<sup>[<a href="#flat-map">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
all_songs <span class="pl-k">=</span> users.map(<span class="pl-k">&amp;</span><span class="pl-c1">:songs</span>).flatten.uniq

<span class="pl-c"># 好</span>
all_songs <span class="pl-k">=</span> users.flat_map(<span class="pl-k">&amp;</span><span class="pl-c1">:songs</span>).uniq</pre></div></li>
<li><p><a name="user-content-reverse-each"></a>
倾向使用 <code>reverse_each</code> 而不是 <code>reverse.each</code>，因为某些混入 <code>Enumerable</code> 模块的类可能会提供 <code>reverse_each</code> 的高效版本。即使这些类没有提供专门特化的版本，继承自 <code>Enumerable</code> 的通用版本至少能保证性能与 <code>reverse.each</code> 相当。
<sup>[<a href="#reverse-each">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
array.reverse.each { ... }

<span class="pl-c"># 好</span>
array.reverse_each { ... }</pre></div></li>
</ul>

<h2><a id="user-content-命名" class="anchor" href="#命名" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>命名</h2>

<blockquote>
<p>程序设计的真正难题是替事物命名及使缓存失效。<br>
——Phil Karlton</p>
</blockquote>

<ul>
<li><p><a name="user-content-english-identifiers"></a>
标识符使用英文命名。
<sup>[<a href="#english-identifiers">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 标识符使用非 ASCII 字符</span>
заплата <span class="pl-k">=</span> <span class="pl-c1">1_000</span>

<span class="pl-c"># 差 - 标识符使用拉丁文写法的保加利亚单词</span>
zaplata <span class="pl-k">=</span> <span class="pl-c1">1_000</span>

<span class="pl-c"># 好</span>
salary <span class="pl-k">=</span> <span class="pl-c1">1_000</span></pre></div></li>
<li><p><a name="user-content-snake-case-symbols-methods-vars"></a>
符号、方法、变量使用蛇底式小写（<code>snake_case</code>）。
<sup>[<a href="#snake-case-symbols-methods-vars">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-c1">:'some symbol'</span>
<span class="pl-c1">:SomeSymbol</span>
<span class="pl-c1">:someSymbol</span>

someVar <span class="pl-k">=</span> <span class="pl-c1">5</span>

<span class="pl-k">def</span> <span class="pl-en">someMethod</span>
  ...
<span class="pl-k">end</span>

<span class="pl-k">def</span> <span class="pl-en">SomeMethod</span>
...
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-c1">:some_symbol</span>

<span class="pl-k">def</span> <span class="pl-en">some_method</span>
  ...
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-camelcase-classes"></a>
类与模块使用驼峰式大小写（<code>CamelCase</code>）。（HTTP、RFC、XML 等首字母缩写应该仍旧保持大写形式）
<sup>[<a href="#camelcase-classes">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">class</span> <span class="pl-en">Someclass</span>
  ...
<span class="pl-k">end</span>

<span class="pl-k">class</span> <span class="pl-en">Some_Class</span>
  ...
<span class="pl-k">end</span>

<span class="pl-k">class</span> <span class="pl-en">SomeXml</span>
  ...
<span class="pl-k">end</span>

<span class="pl-k">class</span> <span class="pl-en">XmlSomething</span>
  ...
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">class</span> <span class="pl-en">SomeClass</span>
  ...
<span class="pl-k">end</span>

<span class="pl-k">class</span> <span class="pl-en">SomeXML</span>
  ...
<span class="pl-k">end</span>

<span class="pl-k">class</span> <span class="pl-en">XMLSomething</span>
  ...
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-snake-case-files"></a>
文件名使用蛇底式小写，如 <code>hello_world.rb</code>。
<sup>[<a href="#snake-case-files">link</a>]</sup></p></li>
<li><p><a name="user-content-snake-case-dirs"></a>
目录名使用蛇底式小写，如 <code>lib/hello_world/hello_world.rb</code>。
<sup>[<a href="#snake-case-dirs">link</a>]</sup></p></li>
<li><p><a name="user-content-one-class-per-file"></a>
尽量使一个源文件中只有一个类或模块。文件名就是类名或模块名，但使用蛇底式小写而不是驼峰式大小写。
<sup>[<a href="#one-class-per-file">link</a>]</sup></p></li>
<li><p><a name="user-content-screaming-snake-case"></a>
其他常量使用尖叫蛇底式大写（SCREAMING_SNAKE_CASE）。
<sup>[<a href="#screaming-snake-case">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-c1">SomeConst</span> <span class="pl-k">=</span> <span class="pl-c1">5</span>

<span class="pl-c"># 好</span>
<span class="pl-c1">SOME_CONST</span> <span class="pl-k">=</span> <span class="pl-c1">5</span></pre></div></li>
<li><p><a name="user-content-bool-methods-qmark"></a>
谓词方法（返回布尔值的方法）的名字应当以问号结尾。（比如 <code>Array#empty?</code>）。不返回布尔值的方法不应以问号结尾。
<sup>[<a href="#bool-methods-qmark">link</a>]</sup></p></li>
<li><p><a name="user-content-dangerous-method-bang"></a>
具有潜在<strong>危险性</strong>的方法，当其存在对应安全版本的方法时，其名字应当以惊叹号结尾。（比如修改 <code>self</code> 或参数值的方法、相对 <code>exit</code> 方法不会在退出时运行 finalizers 执行清理工作的 <code>exit!</code> 方法等）
<sup>[<a href="#dangerous-method-bang">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 没有对应安全版本的方法</span>
<span class="pl-k">class</span> <span class="pl-en">Person</span>
  <span class="pl-k">def</span> <span class="pl-en">update!</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">class</span> <span class="pl-en">Person</span>
  <span class="pl-k">def</span> <span class="pl-en">update</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">class</span> <span class="pl-en">Person</span>
  <span class="pl-k">def</span> <span class="pl-en">update!</span>
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">update</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-safe-because-unsafe"></a>
尽量根据危险方法来定义对应安全版本的方法。
<sup>[<a href="#safe-because-unsafe">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Array</span>
  <span class="pl-k">def</span> <span class="pl-en">flatten_once!</span>
    res <span class="pl-k">=</span> []

    each <span class="pl-k">do </span>|<span class="pl-smi">e</span>|
      [<span class="pl-k">*</span>e].each { |<span class="pl-smi">f</span>| res <span class="pl-k">&lt;&lt;</span> f }
    <span class="pl-k">end</span>

    replace(res)
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">flatten_once</span>
    dup.flatten_once!
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-reduce-blocks"></a>
当配合单行区块使用 <code>reduce</code> 时，将参数命名为 <code>|a, e|</code>（accumulator/累加器，element/元素）。
<sup>[<a href="#reduce-blocks">link</a>]</sup></p></li>
<li><p><a name="user-content-other-arg"></a>
当定义二元操作符时，将参数命名为 <code>other</code>（<code>&lt;&lt;</code> 与 <code>[]</code> 例外，因为其语义与此不同）。
<sup>[<a href="#other-arg">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">def</span> <span class="pl-en">+</span>(<span class="pl-smi">other</span>)
  <span class="pl-c"># 省略主体</span>
<span class="pl-k">end</span></pre></div></li>
</ul>

<h2><a id="user-content-注释" class="anchor" href="#注释" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>注释</h2>

<blockquote>
<p>良好的代码自身就是最佳的文档。当你要添加一个注释时，扪心自问，“如何改善代码让它不需要注释？” 改善代码，再写相应文档使之更清楚。<br>
——Steve McConnell</p>
</blockquote>

<ul>
<li><p><a name="user-content-no-comments"></a>
编写让人一目了然的代码然后忽略这一节的其它部分。我是认真的！
<sup>[<a href="#no-comments">link</a>]</sup></p></li>
<li><p><a name="user-content-english-comments"></a>
使用英文编写注释。
<sup>[<a href="#english-comments">link</a>]</sup></p></li>
<li><p><a name="user-content-hash-space"></a>
前导 <code>#</code> 与注释文本之间应当添加一个空格。
<sup>[<a href="#hash-space">link</a>]</sup></p></li>
<li><p><a name="user-content-english-syntax"></a>
注释超过一个单词时，句首字母应当大写，并在语句停顿或结尾处使用标点符号。句号后添加<a href="http://en.wikipedia.org/wiki/Sentence_spacing">一个空格</a>。
<sup>[<a href="#english-syntax">link</a>]</sup></p></li>
<li><p><a name="user-content-no-superfluous-comments"></a>
避免无谓的注释。
<sup>[<a href="#no-superfluous-comments">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
counter <span class="pl-k">+=</span> <span class="pl-c1">1</span> <span class="pl-c"># Increments counter by one.</span></pre></div></li>
<li><p><a name="user-content-comment-upkeep"></a>
及时更新注释。过时的注释比没有注释还要糟糕。
<sup>[<a href="#comment-upkeep">link</a>]</sup></p></li>
</ul>

<blockquote>
<p>好的代码就像是好的笑话 —— 它不需要解释。<br>
——Russ Olsen</p>
</blockquote>

<ul>
<li><a name="user-content-refactor-dont-comment"></a>
避免替烂代码编写注释。重构它们使其变得一目了然。（要么做，要么不做，不要只是试试看。——Yoda）
<sup>[<a href="#refactor-dont-comment">link</a>]</sup></li>
</ul>

<h3><a id="user-content-注解" class="anchor" href="#注解" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>注解</h3>

<ul>
<li><p><a name="user-content-annotate-above"></a>
注解应该直接写在相关代码之前那行。
<sup>[<a href="#annotate-above">link</a>]</sup></p></li>
<li><p><a name="user-content-annotate-keywords"></a>
注解关键字后面，跟着一个冒号及空格，接着是描述问题的文本。
<sup>[<a href="#annotate-keywords">link</a>]</sup></p></li>
<li><p><a name="user-content-indent-annotations"></a>
如果需要用多行来描述问题，后续行要放在 <code>#</code> 后面并缩排两个空格。
<sup>[<a href="#indent-annotations">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">def</span> <span class="pl-en">bar</span>
  <span class="pl-c"># FIXME: This has crashed occasionally since v3.2.1. It may</span>
  <span class="pl-c">#   be related to the BarBazUtil upgrade.</span>
  baz(<span class="pl-c1">:quux</span>)
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-rare-eol-annotations"></a>
当问题是显而易见时，任何文档都是多余的，注解应当放在有问题的那行末尾且不带任何多余说明。这个用法应该算是例外而不是规则。
<sup>[<a href="#rare-eol-annotations">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">def</span> <span class="pl-en">bar</span>
  sleep <span class="pl-c1">100</span> <span class="pl-c"># OPTIMIZE</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-todo"></a>
使用 <code>TODO</code> 标记应当加入的特征与功能。
<sup>[<a href="#todo">link</a>]</sup></p></li>
<li><p><a name="user-content-fixme"></a>
使用 <code>FIXME</code> 标记需要修复的代码。
<sup>[<a href="#fixme">link</a>]</sup></p></li>
<li><p><a name="user-content-optimize"></a>
使用 <code>OPTIMIZE</code> 标记可能引发性能问题的低效代码。
<sup>[<a href="#optimize">link</a>]</sup></p></li>
<li><p><a name="user-content-hack"></a>
使用 <code>HACK</code> 标记代码异味，即那些应当被重构的可疑编码习惯。
<sup>[<a href="#hack">link</a>]</sup></p></li>
<li><p><a name="user-content-review"></a>
使用 <code>REVIEW</code> 标记需要确认与编码意图是否一致的可疑代码。比如，<code>REVIEW: Are we sure this is how the client does X currently?</code>。
<sup>[<a href="#review">link</a>]</sup></p></li>
<li><p><a name="user-content-document-annotations"></a>
适当情况下，可以自行定制其他注解关键字，但别忘记在项目的 <code>README</code> 或类似文档中予以说明。
<sup>[<a href="#document-annotations">link</a>]</sup></p></li>
</ul>

<h2><a id="user-content-类与模块" class="anchor" href="#类与模块" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>类与模块</h2>

<ul>
<li><p><a name="user-content-consistent-classes"></a>
在类定义中，使用一致的结构。
<sup>[<a href="#consistent-classes">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Person</span>
  <span class="pl-c"># 首先是 extend 与 include</span>
  <span class="pl-k">extend</span> <span class="pl-c1">SomeModule</span>
  <span class="pl-k">include</span> <span class="pl-c1">AnotherModule</span>

  <span class="pl-c"># 内部类</span>
  <span class="pl-c1">CustomErrorKlass</span> <span class="pl-k">=</span> <span class="pl-c1">Class</span>.<span class="pl-k">new</span>(<span class="pl-c1">StandardError</span>)

  <span class="pl-c"># 接着是常量</span>
  <span class="pl-c1">SOME_CONSTANT</span> <span class="pl-k">=</span> <span class="pl-c1">20</span>

  <span class="pl-c"># 接下来是属性宏</span>
  <span class="pl-k">attr_reader</span> <span class="pl-c1">:name</span>

  <span class="pl-c"># 跟着是其他宏（如果有的话）</span>
  validates <span class="pl-c1">:name</span>

  <span class="pl-c"># 公开的类方法接在下一行</span>
  <span class="pl-k">def</span> <span class="pl-en">self.some_method</span>
  <span class="pl-k">end</span>

  <span class="pl-c"># 初始化方法在类方法和实例方法之间</span>
  <span class="pl-k">def</span> <span class="pl-en">initialize</span>
  <span class="pl-k">end</span>

  <span class="pl-c"># 跟着是公开的实例方法</span>
  <span class="pl-k">def</span> <span class="pl-en">some_method</span>
  <span class="pl-k">end</span>

  <span class="pl-c"># 受保护及私有的方法等放在接近结尾的地方</span>
  <span class="pl-k">protected</span>

  <span class="pl-k">def</span> <span class="pl-en">some_protected_method</span>
  <span class="pl-k">end</span>

  <span class="pl-k">private</span>

  <span class="pl-k">def</span> <span class="pl-en">some_private_method</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-file-classes"></a>
如果嵌套类数目较多，进而导致外围类定义较长，则将它们从外围类中提取出来，分别放置在单独的以嵌套类命名的文件中，并将文件归类至以外围类命名的文件夹下。
<sup>[<a href="#file-classes">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>

<span class="pl-c"># foo.rb</span>
<span class="pl-k">class</span> <span class="pl-en">Foo</span>
  <span class="pl-k">class</span> <span class="pl-en">Bar</span>
    <span class="pl-c"># 定义 30 多个方法</span>
  <span class="pl-k">end</span>

  <span class="pl-k">class</span> <span class="pl-en">Car</span>
    <span class="pl-c"># 定义 20 多个方法</span>
  <span class="pl-k">end</span>

  <span class="pl-c"># 定义 30 多个方法</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>

<span class="pl-c"># foo.rb</span>
<span class="pl-k">class</span> <span class="pl-en">Foo</span>
  <span class="pl-c"># 定义 30 多个方法</span>
<span class="pl-k">end</span>

<span class="pl-c"># foo/bar.rb</span>
<span class="pl-k">class</span> <span class="pl-en">Foo</span>
  <span class="pl-k">class</span> <span class="pl-en">Bar</span>
    <span class="pl-c"># 定义 30 多个方法</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># foo/car.rb</span>
<span class="pl-k">class</span> <span class="pl-en">Foo</span>
  <span class="pl-k">class</span> <span class="pl-en">Car</span>
    <span class="pl-c"># 定义 20 多个方法</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-modules-vs-classes"></a>
定义只有类方法的数据类型时，倾向使用模块而不是类。只有当需要实例化时才使用类。
<sup>[<a href="#modules-vs-classes">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">class</span> <span class="pl-en">SomeClass</span>
  <span class="pl-k">def</span> <span class="pl-en">self.some_method</span>
    <span class="pl-c"># 省略主体</span>
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">self.some_other_method</span>
    <span class="pl-c"># 省略主体</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">module</span> <span class="pl-en">SomeModule</span>
  <span class="pl-k">module_function</span>

  <span class="pl-k">def</span> <span class="pl-en">some_method</span>
    <span class="pl-c"># 省略主体</span>
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">some_other_method</span>
    <span class="pl-c"># 省略主体</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-module-function"></a>
当你想将模块的实例方法变成类方法时，倾向使用 <code>module_function</code> 而不是 <code>extend self</code>。
<sup>[<a href="#module-function">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">module</span> <span class="pl-en">Utilities</span>
  <span class="pl-k">extend</span> <span class="pl-v">self</span>

  <span class="pl-k">def</span> <span class="pl-en">parse_something</span>(<span class="pl-smi">string</span>)
    <span class="pl-c"># 做一些事情</span>
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">other_utility_method</span>(<span class="pl-smi">number</span>, <span class="pl-smi">string</span>)
    <span class="pl-c"># 做一些事情</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">module</span> <span class="pl-en">Utilities</span>
  <span class="pl-k">module_function</span>

  <span class="pl-k">def</span> <span class="pl-en">parse_something</span>(<span class="pl-smi">string</span>)
    <span class="pl-c"># 做一些事情</span>
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">other_utility_method</span>(<span class="pl-smi">number</span>, <span class="pl-smi">string</span>)
    <span class="pl-c"># 做一些事情</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-liskov"></a>
当设计类的层次结构时，确保它们符合<a href="http://en.wikipedia.org/wiki/Liskov_substitution_principle">里式替换原则</a>。
<sup>[<a href="#liskov">link</a>]</sup></p></li>
<li><p><a name="user-content-solid-design"></a>
让你的类尽量满足 <a href="http://en.wikipedia.org/wiki/SOLID_(object-oriented_design)">SOLID 原则</a> 。
<sup>[<a href="#solid-design">link</a>]</sup></p></li>
<li><p><a name="user-content-define-to-s"></a>
总是替那些用以表示领域模型的类提供一个适当的 <code>to_s</code> 方法。
<sup>[<a href="#define-to-s">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Person</span>
  <span class="pl-k">attr_reader</span> <span class="pl-c1">:first_name</span>, <span class="pl-c1">:last_name</span>

  <span class="pl-k">def</span> <span class="pl-en">initialize</span>(<span class="pl-smi">first_name</span>, <span class="pl-smi">last_name</span>)
    <span class="pl-smi">@first_name</span> <span class="pl-k">=</span> first_name
    <span class="pl-smi">@last_name</span> <span class="pl-k">=</span> last_name
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">to_s</span>
    <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pse">#{</span><span class="pl-s1"><span class="pl-smi">@first_name</span></span><span class="pl-pse"><span class="pl-s1">}</span></span> <span class="pl-pse">#{</span><span class="pl-s1"><span class="pl-smi">@last_name</span></span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-attr_family"></a>
使用 <code>attr</code> 系列方法来定义琐碎的存取器或修改器。
<sup>[<a href="#attr_family">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">class</span> <span class="pl-en">Person</span>
  <span class="pl-k">def</span> <span class="pl-en">initialize</span>(<span class="pl-smi">first_name</span>, <span class="pl-smi">last_name</span>)
    <span class="pl-smi">@first_name</span> <span class="pl-k">=</span> first_name
    <span class="pl-smi">@last_name</span> <span class="pl-k">=</span> last_name
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">first_name</span>
    <span class="pl-smi">@first_name</span>
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">last_name</span>
    <span class="pl-smi">@last_name</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">class</span> <span class="pl-en">Person</span>
  <span class="pl-k">attr_reader</span> <span class="pl-c1">:first_name</span>, <span class="pl-c1">:last_name</span>

  <span class="pl-k">def</span> <span class="pl-en">initialize</span>(<span class="pl-smi">first_name</span>, <span class="pl-smi">last_name</span>)
    <span class="pl-smi">@first_name</span> <span class="pl-k">=</span> first_name
    <span class="pl-smi">@last_name</span> <span class="pl-k">=</span> last_name
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-attr"></a>
避免使用 <code>attr</code>。使用 <code>attr_reader</code> 与 <code>attr_accessor</code> 来替代。
<sup>[<a href="#attr">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 创建单个存取方法（此方法在 Ruby 1.9 之后被移除了）</span>
<span class="pl-k">attr</span> <span class="pl-c1">:something</span>, <span class="pl-c1">true</span>
<span class="pl-k">attr</span> <span class="pl-c1">:one</span>, <span class="pl-c1">:two</span>, <span class="pl-c1">:three</span> <span class="pl-c"># 类似于 attr_reader</span>

<span class="pl-c"># 好</span>
<span class="pl-k">attr_accessor</span> <span class="pl-c1">:something</span>
<span class="pl-k">attr_reader</span> <span class="pl-c1">:one</span>, <span class="pl-c1">:two</span>, <span class="pl-c1">:three</span></pre></div></li>
<li><p><a name="user-content-struct-new"></a>
优先考虑使用 <code>Struct.new</code>。它替你定义了那些琐碎的访问器、构造器及比较操作符。
<sup>[<a href="#struct-new">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 好</span>
<span class="pl-k">class</span> <span class="pl-en">Person</span>
  <span class="pl-k">attr_accessor</span> <span class="pl-c1">:first_name</span>, <span class="pl-c1">:last_name</span>

  <span class="pl-k">def</span> <span class="pl-en">initialize</span>(<span class="pl-smi">first_name</span>, <span class="pl-smi">last_name</span>)
    <span class="pl-smi">@first_name</span> <span class="pl-k">=</span> first_name
    <span class="pl-smi">@last_name</span> <span class="pl-k">=</span> last_name
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 更好</span>
<span class="pl-c1">Person</span> <span class="pl-k">=</span> <span class="pl-c1">Struct</span>.<span class="pl-k">new</span>(<span class="pl-c1">:first_name</span>, <span class="pl-c1">:last_name</span>) <span class="pl-k">do</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-extend-struct-new"></a>
不要扩展 <code>Struct.new</code> 实例化后的对象。对它进行扩展不但引入了毫无意义的类层次，而且在此文件被多次引入时可能会产生奇怪的错误。
<sup>[<a href="#no-extend-struct-new">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">class</span> <span class="pl-en">Person<span class="pl-e"> &lt; Struct.new</span></span>(<span class="pl-c1">:first_name</span>, <span class="pl-c1">:last_name</span>)
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-c1">Person</span> <span class="pl-k">=</span> <span class="pl-c1">Struct</span>.<span class="pl-k">new</span>(<span class="pl-c1">:first_name</span>, <span class="pl-c1">:last_name</span>)</pre></div></li>
<li><p><a name="user-content-factory-methods"></a>
优先考虑通过工厂方法的方式创建某些具有特定意义的实例对象。
<sup>[<a href="#factory-methods">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Person</span>
  <span class="pl-k">def</span> <span class="pl-en">self.create</span>(<span class="pl-smi">options_hash</span>)
    <span class="pl-c"># 省略主体</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-duck-typing"></a>
倾向使用<a href="https://en.wikipedia.org/wiki/Duck_typing">鸭子类型</a>而不是继承。
<sup>[<a href="#duck-typing">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">class</span> <span class="pl-en">Animal</span>
  <span class="pl-c"># 抽象方法</span>
  <span class="pl-k">def</span> <span class="pl-en">speak</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 继承父类</span>
<span class="pl-k">class</span> <span class="pl-en">Duck<span class="pl-e"> &lt; Animal</span></span>
  <span class="pl-k">def</span> <span class="pl-en">speak</span>
    puts <span class="pl-s"><span class="pl-pds">'</span>Quack! Quack<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 继承父类</span>
<span class="pl-k">class</span> <span class="pl-en">Dog<span class="pl-e"> &lt; Animal</span></span>
  <span class="pl-k">def</span> <span class="pl-en">speak</span>
    puts <span class="pl-s"><span class="pl-pds">'</span>Bau! Bau!<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">class</span> <span class="pl-en">Duck</span>
  <span class="pl-k">def</span> <span class="pl-en">speak</span>
    puts <span class="pl-s"><span class="pl-pds">'</span>Quack! Quack<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-k">class</span> <span class="pl-en">Dog</span>
  <span class="pl-k">def</span> <span class="pl-en">speak</span>
    puts <span class="pl-s"><span class="pl-pds">'</span>Bau! Bau!<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-class-vars"></a>
避免使用类变量（<code>@@</code>）。类变量在继承方面存在令人生厌的行为。
<sup>[<a href="#no-class-vars">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Parent</span>
  <span class="pl-smi">@@class_var</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>parent<span class="pl-pds">'</span></span>

  <span class="pl-k">def</span> <span class="pl-en">self.print_class_var</span>
    puts <span class="pl-smi">@@class_var</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-k">class</span> <span class="pl-en">Child<span class="pl-e"> &lt; Parent</span></span>
  <span class="pl-smi">@@class_var</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>child<span class="pl-pds">'</span></span>
<span class="pl-k">end</span>

<span class="pl-c1">Parent</span>.print_class_var <span class="pl-c"># =&gt; 此处打印的结果为 'child'</span></pre></div>

<p>如你所见，在类的层次结构中所有类都会共享同一类变量。通常情况下，倾向使用类实例变量而不是类变量。</p></li>
<li><p><a name="user-content-visibility"></a>
根据方法的目的与用途设置适当的可见级别（<code>private</code>、<code>protected</code>）。不要什么都不做就把所有方法设置为 <code>public</code>（默认值）。毕竟我们写的是 <strong>Ruby</strong> 而不是 <strong>Python</strong>。
<sup>[<a href="#visibility">link</a>]</sup></p></li>
<li><p><a name="user-content-indent-public-private-protected"></a>
把 <code>public</code>、<code>protected</code>、<code>private</code> 与其作用的方法缩排在同一层级。且在其上下各留一行以强调此可见级别作用于之后的所有方法。
<sup>[<a href="#indent-public-private-protected">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">SomeClass</span>
  <span class="pl-k">def</span> <span class="pl-en">public_method</span>
    <span class="pl-c"># ...</span>
  <span class="pl-k">end</span>

  <span class="pl-k">private</span>

  <span class="pl-k">def</span> <span class="pl-en">private_method</span>
    <span class="pl-c"># ...</span>
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">another_private_method</span>
    <span class="pl-c"># ...</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-def-self-class-methods"></a>
使用 <code>def self.method</code> 定义类方法。这种做法使得在代码重构时，即使修改了类名也无需做多次修改。
<sup>[<a href="#def-self-class-methods">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">TestClass</span>
  <span class="pl-c"># 差</span>
  <span class="pl-k">def</span> <span class="pl-en">TestClass.some_method</span>
    <span class="pl-c"># 省略主体</span>
  <span class="pl-k">end</span>

  <span class="pl-c"># 好</span>
  <span class="pl-k">def</span> <span class="pl-en">self.some_other_method</span>
    <span class="pl-c"># 省略主体</span>
  <span class="pl-k">end</span>

  <span class="pl-c"># 在需要定义多个类方法时，另一种便捷写法</span>
  <span class="pl-k">class</span> <span class="pl-en"><span class="pl-smi">&lt;&lt; self</span></span>
    <span class="pl-k">def</span> <span class="pl-en">first_method</span>
      <span class="pl-c"># 省略主体</span>
    <span class="pl-k">end</span>

    <span class="pl-k">def</span> <span class="pl-en">second_method_etc</span>
      <span class="pl-c"># 省略主体</span>
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-alias-method-lexically"></a>
在类的词法作用域中定义方法别名时，倾向使用 <code>alias</code>。因为定义期间 <code>alias</code> 与 <code>self</code> 指向的都是词法作用域，除非明确说明，否则该别名所引用的方法不会在运行期间被改变，或是在任何子类中被修改。
<sup>[<a href="#alias-method-lexically">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Westerner</span>
  <span class="pl-k">def</span> <span class="pl-en">first_name</span>
    <span class="pl-smi">@names</span>.first
  <span class="pl-k">end</span>

  <span class="pl-k">alias</span> given_name first_name
<span class="pl-k">end</span></pre></div>

<p>因为 <code>alias</code> 与 <code>def</code> 一样都是关键字，倾向使用裸字而不是符号或字符串。也就是说，使用 <code>alias foo bar</code> 而不是 <code>alias :foo :bar</code>。</p>

<p>另外需要了解 Ruby 是如何处理别名和继承的：别名所引用的原始方法是在定义期间被指定的，而不是运行期间。</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Fugitive<span class="pl-e"> &lt; Westerner</span></span>
  <span class="pl-k">def</span> <span class="pl-en">first_name</span>
    <span class="pl-s"><span class="pl-pds">'</span>Nobody<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<p>在这个例子中，<code>Fugitive#given_name</code> 仍然调用原先的 <code>Westerner#first_name</code> 方法，而不是 <code>Fugitive#first_name</code>。如果想要覆写 <code>Fugitive#given_name</code>，必须在子类中重新定义。</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Fugitive<span class="pl-e"> &lt; Westerner</span></span>
  <span class="pl-k">def</span> <span class="pl-en">first_name</span>
    <span class="pl-s"><span class="pl-pds">'</span>Nobody<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>

  <span class="pl-k">alias</span> given_name first_name
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-alias-method"></a>
在运行期间定义模块方法、类方法、单件方法的别名时，总是使用 <code>alias_method</code>。在上述情况下，使用 <code>alias</code> 可能会导致预期之外的结果。
<sup>[<a href="#alias-method">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">module</span> <span class="pl-en">Mononymous</span>
  <span class="pl-k">def</span> <span class="pl-en">self.included</span>(<span class="pl-smi">other</span>)
    other.class_eval { <span class="pl-k">alias_method</span> <span class="pl-c1">:full_name</span>, <span class="pl-c1">:given_name</span> }
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-k">class</span> <span class="pl-en">Sting<span class="pl-e"> &lt; Westerner</span></span>
  <span class="pl-k">include</span> <span class="pl-c1">Mononymous</span>
<span class="pl-k">end</span></pre></div></li>
</ul>

<h2><a id="user-content-异常" class="anchor" href="#异常" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>异常</h2>

<ul>
<li><p><a name="user-content-prefer-raise-over-fail"></a>
对于异常处理，倾向使用 <code>raise</code> 而不是 <code>fail</code>。
<sup>[<a href="#prefer-raise-over-fail">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
fail <span class="pl-c1">SomeException</span>, <span class="pl-s"><span class="pl-pds">'</span>message<span class="pl-pds">'</span></span>

<span class="pl-c"># 好</span>
<span class="pl-k">raise</span> <span class="pl-c1">SomeException</span>, <span class="pl-s"><span class="pl-pds">'</span>message<span class="pl-pds">'</span></span></pre></div></li>
<li><p><a name="user-content-no-explicit-runtimeerror"></a>
不要在带双参数形式的 <code>raise</code> 方法中显式指定 <code>RuntimeError</code>。
<sup>[<a href="#no-explicit-runtimeerror">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">raise</span> <span class="pl-c1">RuntimeError</span>, <span class="pl-s"><span class="pl-pds">'</span>message<span class="pl-pds">'</span></span>

<span class="pl-c"># 好 - 默认就是 RuntimeError</span>
<span class="pl-k">raise</span> <span class="pl-s"><span class="pl-pds">'</span>message<span class="pl-pds">'</span></span></pre></div></li>
<li><p><a name="user-content-exception-class-messages"></a>
倾向使用带异常类、消息的双参数形式调用 <code>raise</code> 方法，而不是使用异常的实例。
<sup>[<a href="#exception-class-messages">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 并无 raise SomeException.new('message') [, backtraces] 这种调用形式</span>
<span class="pl-k">raise</span> <span class="pl-c1">SomeException</span>.<span class="pl-k">new</span>(<span class="pl-s"><span class="pl-pds">'</span>message<span class="pl-pds">'</span></span>)

<span class="pl-c"># 好 - 与调用形式 raise SomeException [, 'message' [, backtraces]] 保持一致</span>
<span class="pl-k">raise</span> <span class="pl-c1">SomeException</span>, <span class="pl-s"><span class="pl-pds">'</span>message<span class="pl-pds">'</span></span></pre></div></li>
<li><p><a name="user-content-no-return-ensure"></a>
永远不要从 <code>ensure</code> 区块返回。如果你显式地从 <code>ensure</code> 区块返回，那么其所在的方法会如同永远不会发生异常般的返回。事实上，异常被默默地丢弃了。
<sup>[<a href="#no-return-ensure">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">def</span> <span class="pl-en">foo</span>
  <span class="pl-k">raise</span>
<span class="pl-k">ensure</span>
  <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">'</span>very bad idea<span class="pl-pds">'</span></span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-begin-implicit"></a>
尽可能隐式地使用 <code>begin/rescue/ensure/end</code> 区块。
<sup>[<a href="#begin-implicit">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">foo</span>
  <span class="pl-k">begin</span>
    <span class="pl-c"># 主逻辑</span>
  <span class="pl-k">rescue</span>
    <span class="pl-c"># 异常处理逻辑</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">foo</span>
  <span class="pl-c"># 主逻辑</span>
<span class="pl-k">rescue</span>
  <span class="pl-c"># 异常处理逻辑</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-contingency-methods"></a>
通过使用 <strong>contingency 方法</strong>（一个由 Avdi Grimm 创造的词）来减少 <code>begin/rescue/ensure/end</code> 区块的使用。
<sup>[<a href="#contingency-methods">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">begin</span>
  something_that_might_fail
<span class="pl-k">rescue</span> <span class="pl-c1">IOError</span>
  <span class="pl-c"># 处理 IOError</span>
<span class="pl-k">end</span>

<span class="pl-k">begin</span>
  something_else_that_might_fail
<span class="pl-k">rescue</span> <span class="pl-c1">IOError</span>
  <span class="pl-c"># 处理 IOError</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">with_io_error_handling</span>
   <span class="pl-k">yield</span>
<span class="pl-k">rescue</span> <span class="pl-c1">IOError</span>
  <span class="pl-c"># 处理 IOError</span>
<span class="pl-k">end</span>

with_io_error_handling { something_that_might_fail }

with_io_error_handling { something_else_that_might_fail }</pre></div></li>
<li><p><a name="user-content-dont-hide-exceptions"></a>
不要抑制异常。
<sup>[<a href="#dont-hide-exceptions">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">begin</span>
  <span class="pl-c"># 抛出异常</span>
<span class="pl-k">rescue</span> <span class="pl-c1">SomeError</span>
  <span class="pl-c"># 不做任何相关处理</span>
<span class="pl-k">end</span>

<span class="pl-c"># 差</span>
do_something <span class="pl-k">rescue</span> <span class="pl-c1">nil</span></pre></div></li>
<li><p><a name="user-content-no-rescue-modifiers"></a>
避免使用 <code>rescue</code> 修饰语法。
<sup>[<a href="#no-rescue-modifiers">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 这里将会捕捉 StandardError 及其所有子孙类的异常</span>
read_file <span class="pl-k">rescue</span> handle_error(<span class="pl-smi">$!</span>)

<span class="pl-c"># 好 - 这里只会捕获 Errno::ENOENT 及其所有子孙类的异常</span>
<span class="pl-k">def</span> <span class="pl-en">foo</span>
  read_file
<span class="pl-k">rescue</span> <span class="pl-c1">Errno</span>::<span class="pl-c1">ENOENT</span> =&gt; ex
  handle_error(ex)
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-exceptional-flows"></a>
不要将异常处理作为流程控制使用。
<sup>[<a href="#no-exceptional-flows">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">begin</span>
  n <span class="pl-k">/</span> d
<span class="pl-k">rescue</span> <span class="pl-c1">ZeroDivisionError</span>
  puts <span class="pl-s"><span class="pl-pds">'</span>Cannot divide by 0!<span class="pl-pds">'</span></span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">if</span> d.zero?
  puts <span class="pl-s"><span class="pl-pds">'</span>Cannot divide by 0!<span class="pl-pds">'</span></span>
<span class="pl-k">else</span>
  n <span class="pl-k">/</span> d
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-blind-rescues"></a>
避免捕获 <code>Exception</code>。这种做法会同时将信号与 <code>exit</code> 方法困住，导致你必须使用 <code>kill -9</code> 来终止进程。
<sup>[<a href="#no-blind-rescues">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 信号与 exit 方法产生的异常会被捕获（除了 kill -9）</span>
<span class="pl-k">begin</span>
  exit
<span class="pl-k">rescue</span> <span class="pl-c1">Exception</span>
  puts <span class="pl-s"><span class="pl-pds">"</span>you didn't really want to exit, right?<span class="pl-pds">"</span></span>
  <span class="pl-c"># 处理异常</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好 - 没有指定具体异常的 rescue 子句默认捕获 StandardError</span>
<span class="pl-k">begin</span>
  <span class="pl-c"># 抛出异常</span>
<span class="pl-k">rescue</span> =&gt; e
  <span class="pl-c"># 处理异常</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好 - 指定具体异常 StandardError</span>
<span class="pl-k">begin</span>
  <span class="pl-c"># 抛出异常</span>
<span class="pl-k">rescue</span> <span class="pl-c1">StandardError</span> =&gt; e
  <span class="pl-c"># 处理异常</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-exception-ordering"></a>
把较具体的异常放在处理链的较上层，不然它们永远不会被执行。
<sup>[<a href="#exception-ordering">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">begin</span>
  <span class="pl-c"># 抛出异常</span>
<span class="pl-k">rescue</span> <span class="pl-c1">StandardError</span> =&gt; e
  <span class="pl-c"># 处理异常</span>
<span class="pl-k">rescue</span> <span class="pl-c1">IOError</span> =&gt; e
  <span class="pl-c"># 处理异常，但事实上永远不会被执行</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">begin</span>
  <span class="pl-c"># 抛出异常</span>
<span class="pl-k">rescue</span> <span class="pl-c1">IOError</span> =&gt; e
  <span class="pl-c"># 处理异常</span>
<span class="pl-k">rescue</span> <span class="pl-c1">StandardError</span> =&gt; e
  <span class="pl-c"># 处理异常</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-release-resources"></a>
在 <code>ensure</code> 区块释放程序的外部资源。
<sup>[<a href="#release-resources">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>f <span class="pl-k">=</span> <span class="pl-c1">File</span>.open(<span class="pl-s"><span class="pl-pds">'</span>testfile<span class="pl-pds">'</span></span>)
<span class="pl-k">begin</span>
  <span class="pl-c"># .. 文件操作</span>
<span class="pl-k">rescue</span>
  <span class="pl-c"># .. 处理异常</span>
<span class="pl-k">ensure</span>
  f.close <span class="pl-k">if</span> f
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-auto-release-resources"></a>
在调用资源获取方法时，尽量使用具备自动清理功能的版本。
<sup>[<a href="#auto-release-resources">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 需要显式关闭文件描述符</span>
f <span class="pl-k">=</span> <span class="pl-c1">File</span>.open(<span class="pl-s"><span class="pl-pds">'</span>testfile<span class="pl-pds">'</span></span>)
  <span class="pl-c"># ...</span>
f.close

<span class="pl-c"># 好 - 文件描述符会被自动关闭</span>
<span class="pl-c1">File</span>.open(<span class="pl-s"><span class="pl-pds">'</span>testfile<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">f</span>|
  <span class="pl-c"># ...</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-standard-exceptions"></a>
倾向使用标准库中的异常类而不是引入新的类型。
<sup>[<a href="#standard-exceptions">link</a>]</sup></p></li>
</ul>

<h2><a id="user-content-集合" class="anchor" href="#集合" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>集合</h2>

<ul>
<li><p><a name="user-content-literal-array-hash"></a>
对于数组与哈希，倾向使用字面量语法来构建实例（除非你需要给构造器传递参数）。
<sup>[<a href="#literal-array-hash">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
arr <span class="pl-k">=</span> <span class="pl-c1">Array</span>.<span class="pl-k">new</span>
hash <span class="pl-k">=</span> <span class="pl-c1">Hash</span>.<span class="pl-k">new</span>

<span class="pl-c"># 好</span>
arr <span class="pl-k">=</span> []
hash <span class="pl-k">=</span> {}</pre></div></li>
<li><p><a name="user-content-percent-w"></a>
当创建一组元素为单词（没有空格或特殊字符）的数组时，倾向使用 <code>%w</code> 而不是 <code>[]</code>。此规则只适用于数组元素有两个或以上的时候。
<sup>[<a href="#percent-w">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-c1">STATES</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>draft<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>open<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>closed<span class="pl-pds">'</span></span>]

<span class="pl-c"># 好</span>
<span class="pl-c1">STATES</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">%w(</span>draft open closed<span class="pl-pds">)</span></span></pre></div></li>
<li><p><a name="user-content-percent-i"></a>
当创建一组符号类型的数组（且不需要保持 Ruby 1.9 兼容性）时，倾向使用 <code>%i</code>。此规则只适用于数组元素有两个或以上的时候。
<sup>[<a href="#percent-i">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-c1">STATES</span> <span class="pl-k">=</span> [<span class="pl-c1">:draft</span>, <span class="pl-c1">:open</span>, <span class="pl-c1">:closed</span>]

<span class="pl-c"># 好</span>
<span class="pl-c1">STATES</span> <span class="pl-k">=</span> <span class="pl-k">%</span>i(draft open closed)</pre></div></li>
<li><p><a name="user-content-no-trailing-array-commas"></a>
避免在数组与哈希的字面量语法的最后一个元素之后添加逗号，尤其当元素没有分布在同一行时。
<sup>[<a href="#no-trailing-array-commas">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 尽管移动、新增、删除元素颇为方便，但仍不推荐这种写法</span>
<span class="pl-c1">VALUES</span> <span class="pl-k">=</span> [
           <span class="pl-c1">1001</span>,
           <span class="pl-c1">2020</span>,
           <span class="pl-c1">3333</span>,
         ]

<span class="pl-c"># 差</span>
<span class="pl-c1">VALUES</span> <span class="pl-k">=</span> [<span class="pl-c1">1001</span>, <span class="pl-c1">2020</span>, <span class="pl-c1">3333</span>, ]

<span class="pl-c"># 好</span>
<span class="pl-c1">VALUES</span> <span class="pl-k">=</span> [<span class="pl-c1">1001</span>, <span class="pl-c1">2020</span>, <span class="pl-c1">3333</span>]</pre></div></li>
<li><p><a name="user-content-no-gappy-arrays"></a>
避免在数组中创造巨大的间隔。
<sup>[<a href="#no-gappy-arrays">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>arr <span class="pl-k">=</span> []
arr[<span class="pl-c1">100</span>] <span class="pl-k">=</span> <span class="pl-c1">1</span> <span class="pl-c"># 现在你有一个很多 nil 的数组</span></pre></div></li>
<li><p><a name="user-content-first-and-last"></a>
当访问数组的首元素或尾元素时，倾向使用 <code>first</code> 或 <code>last</code> 而不是 <code>[0]</code> 或 <code>[-1]</code>。
<sup>[<a href="#first-and-last">link</a>]</sup></p></li>
<li><p><a name="user-content-set-vs-array"></a>
当处理的对象不存在重复元素时，使用 <code>Set</code> 来替代 <code>Array</code>。<code>Set</code> 是实现了无序且无重复元素的集合类型。它兼具 <code>Array</code> 的直观操作与 <code>Hash</code> 的快速查找。
<sup>[<a href="#set-vs-array">link</a>]</sup></p></li>
<li><p><a name="user-content-symbols-as-keys"></a>
倾向使用符号而不是字符串作为哈希键。
<sup>[<a href="#symbols-as-keys">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
hash <span class="pl-k">=</span> { <span class="pl-s"><span class="pl-pds">'</span>one<span class="pl-pds">'</span></span> =&gt; <span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">'</span>two<span class="pl-pds">'</span></span> =&gt; <span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">'</span>three<span class="pl-pds">'</span></span> =&gt; <span class="pl-c1">3</span> }

<span class="pl-c"># 好</span>
hash <span class="pl-k">=</span> { <span class="pl-c1">one:</span> <span class="pl-c1">1</span>, <span class="pl-c1">two:</span> <span class="pl-c1">2</span>, <span class="pl-c1">three:</span> <span class="pl-c1">3</span> }</pre></div></li>
<li><p><a name="user-content-no-mutable-keys"></a>
避免使用可变对象作为哈希键。
<sup>[<a href="#no-mutable-keys">link</a>]</sup></p></li>
<li><p><a name="user-content-hash-literals"></a>
当哈希键为符号时，使用 Ruby 1.9 的字面量语法。
<sup>[<a href="#hash-literals">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
hash <span class="pl-k">=</span> { <span class="pl-c1">:one</span> =&gt; <span class="pl-c1">1</span>, <span class="pl-c1">:two</span> =&gt; <span class="pl-c1">2</span>, <span class="pl-c1">:three</span> =&gt; <span class="pl-c1">3</span> }

<span class="pl-c"># 好</span>
hash <span class="pl-k">=</span> { <span class="pl-c1">one:</span> <span class="pl-c1">1</span>, <span class="pl-c1">two:</span> <span class="pl-c1">2</span>, <span class="pl-c1">three:</span> <span class="pl-c1">3</span> }</pre></div></li>
<li><p><a name="user-content-no-mixed-hash-syntaces"></a>
当哈希键既有符号又有字符串时，不要使用 Ruby 1.9 的字面量语法。
<sup>[<a href="#no-mixed-hash-syntaces">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
{ <span class="pl-c1">a:</span> <span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span> =&gt; <span class="pl-c1">2</span> }

<span class="pl-c"># 好</span>
{ <span class="pl-c1">:a</span> =&gt; <span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span> =&gt; <span class="pl-c1">2</span> }</pre></div></li>
<li><p><a name="user-content-hash-key"></a>
倾向使用 <code>Hash#key?</code> 而不是 <code>Hash#has_key?</code>，使用 <code>Hash#value?</code> 而不是 <code>Hash#has_value?</code>。Matz <a href="http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-core/43765">在此</a>提及，较长形式的方法将被废弃。
<sup>[<a href="#hash-key">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
hash.has_key?(<span class="pl-c1">:test</span>)
hash.has_value?(value)

<span class="pl-c"># 好</span>
hash.key?(<span class="pl-c1">:test</span>)
hash.value?(value)</pre></div></li>
<li><p><a name="user-content-hash-each"></a>
倾向使用 <code>Hash#each_key</code> 而不是 <code>Hash#keys.each</code>，使用 <code>Hash#each_value</code> 而不是 <code>Hash#values.each</code>。
<sup>[<a href="#hash-each">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
hash.keys.each { |<span class="pl-smi">k</span>| p k }
hash.values.each { |<span class="pl-smi">v</span>| p v }
hash.each { |<span class="pl-smi">k</span>, <span class="pl-smi">_v</span>| p k }
hash.each { |<span class="pl-smi">_k</span>, <span class="pl-smi">v</span>| p v }

<span class="pl-c"># 好</span>
hash.each_key { |<span class="pl-smi">k</span>| p k }
hash.each_value { |<span class="pl-smi">v</span>| p v }</pre></div></li>
<li><p><a name="user-content-hash-fetch"></a>
当处理应该存在的哈希键时，使用 <code>Hash#fetch</code>。
<sup>[<a href="#hash-fetch">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>heroes <span class="pl-k">=</span> { <span class="pl-c1">batman:</span> <span class="pl-s"><span class="pl-pds">'</span>Bruce Wayne<span class="pl-pds">'</span></span>, <span class="pl-c1">superman:</span> <span class="pl-s"><span class="pl-pds">'</span>Clark Kent<span class="pl-pds">'</span></span> }

<span class="pl-c"># 差 - 如果我们打错了哈希键，则难以发现这个错误</span>
heroes[<span class="pl-c1">:batman</span>] <span class="pl-c"># =&gt; 'Bruce Wayne'</span>
heroes[<span class="pl-c1">:supermann</span>] <span class="pl-c"># =&gt; nil</span>

<span class="pl-c"># 好 - fetch 会抛出 KeyError 使这个错误显而易见</span>
heroes.fetch(<span class="pl-c1">:supermann</span>)</pre></div></li>
<li><p><a name="user-content-hash-fetch-defaults"></a>
当为哈希键的值提供默认值时，倾向使用 <code>Hash#fetch</code> 而不是自定义逻辑。
<sup>[<a href="#hash-fetch-defaults">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>batman <span class="pl-k">=</span> { <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Bruce Wayne<span class="pl-pds">'</span></span>, <span class="pl-c1">is_evil:</span> <span class="pl-c1">false</span> }

<span class="pl-c"># 差 - 如果仅仅使用 || 操作符，那么当值为假时，我们不会得到预期结果</span>
batman[<span class="pl-c1">:is_evil</span>] <span class="pl-k">||</span> <span class="pl-c1">true</span> <span class="pl-c"># =&gt; true</span>

<span class="pl-c"># 好 - fetch 在遇到假值时依然可以正确工作</span>
batman.fetch(<span class="pl-c1">:is_evil</span>, <span class="pl-c1">true</span>) <span class="pl-c"># =&gt; false</span></pre></div></li>
<li><p><a name="user-content-use-hash-blocks"></a>
当提供默认值的求值代码具有副作用或开销较大时，倾向使用 <code>Hash#fetch</code> 的区块形式。
<sup>[<a href="#use-hash-blocks">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>batman <span class="pl-k">=</span> { <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Bruce Wayne<span class="pl-pds">'</span></span> }

<span class="pl-c"># 差 - 此形式会立即求值，如果调用多次，可能会影响程序的性能</span>
batman.fetch(<span class="pl-c1">:powers</span>, obtain_batman_powers) <span class="pl-c"># obtain_batman_powers 开销较大</span>

<span class="pl-c"># 好 - 此形式会惰性求值，只有抛出 KeyError 时，才会产生开销</span>
batman.fetch(<span class="pl-c1">:powers</span>) { obtain_batman_powers }</pre></div></li>
<li><p><a name="user-content-hash-values-at"></a>
当需要一次性从哈希中获取多个键的值时，使用 <code>Hash#values_at</code>。
<sup>[<a href="#hash-values-at">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
email <span class="pl-k">=</span> data[<span class="pl-s"><span class="pl-pds">'</span>email<span class="pl-pds">'</span></span>]
username <span class="pl-k">=</span> data[<span class="pl-s"><span class="pl-pds">'</span>nickname<span class="pl-pds">'</span></span>]

<span class="pl-c"># 好</span>
email, username <span class="pl-k">=</span> data.values_at(<span class="pl-s"><span class="pl-pds">'</span>email<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>nickname<span class="pl-pds">'</span></span>)</pre></div></li>
<li><p><a name="user-content-ordered-hashes"></a>
利用“Ruby 1.9 之后的哈希是有序的”的这个特性。
<sup>[<a href="#ordered-hashes">link</a>]</sup></p></li>
<li><p><a name="user-content-no-modifying-collections"></a>
当遍历集合时，不要改动它。
<sup>[<a href="#no-modifying-collections">link</a>]</sup></p></li>
<li><p><a name="user-content-accessing-elements-directly"></a>
当访问集合中的元素时，倾向使用对象所提供的方法进行访问，而不是直接调用对象属性上的 <code>[n]</code> 方法。这种做法可以防止你在 <code>nil</code> 对象上调用 <code>[]</code>。
<sup>[<a href="#accessing-elements-directly">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-c1">Regexp</span>.last_match[<span class="pl-c1">1</span>]

<span class="pl-c"># 好</span>
<span class="pl-c1">Regexp</span>.last_match(<span class="pl-c1">1</span>)</pre></div></li>
<li><p><a name="user-content-provide-alternate-accessor-to-collections"></a>
当为集合提供存取器时，尽量支持索引值为 <code>nil</code> 的访问形式。
<sup>[<a href="#provide-alternate-accessor-to-collections">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">awesome_things</span>
  <span class="pl-smi">@awesome_things</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">awesome_things</span>(<span class="pl-smi">index</span> <span class="pl-k">=</span> <span class="pl-c1">nil</span>)
  <span class="pl-k">if</span> index <span class="pl-k">&amp;&amp;</span> <span class="pl-smi">@awesome_things</span>
    <span class="pl-smi">@awesome_things</span>[index]
  <span class="pl-k">else</span>
    <span class="pl-smi">@awesome_things</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
</ul>

<h2><a id="user-content-字符串" class="anchor" href="#字符串" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>字符串</h2>

<ul>
<li><p><a name="user-content-string-interpolation"></a>
倾向使用字符串插值或字符串格式化，而不是字符串拼接。
<sup>[<a href="#string-interpolation">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
email_with_name <span class="pl-k">=</span> user.name <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span> &lt;<span class="pl-pds">'</span></span> <span class="pl-k">+</span> user.email <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>

<span class="pl-c"># 好</span>
email_with_name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pse">#{</span><span class="pl-s1">user.name</span><span class="pl-pse"><span class="pl-s1">}</span></span> &lt;<span class="pl-pse">#{</span><span class="pl-s1">user.email</span><span class="pl-pse"><span class="pl-s1">}</span></span>&gt;<span class="pl-pds">"</span></span>

<span class="pl-c"># 好</span>
email_with_name <span class="pl-k">=</span> format(<span class="pl-s"><span class="pl-pds">'</span>%s &lt;%s&gt;<span class="pl-pds">'</span></span>, user.name, user.email)</pre></div></li>
<li><p><a name="user-content-pad-string-interpolation"></a>
对于插值表达式，括号内两端不要添加空格。
<sup>[<a href="#pad-string-interpolation">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-s"><span class="pl-pds">"</span>From: <span class="pl-pse">#{</span><span class="pl-s1"> user.first_name </span><span class="pl-pse"><span class="pl-s1">}</span></span>, <span class="pl-pse">#{</span><span class="pl-s1"> user.last_name </span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>

<span class="pl-c"># 好</span>
<span class="pl-s"><span class="pl-pds">"</span>From: <span class="pl-pse">#{</span><span class="pl-s1">user.first_name</span><span class="pl-pse"><span class="pl-s1">}</span></span>, <span class="pl-pse">#{</span><span class="pl-s1">user.last_name</span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span></pre></div></li>
<li><p><a name="user-content-consistent-string-literals"></a>
使用统一的风格创建字符串字面量。在 Ruby 社区中存在两种流行的风格：默认单引号（风格 A）与默认双引号（风格 B）。
<sup>[<a href="#consistent-string-literals">link</a>]</sup></p>

<ul>
<li><p><strong>（风格 A）</strong> 当你不需要字符串插值或特殊字符（比如 <code>\t</code>、<code>\n</code>、<code>'</code>）时，倾向使用单引号。</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Bozhidar<span class="pl-pds">"</span></span>

<span class="pl-c"># 好</span>
name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Bozhidar<span class="pl-pds">'</span></span></pre></div></li>
<li><p><strong>（风格 B）</strong> 除非字符串中包含双引号，或是你希望抑制转义字符，否则倾向使用双引号。</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Bozhidar<span class="pl-pds">'</span></span>

<span class="pl-c"># 好</span>
name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Bozhidar<span class="pl-pds">"</span></span></pre></div></li>
</ul>

<p>本指南使用第一种风格。</p></li>
<li><p><a name="user-content-no-character-literals"></a>
不要使用 <code>?x</code> 字面量语法。在 Ruby 1.9 之后，<code>?x</code> 与 <code>'x'</code>（只包含单个字符的字符串）是等价的。
<sup>[<a href="#no-character-literals">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
char <span class="pl-k">=</span> <span class="pl-c1">?c</span>

<span class="pl-c"># 好</span>
char <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>c<span class="pl-pds">'</span></span></pre></div></li>
<li><p><a name="user-content-curlies-interpolate"></a>
不要忘记使用 <code>{}</code> 包裹字符串插值中的实例变量或全局变量。
<sup>[<a href="#curlies-interpolate">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Person</span>
  <span class="pl-k">attr_reader</span> <span class="pl-c1">:first_name</span>, <span class="pl-c1">:last_name</span>

  <span class="pl-k">def</span> <span class="pl-en">initialize</span>(<span class="pl-smi">first_name</span>, <span class="pl-smi">last_name</span>)
    <span class="pl-smi">@first_name</span> <span class="pl-k">=</span> first_name
    <span class="pl-smi">@last_name</span> <span class="pl-k">=</span> last_name
  <span class="pl-k">end</span>

  <span class="pl-c"># 差 - 语法正确，但略显笨拙</span>
  <span class="pl-k">def</span> <span class="pl-en">to_s</span>
    <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">#@first_name</span> <span class="pl-smi">#@last_name</span><span class="pl-pds">"</span></span>
  <span class="pl-k">end</span>

  <span class="pl-c"># 好</span>
  <span class="pl-k">def</span> <span class="pl-en">to_s</span>
    <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pse">#{</span><span class="pl-s1"><span class="pl-smi">@first_name</span></span><span class="pl-pse"><span class="pl-s1">}</span></span> <span class="pl-pse">#{</span><span class="pl-s1"><span class="pl-smi">@last_name</span></span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-smi">$global</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>

<span class="pl-c"># 差</span>
puts <span class="pl-s"><span class="pl-pds">"</span>$global = <span class="pl-smi">#$global</span><span class="pl-pds">"</span></span>

<span class="pl-c"># 好</span>
puts <span class="pl-s"><span class="pl-pds">"</span>$global = <span class="pl-pse">#{</span><span class="pl-s1"><span class="pl-smi">$global</span></span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span></pre></div></li>
<li><p><a name="user-content-no-to-s"></a>
在字符串插值中，不要显式调用 <code>Object#to_s</code> 方法，Ruby 会自动调用它。
<sup>[<a href="#no-to-s">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
message <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>This is the <span class="pl-pse">#{</span><span class="pl-s1">result.to_s</span><span class="pl-pse"><span class="pl-s1">}</span></span>.<span class="pl-pds">"</span></span>

<span class="pl-c"># 好</span>
message <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>This is the <span class="pl-pse">#{</span><span class="pl-s1">result</span><span class="pl-pse"><span class="pl-s1">}</span></span>.<span class="pl-pds">"</span></span></pre></div></li>
<li><p><a name="user-content-concat-strings"></a>
当你需要构造巨大的数据块时，避免使用 <code>String#+</code>，使用 <code>String#&lt;&lt;</code> 来替代。<code>String#&lt;&lt;</code> 通过修改原始对象进行拼接工作，其比 <code>String#+</code> 效率更高，因为后者需要产生一堆新的字符串对象。
<sup>[<a href="#concat-strings">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
html <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
html <span class="pl-k">+=</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;h1&gt;Page title&lt;/h1&gt;<span class="pl-pds">'</span></span>

paragraphs.each <span class="pl-k">do </span>|<span class="pl-smi">paragraph</span>|
  html <span class="pl-k">+=</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;p&gt;<span class="pl-pse">#{</span><span class="pl-s1">paragraph</span><span class="pl-pse"><span class="pl-s1">}</span></span>&lt;/p&gt;<span class="pl-pds">"</span></span>
<span class="pl-k">end</span>

<span class="pl-c"># 好 - 并且效率更高</span>
html <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
html <span class="pl-k">&lt;&lt;</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;h1&gt;Page title&lt;/h1&gt;<span class="pl-pds">'</span></span>

paragraphs.each <span class="pl-k">do </span>|<span class="pl-smi">paragraph</span>|
  html <span class="pl-k">&lt;&lt;</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;p&gt;<span class="pl-pse">#{</span><span class="pl-s1">paragraph</span><span class="pl-pse"><span class="pl-s1">}</span></span>&lt;/p&gt;<span class="pl-pds">"</span></span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-dont-abuse-gsub"></a>
当存在更快速、更专业的替代方案时，不要使用 <code>String#gsub</code>。
<sup>[<a href="#dont-abuse-gsub">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>url <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://example.com<span class="pl-pds">'</span></span>
str <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>lisp-case-rules<span class="pl-pds">'</span></span>

<span class="pl-c"># 差</span>
url.gsub(<span class="pl-s"><span class="pl-pds">'</span>http://<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>https://<span class="pl-pds">'</span></span>)
str.gsub(<span class="pl-s"><span class="pl-pds">'</span>-<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>_<span class="pl-pds">'</span></span>)

<span class="pl-c"># 好</span>
url.sub(<span class="pl-s"><span class="pl-pds">'</span>http://<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>https://<span class="pl-pds">'</span></span>)
str.tr(<span class="pl-s"><span class="pl-pds">'</span>-<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>_<span class="pl-pds">'</span></span>)</pre></div></li>
<li><p><a name="user-content-heredocs"></a>
heredocs 中的多行文本会保留各行的前导空白。因此做好如何缩排的规划。
<sup>[<a href="#heredocs">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>code <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&lt;&lt;-END</span>.gsub(/^<span class="pl-cce">\s</span>+<span class="pl-cce">\|</span>/, '')</span>
<span class="pl-s">  |def test</span>
<span class="pl-s">  |  some_method</span>
<span class="pl-s">  |  other_method</span>
<span class="pl-s">  |end</span>
<span class="pl-s"><span class="pl-pds">END</span></span>
<span class="pl-c"># =&gt; "def test\n  some_method\n  other_method\nend\n"</span></pre></div></li>
<li><p><a name="user-content-squiggly-heredocs"></a>
使用 Ruby 2.3 新增的 <code>&lt;&lt;~</code> 操作符来缩排 heredocs 中的多行文本。
<sup>[<a href="#squiggly-heredocs">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 使用 Powerpack 程序库的 String#strip_margin</span>
code <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&lt;&lt;-END</span>.strip_margin('|')</span>
<span class="pl-s">  |def test</span>
<span class="pl-s">  |  some_method</span>
<span class="pl-s">  |  other_method</span>
<span class="pl-s">  |end</span>
<span class="pl-s"><span class="pl-pds">END</span></span>

<span class="pl-c"># 差</span>
code <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&lt;&lt;-END</span></span>
<span class="pl-s">def test</span>
<span class="pl-s">  some_method</span>
<span class="pl-s">  other_method</span>
<span class="pl-s">end</span>
<span class="pl-s"><span class="pl-pds">END</span></span>

<span class="pl-c"># 好</span>
code <span class="pl-k">=</span> <span class="pl-k">&lt;&lt;</span><span class="pl-k">~</span><span class="pl-k">END</span>
  <span class="pl-k">def</span> <span class="pl-en">test</span>
    some_method
    other_method
  <span class="pl-k">end</span>
<span class="pl-k">END</span></pre></div></li>
</ul>

<h2><a id="user-content-正则表达式" class="anchor" href="#正则表达式" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>正则表达式</h2>

<blockquote>
<p>有些人在面对问题时，不经大脑便认为，“我知道，这里该用正则表达式”。现在他要面对两个问题了。<br>
——Jamie Zawinski</p>
</blockquote>

<ul>
<li><p><a name="user-content-no-regexp-for-plaintext"></a>
如果只是在字符串中进行简单的文本搜索，不要使用正则表达式，比如 <code>string['text']</code>。
<sup>[<a href="#no-regexp-for-plaintext">link</a>]</sup></p></li>
<li><p><a name="user-content-regexp-string-index"></a>
对于简单的构建操作，使用正则表达式作为索引即可。
<sup>[<a href="#regexp-string-index">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>match <span class="pl-k">=</span> string[<span class="pl-sr"><span class="pl-pds">/</span>regexp<span class="pl-pds">/</span></span>]             <span class="pl-c"># 获取匹配的内容</span>
first_group <span class="pl-k">=</span> string[<span class="pl-sr"><span class="pl-pds">/</span>text<span class="pl-sr">(grp)</span><span class="pl-pds">/</span></span>, <span class="pl-c1">1</span>] <span class="pl-c"># 获取匹配的分组（grp）的内容</span>
string[<span class="pl-sr"><span class="pl-pds">/</span>text <span class="pl-sr">(grp)</span><span class="pl-pds">/</span></span>, <span class="pl-c1">1</span>] <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>replace<span class="pl-pds">'</span></span>  <span class="pl-c"># string =&gt; 'text replace'</span></pre></div></li>
<li><p><a name="user-content-non-capturing-regexp"></a>
当你不需要分组结果时，使用非捕获组。
<sup>[<a href="#non-capturing-regexp">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-sr">(first|second)</span><span class="pl-pds">/</span></span>

<span class="pl-c"># 好</span>
<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-sr">(?:first|second)</span><span class="pl-pds">/</span></span></pre></div></li>
<li><p><a name="user-content-no-perl-regexp-last-matchers"></a>
避免使用 Perl 风格的、用以代表最近的捕获组的特殊变量（比如 <code>$1</code>、<code>$2</code> 等）。使用 <code>Regexp.last_match(n)</code> 来替代。
<sup>[<a href="#no-perl-regexp-last-matchers">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-sr"><span class="pl-pds">/</span><span class="pl-sr">(regexp)</span><span class="pl-pds">/</span></span> <span class="pl-k">=~</span> string
...

<span class="pl-c"># 差</span>
process <span class="pl-smi">$1</span>

<span class="pl-c"># 好</span>
process <span class="pl-c1">Regexp</span>.last_match(<span class="pl-c1">1</span>)</pre></div></li>
<li><p><a name="user-content-no-numbered-regexes"></a>
避免使用数字来获取分组。因为很难明白它们代表的含义。使用命名分组来替代。
<sup>[<a href="#no-numbered-regexes">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-sr">(regexp)</span><span class="pl-pds">/</span></span> <span class="pl-k">=~</span> string
...
process <span class="pl-c1">Regexp</span>.last_match(<span class="pl-c1">1</span>)

<span class="pl-c"># 好</span>
<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-sr">(?&lt;meaningful_var&gt;regexp)</span><span class="pl-pds">/</span></span> <span class="pl-k">=~</span> string
...
process meaningful_var</pre></div></li>
<li><p><a name="user-content-limit-escapes"></a>
在字符类别中，只有少数几个你需要特别关心的特殊字符：<code>^</code>、<code>-</code>、<code>\</code>、<code>]</code>，所以你不需要转义 <code>[]</code> 中的 <code>.</code> 与中括号。
<sup>[<a href="#limit-escapes">link</a>]</sup></p></li>
<li><p><a name="user-content-caret-and-dollar-regexp"></a>
小心使用 <code>^</code> 与 <code>$</code> ，它们匹配的是一行的开始与结束，而不是字符串的开始与结束。如果你想要匹配整个字符串，使用 <code>\A</code> 与 <code>\z</code>。(注意，<code>\Z</code> 实为 <code>/\n?\z/</code>)
<sup>[<a href="#caret-and-dollar-regexp">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>string <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>some injection<span class="pl-cce">\n</span>username<span class="pl-pds">"</span></span>
string[<span class="pl-sr"><span class="pl-pds">/</span>^username$<span class="pl-pds">/</span></span>]   <span class="pl-c"># 匹配成功</span>
string[<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-cce">\A</span>username<span class="pl-cce">\z</span><span class="pl-pds">/</span></span>] <span class="pl-c"># 匹配失败</span></pre></div></li>
<li><p><a name="user-content-comment-regexes"></a>
对于复杂的正则表达式，使用 <code>x</code> 修饰符。这种做法不但可以提高可读性，而且允许你加入必要的注释。注意的是，空白字符会被忽略。
<sup>[<a href="#comment-regexes">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>regexp <span class="pl-k">=</span> <span class="pl-sr"><span class="pl-pds">/</span></span>
<span class="pl-sr">  start         # some text</span>
<span class="pl-sr">  <span class="pl-cce">\s</span>            # white space char</span>
<span class="pl-sr">  <span class="pl-sr">(group)</span>       # first group</span>
<span class="pl-sr">  <span class="pl-sr">(?:alt1|alt2)</span> # some alternation</span>
<span class="pl-sr">  end</span>
<span class="pl-sr"><span class="pl-pds">/x</span></span></pre></div></li>
<li><p><a name="user-content-gsub-blocks"></a>
对于复杂的替换，使用 <code>sub/gsub</code> 与哈希或区块组合的调用形式。
<sup>[<a href="#gsub-blocks">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre>words <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>foo bar<span class="pl-pds">'</span></span>
words.sub(<span class="pl-sr"><span class="pl-pds">/</span>f<span class="pl-pds">/</span></span>, <span class="pl-s"><span class="pl-pds">'</span>f<span class="pl-pds">'</span></span> =&gt; <span class="pl-s"><span class="pl-pds">'</span>F<span class="pl-pds">'</span></span>) <span class="pl-c"># =&gt; 'Foo bar'</span>
words.gsub(<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-cce">\w</span>+<span class="pl-pds">/</span></span>) { |<span class="pl-smi">word</span>| word.capitalize } <span class="pl-c"># =&gt; 'Foo Bar'</span></pre></div></li>
</ul>

<h2><a id="user-content-百分号字面量" class="anchor" href="#百分号字面量" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>百分号字面量</h2>

<ul>
<li><p><a name="user-content-percent-q-shorthand"></a>
只有当字符串中同时存在插值与双引号，且是单行时，才使用 <code>%()</code>（<code>%Q</code> 的简写形式）。多行字符串，倾向使用 heredocs。
<sup>[<a href="#percent-q-shorthand">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差 - 不存在插值</span>
<span class="pl-s"><span class="pl-pds">%(</span>&lt;div class="text"&gt;Some text&lt;/div&gt;<span class="pl-pds">)</span></span>
<span class="pl-c"># 应当使用 '&lt;div class="text"&gt;Some text&lt;/div&gt;'</span>

<span class="pl-c"># 差 - 不存在双引号</span>
<span class="pl-s"><span class="pl-pds">%(</span>This is <span class="pl-pse">#{</span><span class="pl-s1">quality</span><span class="pl-pse"><span class="pl-s1">}</span></span> style<span class="pl-pds">)</span></span>
<span class="pl-c"># 应当使用 "This is #{quality} style"</span>

<span class="pl-c"># 差 - 多行字符串</span>
<span class="pl-s"><span class="pl-pds">%(</span>&lt;div&gt;<span class="pl-cce">\n</span>&lt;span class="big"&gt;<span class="pl-pse">#{</span><span class="pl-s1">exclamation</span><span class="pl-pse"><span class="pl-s1">}</span></span>&lt;/span&gt;<span class="pl-cce">\n</span>&lt;/div&gt;<span class="pl-pds">)</span></span>
<span class="pl-c"># 应当使用 heredocs</span>

<span class="pl-c"># 好 - 同时存在插值与双引号，且是单行字符串</span>
<span class="pl-s"><span class="pl-pds">%(</span>&lt;tr&gt;&lt;td class="name"&gt;<span class="pl-pse">#{</span><span class="pl-s1">name</span><span class="pl-pse"><span class="pl-s1">}</span></span>&lt;/td&gt;<span class="pl-pds">)</span></span></pre></div></li>
<li><p><a name="user-content-percent-q"></a>
避免使用 <code>%q</code>，除非字符串同时存在 <code>'</code> 与 <code>"</code>。优先考虑更具可读性的常规字符串，除非字符串中存在大量需要转义的字符。
<sup>[<a href="#percent-q">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">%q(</span>Bruce Wayne<span class="pl-pds">)</span></span>
time <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">%q(</span>8 o'clock<span class="pl-pds">)</span></span>
question <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">%q(</span>"What did you say?"<span class="pl-pds">)</span></span>

<span class="pl-c"># 好</span>
name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Bruce Wayne<span class="pl-pds">'</span></span>
time <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>8 o'clock<span class="pl-pds">"</span></span>
question <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>"What did you say?"<span class="pl-pds">'</span></span>
quote <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">%q(</span>&lt;p class='quote'&gt;"What did you say?"&lt;/p&gt;<span class="pl-pds">)</span></span></pre></div></li>
<li><p><a name="user-content-percent-r"></a>
只有当正则表达式中存在一个或以上的 <code>/</code> 字符时，才使用 <code>%r</code>。
<sup>[<a href="#percent-r">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-sr"><span class="pl-pds">%r{</span><span class="pl-cce">\s</span>+<span class="pl-pds">}</span></span>

<span class="pl-c"># 好</span>
<span class="pl-sr"><span class="pl-pds">%r{</span>^/<span class="pl-sr">(.*)</span>$<span class="pl-pds">}</span></span>
<span class="pl-sr"><span class="pl-pds">%r{</span>^/blog/2011/<span class="pl-sr">(.*)</span>$<span class="pl-pds">}</span></span></pre></div></li>
<li><p><a name="user-content-percent-x"></a>
除非调用的命令使用了反引号（这种情况并不多见），否则不要使用 <code>%x</code>。
<sup>[<a href="#percent-x">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
date <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">%x(</span>date<span class="pl-pds">)</span></span>

<span class="pl-c"># 好</span>
date <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">`</span>date<span class="pl-pds">`</span></span>
echo <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">%x(</span>echo `date`<span class="pl-pds">)</span></span></pre></div></li>
<li><p><a name="user-content-percent-s"></a>
避免使用 <code>%s</code>。倾向使用 <code>:"some string"</code> 来创建含有空白字符的符号。
<sup>[<a href="#percent-s">link</a>]</sup></p></li>
<li><p><a name="user-content-percent-literal-braces"></a>
使用 <code>%</code> 字面量语法时，倾向使用 <code>()</code>（<code>%r</code> 除外，因为圆括号在正则表达式中比较常用，此时可以使用 <code>{}</code> 等其他形式来替代）。
<sup>[<a href="#percent-literal-braces">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-s"><span class="pl-pds">%w[</span>one two three<span class="pl-pds">]</span></span>
<span class="pl-s"><span class="pl-pds">%q{</span>"Test's king!", John said.<span class="pl-pds">}</span></span>

<span class="pl-c"># 好</span>
<span class="pl-s"><span class="pl-pds">%w(</span>one two three<span class="pl-pds">)</span></span>
<span class="pl-s"><span class="pl-pds">%q(</span>"Test's king!", John said.<span class="pl-pds">)</span></span></pre></div></li>
</ul>

<h2><a id="user-content-元编程" class="anchor" href="#元编程" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>元编程</h2>

<ul>
<li><p><a name="user-content-no-needless-metaprogramming"></a>
避免无谓的元编程。
<sup>[<a href="#no-needless-metaprogramming">link</a>]</sup></p></li>
<li><p><a name="user-content-no-monkey-patching"></a>
当编写程序库时，不要使核心类混乱（不要使用 monkey patch）。
<sup>[<a href="#no-monkey-patching">link</a>]</sup></p></li>
<li><p><a name="user-content-block-class-eval"></a>
对于 <code>class_eval</code> 方法，倾向使用区块形式，而不是字符串插值形式。
<sup>[<a href="#block-class-eval">link</a>]</sup></p>

<ul>
<li><p>当使用字符串插值形式时，总是提供 <code>__FILE__</code> 及 <code>__LINE__</code>，以使你的调用栈看起来具有意义：</p>

<div class="highlight highlight-source-ruby"><pre>class_eval <span class="pl-s"><span class="pl-pds">'</span>def use_relative_model_naming?; true; end<span class="pl-pds">'</span></span>, <span class="pl-v">__FILE__</span>, <span class="pl-v">__LINE__</span></pre></div></li>
<li><p>倾向使用 <code>define_method</code> 而不是 <code>class_eval { def ... }</code></p></li>
</ul></li>
<li><p><a name="user-content-eval-comment-docs"></a>
当使用 <code>class_eval</code>（或其他的 <code>eval</code>）的字符串插值形式时，添加一个注释区块来说明它是如何工作的（来自 Rails 代码中的技巧）。
<sup>[<a href="#eval-comment-docs">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 摘录自 activesupport/lib/active_support/core_ext/string/output_safety.rb</span>
<span class="pl-c1">UNSAFE_STRING_METHODS</span>.each <span class="pl-k">do </span>|<span class="pl-smi">unsafe_method</span>|
  <span class="pl-k">if</span> <span class="pl-s"><span class="pl-pds">'</span>String<span class="pl-pds">'</span></span>.respond_to?(unsafe_method)
    class_eval <span class="pl-s"><span class="pl-pds">&lt;&lt;-EOT</span>, __FILE__, __LINE__ + 1</span>
<span class="pl-s">      def <span class="pl-pse">#{</span><span class="pl-s1">unsafe_method</span><span class="pl-pse"><span class="pl-s1">}</span></span>(*params, &amp;block)       # def capitalize(*params, &amp;block)</span>
<span class="pl-s">        to_str.<span class="pl-pse">#{</span><span class="pl-s1">unsafe_method</span><span class="pl-pse"><span class="pl-s1">}</span></span>(*params, &amp;block)  #   to_str.capitalize(*params, &amp;block)</span>
<span class="pl-s">      end                                         # end</span>
<span class="pl-s"></span>
<span class="pl-s">      def <span class="pl-pse">#{</span><span class="pl-s1">unsafe_method</span><span class="pl-pse"><span class="pl-s1">}</span></span>!(*params)              # def capitalize!(*params)</span>
<span class="pl-s">        @dirty = true                             #   @dirty = true</span>
<span class="pl-s">        super                                     #   super</span>
<span class="pl-s">      end                                         # end</span>
<span class="pl-s"><span class="pl-pds">    EOT</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div></li>
<li><p><a name="user-content-no-method-missing"></a>
避免使用 <code>method_missing</code>。它会使你的调用栈变得凌乱；其方法不被罗列在 <code>#methods</code> 中；拼错的方法可能会默默地工作（<code>nukes.launch_state = false</code>）。优先考虑使用委托、代理、或是 <code>define_method</code> 来替代。如果你必须使用 <code>method_missing</code> 的话，务必做到以下几点：
<sup>[<a href="#no-method-missing">link</a>]</sup></p>

<ul>
<li>确保<a href="http://blog.marc-andre.ca/2010/11/methodmissing-politely.html">同时定义了 <code>respond_to_missing?</code></a>。</li>
<li>仅仅捕获那些具有良好语义前缀的方法，像是 <code>find_by_*</code>——让你的代码愈确定愈好。</li>
<li>在语句的最后调用 <code>super</code>。</li>
<li><p>委托到确定的、非魔术的方法，比如：</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-k">def</span> <span class="pl-en">method_missing?</span>(<span class="pl-smi">meth</span>, <span class="pl-k">*</span><span class="pl-smi">params</span>, <span class="pl-k">&amp;</span><span class="pl-smi">block</span>)
  <span class="pl-k">if</span> <span class="pl-sr"><span class="pl-pds">/</span>^find_by_<span class="pl-sr">(?&lt;prop&gt;.*)</span><span class="pl-pds">/</span></span> <span class="pl-k">=~</span> meth
    <span class="pl-c"># ... 一堆处理 find_by 的代码</span>
  <span class="pl-k">else</span>
    <span class="pl-k">super</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 好</span>
<span class="pl-k">def</span> <span class="pl-en">method_missing?</span>(<span class="pl-smi">meth</span>, <span class="pl-k">*</span><span class="pl-smi">params</span>, <span class="pl-k">&amp;</span><span class="pl-smi">block</span>)
  <span class="pl-k">if</span> <span class="pl-sr"><span class="pl-pds">/</span>^find_by_<span class="pl-sr">(?&lt;prop&gt;.*)</span><span class="pl-pds">/</span></span> <span class="pl-k">=~</span> meth
    find_by(prop, <span class="pl-k">*</span>params, <span class="pl-k">&amp;</span>block)
  <span class="pl-k">else</span>
    <span class="pl-k">super</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># 最好的方式可能是在每个需要支持的属性被声明时，使用 define_method 定义对应的方法</span></pre></div></li>
</ul></li>
<li><p><a name="user-content-prefer-public-send"></a>
倾向使用 <code>public_send</code> 而不是 <code>send</code>，因为 <code>send</code> 会无视 <code>private/protected</code> 的可见性。
<sup>[<a href="#prefer-public-send">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">module</span> <span class="pl-en">Activatable</span>
  <span class="pl-k">extend</span> <span class="pl-c1">ActiveSupport</span>::<span class="pl-c1">Concern</span>

  included <span class="pl-k">do</span>
    before_create <span class="pl-c1">:create_token</span>
  <span class="pl-k">end</span>

  <span class="pl-k">private</span>

  <span class="pl-k">def</span> <span class="pl-en">reset_token</span>
    ...
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">create_token</span>
    ...
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">activate!</span>
    ...
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-k">class</span> <span class="pl-en">Organization<span class="pl-e"> &lt; ActiveRecord::Base</span></span>
  <span class="pl-k">include</span> <span class="pl-c1">Activatable</span>
<span class="pl-k">end</span>

linux_organization <span class="pl-k">=</span> <span class="pl-c1">Organization</span>.find(...)

<span class="pl-c"># 差 - 会破坏对象的封装性</span>
linux_organization.send(<span class="pl-c1">:reset_token</span>)

<span class="pl-c"># 好 - 会抛出异常</span>
linux_organization.public_send(<span class="pl-c1">:reset_token</span>)</pre></div></li>
<li><p><a name="user-content-prefer-__send__"></a>
倾向使用 <code>__send__</code> 而不是 <code>send</code>，因为 <code>send</code> 可能会被覆写。
<sup>[<a href="#prefer-__send__">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>socket<span class="pl-pds">'</span></span>

u1 <span class="pl-k">=</span> <span class="pl-c1">UDPSocket</span>.<span class="pl-k">new</span>
u1.bind(<span class="pl-s"><span class="pl-pds">'</span>127.0.0.1<span class="pl-pds">'</span></span>, <span class="pl-c1">4913</span>)
u2 <span class="pl-k">=</span> <span class="pl-c1">UDPSocket</span>.<span class="pl-k">new</span>
u2.connect(<span class="pl-s"><span class="pl-pds">'</span>127.0.0.1<span class="pl-pds">'</span></span>, <span class="pl-c1">4913</span>)

<span class="pl-c"># 这里不会调用 u2 的 sleep 方法，而是通过 UDP socket 发送一条消息</span>
u2.send <span class="pl-c1">:sleep</span>, <span class="pl-c1">0</span>

<span class="pl-c"># 动态调用 u2 的某个方法</span>
u2.__send__ ...</pre></div></li>
</ul>

<h2><a id="user-content-其他" class="anchor" href="#其他" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>其他</h2>

<ul>
<li><p><a name="user-content-always-warn"></a>
总是开启 <code>ruby -w</code> 选项，以编写安全的代码。
<sup>[<a href="#always-warn">link</a>]</sup></p></li>
<li><p><a name="user-content-no-optional-hash-params"></a>
避免使用哈希作为可选参数。这个方法是不是做太多事了？（对象构造器除外）
<sup>[<a href="#no-optional-hash-params">link</a>]</sup></p></li>
<li><p><a name="user-content-short-methods"></a>
避免单个方法的长度超过 10 行（不计入空行）。理想上，大部分方法应当不超过 5 行。
<sup>[<a href="#short-methods">link</a>]</sup></p></li>
<li><p><a name="user-content-too-many-params"></a>
避免参数列表数目多于三或四个。
<sup>[<a href="#too-many-params">link</a>]</sup></p></li>
<li><p><a name="user-content-private-global-methods"></a>
如果你真的需要“全局”方法，将它们添加到 <code>Kernel</code> 并设为私有。
<sup>[<a href="#private-global-methods">link</a>]</sup></p></li>
<li><p><a name="user-content-instance-vars"></a>
使用模块实例变量而不是全局变量。
<sup>[<a href="#instance-vars">link</a>]</sup></p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># 差</span>
<span class="pl-smi">$foo_bar</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>

<span class="pl-c"># 好</span>
<span class="pl-k">module</span> <span class="pl-en">Foo</span>
  <span class="pl-k">class</span> <span class="pl-en"><span class="pl-smi">&lt;&lt; self</span></span>
    <span class="pl-k">attr_accessor</span> <span class="pl-c1">:bar</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c1">Foo</span>.bar <span class="pl-k">=</span> <span class="pl-c1">1</span></pre></div></li>
<li><p><a name="user-content-optionparser"></a>
使用 <code>OptionParser</code> 来解析复杂的命令行选项。使用 <code>ruby -s</code> 来处理琐碎的命令行选项。
<sup>[<a href="#optionparser">link</a>]</sup></p></li>
<li><p><a name="user-content-time-now"></a>
使用 <code>Time.now</code> 而不是 <code>Time.new</code> 来获取当前的系统时间。
<sup>[<a href="#time-now">link</a>]</sup></p></li>
<li><p><a name="user-content-functional-code"></a>
使用函数式思维编写程序，避免副作用。
<sup>[<a href="#functional-code">link</a>]</sup></p></li>
<li><p><a name="user-content-no-param-mutations"></a>
不要修改参数值，除非那就是这个方法的作用。
<sup>[<a href="#no-param-mutations">link</a>]</sup></p></li>
<li><p><a name="user-content-three-is-the-number-thou-shalt-count"></a>
避免使用三层以上的嵌套区块。
<sup>[<a href="#three-is-the-number-thou-shalt-count">link</a>]</sup></p></li>
<li><p><a name="user-content-be-consistent"></a>
保持一致性。在理想的世界里，遵循这些准则。
<sup>[<a href="#be-consistent">link</a>]</sup></p></li>
<li><p><a name="user-content-common-sense"></a>
使用常识。
<sup>[<a href="#common-sense">link</a>]</sup></p></li>
</ul>

<h2><a id="user-content-工具" class="anchor" href="#工具" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>工具</h2>

<p>以下的一些工具可以帮助你自动检查项目中的 Ruby 代码是否符合这份指南。</p>

<h3><a id="user-content-rubocop" class="anchor" href="#rubocop" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>RuboCop</h3>

<p><a href="https://github.com/bbatsov/rubocop">RuboCop</a> 是一个基于本指南的 Ruby 代码风格检查工具。RuboCop 涵盖了本指南相当大的部分，其同时支持 MRI 1.9 和 MRI 2.0，且与 Emacs 整合良好。</p>

<h3><a id="user-content-rubymine" class="anchor" href="#rubymine" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>RubyMine</h3>

<p><a href="http://www.jetbrains.com/ruby/">RubyMine</a> 的代码检查<a href="http://confluence.jetbrains.com/display/RUBYDEV/RubyMine+Inspections">部分基于</a>本指南。</p>

<h1><a id="user-content-贡献" class="anchor" href="#贡献" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>贡献</h1>

<p>本指南仍在不断改进。某些规则可能缺乏恰当示例，某些规则可能尚未表述到位。任何对这些规则的改进都是对 Ruby 社区的有益帮助。希望在适当时候，这些问题都能够得到解决，暂且铭记于心。</p>

<p>这里的每条规则都不是定案。这只是我渴望与同样对 Ruby 编程风格感兴趣的大家一起工作，最终可以为整个 Ruby 社区创造一份有益的资源。欢迎发起讨论或提交一个带有改进性质的更新请求。在此提前感谢你的帮助！</p>

<p>你也可以通过 <a href="https://gratipay.com/%7Ebbatsov/">Gratipay</a> 对此项目（或是 RuboCop）提供财务方面的支持。</p>

<p><a href="https://gratipay.com/%7Ebbatsov/"><img src="https://camo.githubusercontent.com/d500f7b6462d3d8f4c931e5327fa1b0761956e26/68747470733a2f2f63646e2e7261776769742e636f6d2f67726174697061792f67726174697061792d62616467652f322e332e302f646973742f67726174697061792e706e67" alt="Support via Gratipay" data-canonical-src="https://cdn.rawgit.com/gratipay/gratipay-badge/2.3.0/dist/gratipay.png" style="max-width:100%;"></a></p>

<h2><a id="user-content-如何贡献" class="anchor" href="#如何贡献" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>如何贡献？</h2>

<p>很简单，只需参考<a href="https://github.com/JuanitoFatas/ruby-style-guide/blob/master/CONTRIBUTING.md">贡献指南</a>。</p>

<h1><a id="user-content-授权" class="anchor" href="#授权" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>授权</h1>

<p><a href="https://camo.githubusercontent.com/ea7febd364f01e7b3f46f6fb86712fe05925bfbf/687474703a2f2f692e6372656174697665636f6d6d6f6e732e6f72672f6c2f62792f332e302f38387833312e706e67" target="_blank"><img src="https://camo.githubusercontent.com/ea7febd364f01e7b3f46f6fb86712fe05925bfbf/687474703a2f2f692e6372656174697665636f6d6d6f6e732e6f72672f6c2f62792f332e302f38387833312e706e67" alt="Creative Commons License" data-canonical-src="http://i.creativecommons.org/l/by/3.0/88x31.png" style="max-width:100%;"></a>
本指南基于 <a href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported</a> 授权许可。</p>

<h1><a id="user-content-口耳相传" class="anchor" href="#口耳相传" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg></a>口耳相传</h1>

<p>一份社区驱动的风格指南，如果没多少人知道，对一个社区来说就没有多少用处。微博转发这份指南，分享给你的朋友或同事。我们得到的每个评价、建议或意见都可以让这份指南变得更好一点。而我们想要拥有最好的指南，不是吗？</p>

<p>共勉之，<br>
<a href="https://twitter.com/bbatsov">Bozhidar</a></p>
</article>
  </div>

</div>

<button type="button" data-facebox="#jump-to-line" data-facebox-class="linejump" data-hotkey="l" class="hidden">Jump to Line</button>
<div id="jump-to-line" style="display:none">
  <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="" class="js-jump-to-line-form" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /></div>
    <input class="form-control linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" aria-label="Jump to line" autofocus>
    <button type="submit" class="btn">Go</button>
</form></div>

  </div>
  <div class="modal-backdrop"></div>
</div>


    </div>
  </div>

    </div>

        <div class="container site-footer-container">
  <div class="site-footer" role="contentinfo">
    <ul class="site-footer-links right">
        <li><a href="https://status.github.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
      <li><a href="https://developer.github.com" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li><a href="https://training.github.com" data-ga-click="Footer, go to training, text:training">Training</a></li>
      <li><a href="https://shop.github.com" data-ga-click="Footer, go to shop, text:shop">Shop</a></li>
        <li><a href="https://github.com/blog" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a href="https://github.com/about" data-ga-click="Footer, go to about, text:about">About</a></li>

    </ul>

    <a href="https://github.com" aria-label="Homepage" class="site-footer-mark" title="GitHub">
      <svg aria-hidden="true" class="octicon octicon-mark-github" height="24" version="1.1" viewBox="0 0 16 16" width="24"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59 0.4 0.07 0.55-0.17 0.55-0.38 0-0.19-0.01-0.82-0.01-1.49-2.01 0.37-2.53-0.49-2.69-0.94-0.09-0.23-0.48-0.94-0.82-1.13-0.28-0.15-0.68-0.52-0.01-0.53 0.63-0.01 1.08 0.58 1.23 0.82 0.72 1.21 1.87 0.87 2.33 0.66 0.07-0.52 0.28-0.87 0.51-1.07-1.78-0.2-3.64-0.89-3.64-3.95 0-0.87 0.31-1.59 0.82-2.15-0.08-0.2-0.36-1.02 0.08-2.12 0 0 0.67-0.21 2.2 0.82 0.64-0.18 1.32-0.27 2-0.27 0.68 0 1.36 0.09 2 0.27 1.53-1.04 2.2-0.82 2.2-0.82 0.44 1.1 0.16 1.92 0.08 2.12 0.51 0.56 0.82 1.27 0.82 2.15 0 3.07-1.87 3.75-3.65 3.95 0.29 0.25 0.54 0.73 0.54 1.48 0 1.07-0.01 1.93-0.01 2.2 0 0.21 0.15 0.46 0.55 0.38C13.71 14.53 16 11.53 16 8 16 3.58 12.42 0 8 0z"></path></svg>
</a>
    <ul class="site-footer-links">
      <li>&copy; 2016 <span title="0.08524s from github-fe131-cp1-prd.iad.github.net">GitHub</span>, Inc.</li>
        <li><a href="https://github.com/site/terms" data-ga-click="Footer, go to terms, text:terms">Terms</a></li>
        <li><a href="https://github.com/site/privacy" data-ga-click="Footer, go to privacy, text:privacy">Privacy</a></li>
        <li><a href="https://github.com/security" data-ga-click="Footer, go to security, text:security">Security</a></li>
        <li><a href="https://github.com/contact" data-ga-click="Footer, go to contact, text:contact">Contact</a></li>
        <li><a href="https://help.github.com" data-ga-click="Footer, go to help, text:help">Help</a></li>
    </ul>
  </div>
</div>



    
    

    <div id="ajax-error-message" class="ajax-error-message flash flash-error">
      <svg aria-hidden="true" class="octicon octicon-alert" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M15.72 12.5l-6.85-11.98C8.69 0.21 8.36 0.02 8 0.02s-0.69 0.19-0.87 0.5l-6.85 11.98c-0.18 0.31-0.18 0.69 0 1C0.47 13.81 0.8 14 1.15 14h13.7c0.36 0 0.69-0.19 0.86-0.5S15.89 12.81 15.72 12.5zM9 12H7V10h2V12zM9 9H7V5h2V9z"></path></svg>
      <button type="button" class="flash-close js-flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
        <svg aria-hidden="true" class="octicon octicon-x" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M7.48 8l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75-1.48-1.48 3.75-3.75L0.77 4.25l1.48-1.48 3.75 3.75 3.75-3.75 1.48 1.48-3.75 3.75z"></path></svg>
      </button>
      Something went wrong with that request. Please try again.
    </div>


      
      <script crossorigin="anonymous" integrity="sha256-IftkoS9RBlJl9IQfpdEJcl0bjnoIGzNGw5OlxsQOT4Q=" src="https://assets-cdn.github.com/assets/frameworks-21fb64a12f51065265f4841fa5d109725d1b8e7a081b3346c393a5c6c40e4f84.js"></script>
      <script async="async" crossorigin="anonymous" integrity="sha256-sGgCfmGornQOc2HANqCn3yT63xcf0akrL+RMMclN1io=" src="https://assets-cdn.github.com/assets/github-b068027e61a8ae740e7361c036a0a7df24fadf171fd1a92b2fe44c31c94dd62a.js"></script>
      
      
      
      
      
      
    <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner hidden">
      <svg aria-hidden="true" class="octicon octicon-alert" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M15.72 12.5l-6.85-11.98C8.69 0.21 8.36 0.02 8 0.02s-0.69 0.19-0.87 0.5l-6.85 11.98c-0.18 0.31-0.18 0.69 0 1C0.47 13.81 0.8 14 1.15 14h13.7c0.36 0 0.69-0.19 0.86-0.5S15.89 12.81 15.72 12.5zM9 12H7V10h2V12zM9 9H7V5h2V9z"></path></svg>
      <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="">Reload</a> to refresh your session.</span>
      <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="">Reload</a> to refresh your session.</span>
    </div>
    <div class="facebox" id="facebox" style="display:none;">
  <div class="facebox-popup">
    <div class="facebox-content" role="dialog" aria-labelledby="facebox-header" aria-describedby="facebox-description">
    </div>
    <button type="button" class="facebox-close js-facebox-close" aria-label="Close modal">
      <svg aria-hidden="true" class="octicon octicon-x" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M7.48 8l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75-1.48-1.48 3.75-3.75L0.77 4.25l1.48-1.48 3.75 3.75 3.75-3.75 1.48 1.48-3.75 3.75z"></path></svg>
    </button>
  </div>
</div>

  </body>
</html>

